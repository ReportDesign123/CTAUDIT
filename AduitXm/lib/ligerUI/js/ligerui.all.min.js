/**
* jQuery ligerUI 1.2.3
* 
* http://ligerui.com
*  
* Author daomi 2013 [ gd_star@163.com ] 
* 
*/(function(b){Function.prototype.ligerExtend=function(a,d){if("function"!=typeof a)return this;this.base=a.prototype;this.base.constructor=a;var g=function(){};g.prototype=a.prototype;this.prototype=new g;this.prototype.constructor=this;d&&b.extend(this.prototype,d)};Function.prototype.ligerDefer=function(a,d,b){var e=this;return setTimeout(function(){e.apply(a,b||[])},d)};window.liger=b.ligerui={version:"V1.2.0",managerCount:0,managers:{},managerIdPrev:"ligerui",autoNewId:!0,error:{managerIsExist:"\u7ba1\u7406\u5668id\u5df2\u7ecf\u5b58\u5728"},pluginPrev:"liger",getId:function(a){a=a||this.managerIdPrev;a+=1E3+this.managerCount;this.managerCount++;return a},add:function(a){if(2==arguments.length){var d=arguments[1];d.id=d.id||d.options.id||arguments[0].id;this.addManager(d)}else{a.id||(a.id=this.getId(a.__idPrev()));this.managers[a.id]&&(a.id=this.getId(a.__idPrev()));if(this.managers[a.id])throw Error(this.error.managerIsExist);this.managers[a.id]=a}},remove:function(a){if("string"==typeof a||"number"==typeof a)delete liger.managers[a];else if("object"==typeof a)if(a instanceof liger.core.Component)delete liger.managers[a.id];else{if(!b(a).attr(this.idAttrName))return!1;delete liger.managers[b(a).attr(this.idAttrName)]}},get:function(a,d){d=d||"ligeruiid";if("string"==typeof a||"number"==typeof a)return liger.managers[a];if("object"==typeof a){var g=a.length?a[0]:a;return(g=g[d]||b(g).attr(d))?liger.managers[g]:null}return null},find:function(a){var d=[],g;for(g in this.managers){var e=this.managers[g];a instanceof Function?e instanceof a&&d.push(e):a instanceof Array?-1!=b.inArray(e.__getType(),a)&&d.push(e):e.__getType()==a&&d.push(e)}return d},run:function(a,d,g){if(a){g=b.extend({defaultsNamespace:"ligerDefaults",methodsNamespace:"ligerMethods",controlNamespace:"controls",idAttrName:"ligeruiid",isStatic:!1,hasElement:!0,propertyToElemnt:null},g||{});a=a.replace(/^ligerGet/,"");a=a.replace(/^liger/,"");if(null==this||this==window||g.isStatic)return liger.plugins[a]||(liger.plugins[a]={fn:b[liger.pluginPrev+a],isStatic:!0}),new b.ligerui[g.controlNamespace][a](b.extend({},b[g.defaultsNamespace][a]||{},b[g.defaultsNamespace][a+"String"]||{},0<d.length?d[0]:{}));liger.plugins[a]||(liger.plugins[a]={fn:b.fn[liger.pluginPrev+a],isStatic:!1});if(/Manager$/.test(a))return liger.get(this,g.idAttrName);this.each(function(){if(this[g.idAttrName]||b(this).attr(g.idAttrName)){var e=liger.get(this[g.idAttrName]||b(this).attr(g.idAttrName));e&&0<d.length&&e.set(d[0])}else 1<=d.length&&"string"==typeof d[0]||(e=b.extend({},b[g.defaultsNamespace][a],b[g.defaultsNamespace][a+"String"],0<d.length?d[0]:null),g.propertyToElemnt&&(e[g.propertyToElemnt]=this),g.hasElement?new b.ligerui[g.controlNamespace][a](this,e):new b.ligerui[g.controlNamespace][a](e))});if(0==this.length)return null;if(0==d.length||"object"==typeof d[0])return liger.get(this,g.idAttrName);if("string"==typeof d[0]){var e=liger.get(this,g.idAttrName);if(null==e)return;if("option"==d[0]){if(2==d.length)return e.get(d[1]);if(3<=d.length)return e.set(d[1],d[2])}else{var f=d[0];if(!e[f])return;var h=Array.apply(null,d);h.shift();return e[f].apply(e,h)}}return null}},defaults:{},methods:{},core:{},controls:{},plugins:{}};b.ligerDefaults={};b.ligerMethos={};liger.defaults=b.ligerDefaults;liger.methods=b.ligerMethos;b.fn.liger=function(a){return a?liger.run.call(this,a,arguments):liger.get(this)};liger.core.Component=function(a){this.events=this.events||{};this.options=a||{};this.children={}};b.extend(liger.core.Component.prototype,{__getType:function(){return"liger.core.Component"},__idPrev:function(){return"ligerui"},set:function(a,d){if(a)if("object"==typeof a){var g;this.options!=a?(b.extend(this.options,a),g=a):g=b.extend({},a);if(void 0==d||!0==d)for(var e in g)0==e.indexOf("on")&&this.set(e,g[e]);if(void 0==d||!1==d)for(e in g)0!=e.indexOf("on")&&this.set(e,g[e])}else 0==a.indexOf("on")?"function"==typeof d&&this.bind(a.substr(2),d):(this.options||(this.options={}),!1!=this.trigger("propertychange",[a,d])&&(this.options[a]=d,g="_set"+a.substr(0,1).toUpperCase()+a.substr(1),this[g]&&this[g].call(this,d),this.trigger("propertychanged",[a,d])))},get:function(a){var d="_get"+a.substr(0,1).toUpperCase()+a.substr(1);return this[d]?this[d].call(this,a):this.options[a]},hasBind:function(a){a=a.toLowerCase();return(a=this.events[a])&&a.length?!0:!1},trigger:function(a,d){if(a){var b=a.toLowerCase();if(b=this.events[b]){d=d||[];!1==d instanceof Array&&(d=[d]);for(var e=0;e<b.length;e++){var f=b[e];if(!1==f.handler.apply(f.context,d))return!1}}}},bind:function(a,d,b){if("object"==typeof a)for(var e in a)this.bind(e,a[e]);else{if("function"!=typeof d)return!1;a=a.toLowerCase();e=this.events[a]||[];e.push({handler:d,context:b||this});this.events[a]=e}},unbind:function(a,d){if(a){var b=a.toLowerCase(),e=this.events[b];if(e&&e.length)if(d)for(var b=0,f=e.length;b<f;b++){if(e[b].handler==d){e.splice(b,1);break}}else delete this.events[b]}else this.events={}},destroy:function(){liger.remove(this)}});liger.core.UIComponent=function(a,d){liger.core.UIComponent.base.constructor.call(this,d);var g=this._extendMethods();g&&b.extend(this,g);this.element=a;this._init();this._preRender();this.trigger("render");this._render();this.trigger("rendered");this._rendered()};liger.core.UIComponent.ligerExtend(liger.core.Component,{__getType:function(){return"liger.core.UIComponent"},_extendMethods:function(){},_init:function(){this.type=this.__getType();this.id=this.element?this.options.id||this.element.id||liger.getId(this.__idPrev()):this.options.id||liger.getId(this.__idPrev());liger.add(this);if(this.element){var a=this.attr();if(a&&a instanceof Array)for(var d=0;d<a.length;d++){var g=a[d];this.options[g]=b(this.element).attr(g)}a=this.options;if(b(this.element).attr("ligerui"))try{var e=b(this.element).attr("ligerui");0!=e.indexOf("{")&&(e="{"+e+"}");eval("attroptions \x3d "+e+";");e&&b.extend(a,e)}catch(f){}}},_preRender:function(){},_render:function(){},_rendered:function(){this.element&&b(this.element).attr("ligeruiid",this.id)},attr:function(){return[]},destroy:function(){this.element&&b(this.element).remove();this.options=null;liger.remove(this)}});liger.controls.Input=function(a,d){liger.controls.Input.base.constructor.call(this,a,d)};liger.controls.Input.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Input"},attr:function(){return["nullText"]},setValue:function(a){return this.set("value",a)},getValue:function(){return this.get("value")},_setReadonly:function(a){var d=this.wrapper||this.text;if(d&&d.hasClass("l-text")){var b=this.inputText;a?(b&&b.attr("readonly","readonly"),d.addClass("l-text-readonly")):(b&&b.removeAttr("readonly"),d.removeClass("l-text-readonly"))}},setEnabled:function(){return this.set("disabled",!1)},setDisabled:function(){return this.set("disabled",!0)},updateStyle:function(){},resize:function(a,d){this.set({width:a,height:d})}});liger.win={top:!1,mask:function(a){function d(){if(liger.win.windowMask){var d=b(window).height()+b(window).scrollTop();liger.win.windowMask.height(d)}}this.windowMask||(this.windowMask=b("\x3cdiv class\x3d'l-window-mask' style\x3d'display: block;'\x3e\x3c/div\x3e").appendTo("body"),b(window).bind("resize.ligeruiwin",d),b(window).bind("scroll",d));this.windowMask.show();d();this.masking=!0},unmask:function(a){for(var d=b("body \x3e .l-dialog:visible,body \x3e .l-window:visible"),g=0,e=d.length;g<e;g++){var f=d.eq(g).attr("ligeruiid");if((!a||a.id!=f)&&(f=liger.get(f))&&f.get("modal"))return}this.windowMask&&this.windowMask.hide();this.masking=!1},createTaskbar:function(){this.taskbar||(this.taskbar=b('\x3cdiv class\x3d"l-taskbar"\x3e\x3cdiv class\x3d"l-taskbar-tasks"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-clear"\x3e\x3c/div\x3e\x3c/div\x3e').appendTo("body"),this.top&&this.taskbar.addClass("l-taskbar-top"),this.taskbar.tasks=b(".l-taskbar-tasks:first",this.taskbar),this.tasks={});this.taskbar.show();this.taskbar.animate({bottom:0});return this.taskbar},removeTaskbar:function(){var a=this;a.taskbar.animate({bottom:-32},function(){a.taskbar.remove();a.taskbar=null})},activeTask:function(a){for(var d in this.tasks){var b=this.tasks[d];d==a.id?b.addClass("l-taskbar-task-active"):b.removeClass("l-taskbar-task-active")}},getTask:function(a){if(this.taskbar)return this.tasks[a.id]?this.tasks[a.id]:null},addTask:function(a){var d=this;d.taskbar||d.createTaskbar();if(d.tasks[a.id])return d.tasks[a.id];var g=a.get("title"),g=d.tasks[a.id]=b('\x3cdiv class\x3d"l-taskbar-task"\x3e\x3cdiv class\x3d"l-taskbar-task-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-taskbar-task-content"\x3e'+g+"\x3c/div\x3e\x3c/div\x3e");d.taskbar.tasks.append(g);d.activeTask(a);g.bind("click",function(){d.activeTask(a);a.actived?a.min():a.active()}).hover(function(){b(this).addClass("l-taskbar-task-over")},function(){b(this).removeClass("l-taskbar-task-over")});return g},hasTask:function(){for(var a in this.tasks)if(this.tasks[a])return!0;return!1},removeTask:function(a){this.taskbar&&(this.tasks[a.id]&&(this.tasks[a.id].unbind(),this.tasks[a.id].remove(),delete this.tasks[a.id]),this.hasTask()||this.removeTaskbar())},setFront:function(a){var d=liger.find(liger.core.Win),g;for(g in d){var e=d[g];e==a?(b(e.element).css("z-index","9200"),this.activeTask(e)):b(e.element).css("z-index","9100")}}};liger.core.Win=function(a,d){liger.core.Win.base.constructor.call(this,a,d)};liger.core.Win.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Win"},mask:function(){this.options.modal&&liger.win.mask(this)},unmask:function(){this.options.modal&&liger.win.unmask(this)},min:function(){},max:function(){},active:function(){}});liger.draggable={dragging:!1};liger.resizable={reszing:!1};liger.toJSON="object"===typeof JSON&&JSON.stringify?JSON.stringify:function(a){var d=function(d){return 10>d?"0"+d:d},b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=function(d){b.lastIndex=0;return b.test(d)?'"'+d.replace(b,function(d){var a=meta[d];return"string"===typeof a?a:"\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'};if(null===a)return"null";var f=typeof a;if("undefined"!==f){if("string"===f)return e(a);if("number"===f||"boolean"===f)return""+a;if("object"===f){if("function"===typeof a.toJSON)return liger.toJSON(a.toJSON());if(a.constructor===Date)return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null;d=[];if(a.constructor===Array){for(var e=0,h=a.length;e<h;e++)d.push(liger.toJSON(a[e])||"null");return"["+d.join(",")+"]"}var k;for(h in a){f=typeof h;if("number"===f)k='"'+h+'"';else if("string"===f)k=e(h);else continue;f=typeof a[h];"function"!==f&&"undefined"!==f&&(f=liger.toJSON(a[h]),d.push(k+":"+f))}return"{"+d.join(",")+"}"}}};liger.getEditor=function(a){var d=a.type,g=a.control,e=a.master;if(!d)return null;g&&(g=g.substr(0,1).toUpperCase()+g.substr(1));return b.extend({create:function(f,h,k){var m=h.field||h.column,n=k||{};k=h.column?!0:!1;var q=b.extend({},a.options),r="text";-1!=b.inArray(d,["password","file"])&&(r=d);a.password&&(r="password");var s=b("\x3cinput type\x3d'"+r+"'/\x3e");a.body&&(s=a.body.clone());s.appendTo(f);h.field&&(f=m.name,r=b.isFunction(n.prefixID)?n.prefixID(e):n.prefixID||"",q.id=m.id||r+m.name,-1!=b.inArray(d,["select","combobox","autocomplete","popup"])&&(f=m.textField||m.comboboxName,m.comboboxName&&!m.id&&(q.id=(n.prefixID||"")+m.comboboxName)),-1!=b.inArray(d,"select combobox autocomplete popup radiolist checkboxlist listbox".split(" "))&&(q.valueFieldID=r+m.name),a.body||(s.attr(b.extend({name:r+f},m.attr)),m.cssClass&&s.addClass(m.cssClass),m.validate&&!e.options.unSetValidateAttr&&s.attr("validate",liger.toJSON(m.validate))),b.extend(q,m.options));if(m.editor){b.extend(q,m.editor.options);m.editor.valueColumnName&&(q.valueField=m.editor.valueColumnName);m.editor.displayColumnName&&(q.textField=m.editor.displayColumnName);if(g){var n=liger.defaults[g],t;for(t in n)t in m.editor&&(q[t]=m.editor[t])}m=m.editor.p||m.editor.ext;m="function"==typeof m?m(h):m;b.extend(q,m)}h=s["liger"+g](q);k&&setTimeout(function(){s.focus()},100);return h},getValue:function(d,a){if(d.getValue)return d.getValue()},setValue:function(d,a,c){d.setValue&&d.setValue(a)},getText:function(d,a){if(d.getText)return d.getText()},setText:function(d,a,c){d.setText&&d.setText(a)},getSelected:function(d,a){if(d.getSelected)return d.getSelected()},resize:function(d,a,c,b){b.field&&(a-=2);d.resize&&d.resize(a,c)},destroy:function(d,a){d.destroy&&d.destroy()}},a)};liger.editors={text:{control:"TextBox"},date:{control:"DateEditor",setValue:function(a,d,b){"string"==typeof d&&/^\/Date/.test(d)&&(d=d.replace(/^\//,"new ").replace(/\/$/,""),eval("value \x3d "+d));a.setValue(d)}},combobox:{control:"ComboBox"},spinner:{control:"Spinner"},checkbox:{control:"CheckBox"},checkboxlist:{control:"CheckBoxList",body:b("\x3cdiv\x3e\x3c/div\x3e"),resize:function(a,d,b,e){a.set("width",d-2)}},radiolist:{control:"RadioList",body:b("\x3cdiv\x3e\x3c/div\x3e"),resize:function(a,d,b,e){a.set("width",d-2)}},listbox:{control:"ListBox",body:b("\x3cdiv\x3e\x3c/div\x3e"),resize:function(a,d,b,e){a.set("width",d-2)}},popup:{control:"PopupEdit"},number:{control:"TextBox",options:{number:!0}},currency:{control:"TextBox",options:{currency:!0}},digits:{control:"TextBox",options:{digits:!0}},password:{control:"TextBox",password:!0}};liger.editors.string=liger.editors.text;liger.editors.select=liger.editors.combobox;liger.editors["int"]=liger.editors.digits;liger.editors["float"]=liger.editors.number;liger.editors.chk=liger.editors.checkbox;liger.editors.popupedit=liger.editors.popup;b.fn.live=b.fn.on?b.fn.on:b.fn.live;if(!b.browser){var a=navigator.userAgent.toLowerCase();b.browser={version:(a.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(a),opera:/opera/.test(a),msie:/msie/.test(a)&&!/opera/.test(a),mozilla:/mozilla/.test(a)&&!/(compatible|webkit)/.test(a)}}})(jQuery);(function(b){liger.inject={prev:"liger-",defaults:{Grid_detail:{height:null,onShowDetail:null},Grid_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Grid_editor",Grid_popup:"PopupEdit",Grid_grid:"Grid",Grid_condition:"Form",Grid_toolbar:"Toolbar",Grid_fields:"Form_fields",Form_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Form_editor",Form_grid:"Grid",Form_columns:"Grid_columns",Form_condition:"Form",Form_popup:"PopupEdit",Form_buttons:"Button",Portal_panel:"Panel"},config:{Grid:{dynamics:"data,isChecked,detail,rowDraggingRender,toolbar,columns",arrays:"columns",columns:{dynamics:"render,totalSummary,headerRender,columns,editor,columns",arrays:"columns",textProperty:"display",columns:"liger.inject.config.Grid.columns",editor:{dynamics:"data,columns,render,renderItem,grid,condition,ext",grid:"liger.inject.config.Grid",condition:"liger.inject.config.Form"}},toolbar:{arrays:"items"}},Form:{dynamics:"validate,fields,buttons",arrays:"fields,buttons",fields:{textProperty:"label",dynamics:"validate,editor",editor:{dynamics:"data,columns,render,renderItem,grid,condition,attr",grid:"liger.inject.config.Grid",condition:"liger.inject.config.Form"}},buttons:"liger.inject.config.Button"},PopupEdit:{dynamics:"grid,condition"},Button:{textProperty:"text",dynamics:"click"},ComboBox:{dynamics:"columns,data,tree,grid,condition,render,parms,renderItem"},ListBox:{dynamics:"columns,data,render,parms"},RadioList:{dynamics:"data,parms"},CheckBoxList:{dynamics:"data,parms"},Panel:{},Portal:{dynamics:"rows,columns",arrays:"rows,columns",columns:{dynamics:"panels",arrays:"panels"},rows:{dynamics:"panels",arrays:"panels"},toolbar:{arrays:"items"}}},parse:function(a){try{return null==a?null:(new Function("return "+a+";"))()}catch(c){return null}},parseDefault:function(a){var c=this;if(!a)return a;var d={};b(a.split(",")).each(function(a,e){e&&(e=e.substr(0,1).toUpperCase()+e.substr(1),b.extend(d,c.parse("liger.defaults."+e)))});return d},fotmatValue:function(a,c){return"boolean"==c?"true"==a||"1"==a:"number"==c&&a?parseFloat(a.toString()):a},getOptions:function(a){var c=a.jelement,d=a.defaults,g=a.config,g=b.extend({ignores:"",dynamics:"",arrays:""},g),e=this,f={},h;g.textProperty&&(f[g.textProperty]=c.text());for(var k in d)if(d=k.toLowerCase(),d=b("\x3e ."+d,c),-1==b.inArray(k,g.ignores.split(",")))if(d.length){var m=a.controlName+"_"+k,n=e.defaults[m]||liger.defaults[m],q=g[k];"string"==typeof n?n=e.parseDefault(n):"funcion"==typeof n&&(n=n());"string"==typeof q?q=e.parse(q):"funcion"==typeof q&&(q=q());n&&(-1!=b.inArray(k,g.arrays.split(","))?(h=[],b("\x3ediv,\x3eli,\x3einput",d).each(function(){h.push(e.getOptions({defaults:n,controlName:a.controlName,config:q,jelement:b(this)}))}),f[k]=h):f[k]=e.getOptions({defaults:n,controlName:a.controlName,config:q,jelement:d}));d.remove()}else(h=-1!=b.inArray(k,g.dynamics.split(","))||0==k.indexOf("on")?e.parse(c.attr("data-"+k)||c.attr(k)):c.attr("data-"+k)||c.attr(k))&&(f[k]=e.fotmatValue(h));(c=c.attr("data-options")||c.attr("data-property"))&&(c=e.parse("{"+c+"}"));c&&b.extend(f,c);return f},init:function(){var a=this,c=this.config,d;for(d in a.defaults)"string"==typeof a.defaults[d]&&(a.defaults[d]=a.parseDefault(a.defaults[d]));for(var g in liger.controls){var e=c[g]||{};d=a.prev+g.toLowerCase();b("."+d).each(function(){var d=b(this),c=b.extend({onrender:null,onrendered:null},liger.defaults[g]),c=a.getOptions({defaults:c,controlName:g,config:e,jelement:d});d[liger.pluginPrev+g](c)})}}};b(function(){liger.inject.init()})})(jQuery);(function(b){b.fn.ligerAccordion=function(a){return b.ligerui.run.call(this,"ligerAccordion",arguments)};b.fn.ligerGetAccordionManager=function(){return b.ligerui.get(this)};b.ligerDefaults.Accordion={height:null,speed:"normal",changeHeightOnResize:!1,heightDiff:0};b.ligerMethos.Accordion={};b.ligerui.controls.Accordion=function(a,c){b.ligerui.controls.Accordion.base.constructor.call(this,a,c)};b.ligerui.controls.Accordion.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Accordion"},__idPrev:function(){return"Accordion"},_extendMethods:function(){return b.ligerMethos.Accordion},_render:function(){var a=this,c=this.options;a.accordion=b(a.element);a.accordion.hasClass("l-accordion-panel")||a.accordion.addClass("l-accordion-panel");var d=0;0<b("\x3e div[lselected\x3dtrue]",a.accordion).length&&(d=b("\x3e div",a.accordion).index(b("\x3e div[lselected\x3dtrue]",a.accordion)));b("\x3e div",a.accordion).each(function(a,c){var f=b('\x3cdiv class\x3d"l-accordion-header"\x3e\x3cdiv class\x3d"l-accordion-toggle"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-accordion-header-inner"\x3e\x3c/div\x3e\x3c/div\x3e');a==d&&b(".l-accordion-toggle",f).addClass("l-accordion-toggle-open");b(c).attr("title")&&(b(".l-accordion-header-inner",f).html(b(c).attr("title")),b(c).attr("title",""));b(c).before(f);b(c).hasClass("l-accordion-content")||b(c).addClass("l-accordion-content")});b(".l-accordion-toggle",a.accordion).each(function(){b(this).hasClass("l-accordion-toggle-open")||b(this).hasClass("l-accordion-toggle-close")||b(this).addClass("l-accordion-toggle-close");b(this).hasClass("l-accordion-toggle-close")&&b(this).parent().next(".l-accordion-content:visible").hide()});b(".l-accordion-header",a.accordion).hover(function(){b(this).addClass("l-accordion-header-over")},function(){b(this).removeClass("l-accordion-header-over")});b(".l-accordion-toggle",a.accordion).hover(function(){b(this).hasClass("l-accordion-toggle-open")?b(this).addClass("l-accordion-toggle-open-over"):b(this).hasClass("l-accordion-toggle-close")&&b(this).addClass("l-accordion-toggle-close-over")},function(){b(this).hasClass("l-accordion-toggle-open")?b(this).removeClass("l-accordion-toggle-open-over"):b(this).hasClass("l-accordion-toggle-close")&&b(this).removeClass("l-accordion-toggle-close-over")});b("\x3e.l-accordion-header",a.accordion).click(function(){var d=b(".l-accordion-toggle:first",this);d.hasClass("l-accordion-toggle-close")?(d.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over"),d.addClass("l-accordion-toggle-open"),b(this).next(".l-accordion-content").show(c.speed).siblings(".l-accordion-content:visible").hide(c.speed),b(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")):(d.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close"),b(this).next(".l-accordion-content").hide(c.speed))});a.headerHoldHeight=0;b("\x3e .l-accordion-header",a.accordion).each(function(){a.headerHoldHeight+=b(this).height()});c.height&&"string"==typeof c.height&&0<c.height.indexOf("%")?(a.onResize(),c.changeHeightOnResize&&b(window).resize(function(){a.onResize()})):c.height?(a.height=c.heightDiff+c.height,a.accordion.height(a.height),a.setHeight(c.height)):a.header=a.accordion.height();a.set(c)},onResize:function(){var a=this.options;if(!a.height||"string"!=typeof a.height||-1==a.height.indexOf("%"))return!1;if("body"==this.accordion.parent()[0].tagName.toLowerCase()){var c=b(window).height(),c=c-parseInt(this.layout.parent().css("paddingTop")),c=c-parseInt(this.layout.parent().css("paddingBottom"));this.height=a.heightDiff+0.01*c*parseFloat(this.height)}else this.height=a.heightDiff+0.01*this.accordion.parent().height()*parseFloat(a.height);this.accordion.height(this.height);this.setContentHeight(this.height-this.headerHoldHeight)},setHeight:function(a){this.accordion.height(a);a-=this.headerHoldHeight;b("\x3e .l-accordion-content",this.accordion).height(a)}})})(jQuery);(function(b){b.fn.ligerButton=function(a){return b.ligerui.run.call(this,"ligerButton",arguments)};b.fn.ligerGetButtonManager=function(){return b.ligerui.run.call(this,"ligerGetButtonManager",arguments)};b.ligerDefaults.Button={width:60,text:"Button",disabled:!1,click:null,icon:null};b.ligerMethos.Button={};b.ligerui.controls.Button=function(a,c){b.ligerui.controls.Button.base.constructor.call(this,a,c)};b.ligerui.controls.Button.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"Button"},__idPrev:function(){return"Button"},_extendMethods:function(){return b.ligerMethos.Button},_render:function(){var a=this,c=this.options;a.button=b(a.element);a.button.addClass("l-button");a.button.append('\x3cdiv class\x3d"l-button-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-button-r"\x3e\x3c/div\x3e\x3cspan\x3e\x3c/span\x3e');a.button.hover(function(){c.disabled||a.button.addClass("l-button-over")},function(){c.disabled||a.button.removeClass("l-button-over")});c.click&&a.button.click(function(){c.disabled||c.click()});a.set(c)},_setIcon:function(a){a?(this.button.addClass("l-button-hasicon"),this.button.append('\x3cimg src\x3d"'+a+'" /\x3e')):(this.button.removeClass("l-button-hasicon"),this.button.find("img").remove())},_setEnabled:function(a){a&&this.button.removeClass("l-button-disabled")},_setDisabled:function(a){a?(this.button.addClass("l-button-disabled"),this.options.disabled=!0):(this.button.removeClass("l-button-disabled"),this.options.disabled=!1)},_setWidth:function(a){this.button.width(a)},_setText:function(a){b("span",this.button).html(a)},setValue:function(a){this.set("text",a)},getValue:function(){return this.options.text},setEnabled:function(){this.set("disabled",!1)},setDisabled:function(){this.set("disabled",!0)}})})(jQuery);(function(b){b.fn.ligerCheckBox=function(a){return b.ligerui.run.call(this,"ligerCheckBox",arguments)};b.fn.ligerGetCheckBoxManager=function(){return b.ligerui.run.call(this,"ligerGetCheckBoxManager",arguments)};b.ligerDefaults.CheckBox={disabled:!1,readonly:!1};b.ligerMethos.CheckBox={};b.ligerui.controls.CheckBox=function(a,c){b.ligerui.controls.CheckBox.base.constructor.call(this,a,c)};b.ligerui.controls.CheckBox.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"CheckBox"},__idPrev:function(){return"CheckBox"},_extendMethods:function(){return b.ligerMethos.CheckBox},_render:function(){var a=this,c=this.options;a.input=b(a.element);a.link=b('\x3ca class\x3d"l-checkbox"\x3e\x3c/a\x3e');a.wrapper=a.input.addClass("l-hidden").wrap('\x3cdiv class\x3d"l-checkbox-wrapper"\x3e\x3c/div\x3e').parent();a.wrapper.prepend(a.link);a.link.click(function(){if(a.input.attr("disabled")||a.input.attr("readonly")||c.disabled||c.readonly||!1==a.trigger("beforeClick",[a.element]))return!1;b(this).hasClass("l-checkbox-checked")?a._setValue(!1):a._setValue(!0);a.input.trigger("change")});a.wrapper.hover(function(){c.disabled||b(this).addClass("l-over")},function(){b(this).removeClass("l-over")});this.set(c);this.updateStyle()},_setCss:function(a){this.wrapper.css(a)},_setValue:function(a){a?(this.input[0].checked=!0,this.link.addClass("l-checkbox-checked")):(this.input[0].checked=!1,this.link.removeClass("l-checkbox-checked"))},_setDisabled:function(a){a?(this.input.attr("disabled",!0),this.wrapper.addClass("l-disabled")):(this.input.attr("disabled",!1),this.wrapper.removeClass("l-disabled"))},_getValue:function(){return this.element.checked},updateStyle:function(){this.input.attr("disabled")&&(this.wrapper.addClass("l-disabled"),this.options.disabled=!0);this.input[0].checked?this.link.addClass("l-checkbox-checked"):this.link.removeClass("l-checkbox-checked")}})})(jQuery);(function(b){b.fn.ligerCheckBoxList=function(a){return b.ligerui.run.call(this,"ligerCheckBoxList",arguments)};b.ligerDefaults.CheckBoxList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null};b.ligerMethos.CheckBoxList=b.ligerMethos.CheckBoxList||{};b.ligerui.controls.CheckBoxList=function(a,c){b.ligerui.controls.CheckBoxList.base.constructor.call(this,a,c)};b.ligerui.controls.CheckBoxList.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"CheckBoxList"},_extendMethods:function(){return b.ligerMethos.CheckBoxList},_init:function(){b.ligerui.controls.CheckBoxList.base._init.call(this)},_render:function(){var a=this.options;this.data=a.data;this.valueField=null;a.valueFieldID?(this.valueField=b("#"+a.valueFieldID+":input,[name\x3d"+a.valueFieldID+"]:input"),0==this.valueField.length&&(this.valueField=b('\x3cinput type\x3d"hidden"/\x3e')),this.valueField[0].id=this.valueField[0].name=a.valueFieldID):(this.valueField=b('\x3cinput type\x3d"hidden"/\x3e'),this.valueField[0].id=this.valueField[0].name=this.id+"_val");null==this.valueField[0].name&&(this.valueField[0].name=this.valueField[0].id);a.valueFieldCssClass&&this.valueField.addClass(a.valueFieldCssClass);this.valueField.attr("data-ligerid",this.id);this.checkboxList=b(this.element);this.checkboxList.html('\x3cdiv class\x3d"l-checkboxlist-inner"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" border\x3d"0" class\x3d"l-checkboxlist-table"\x3e\x3c/table\x3e\x3c/div\x3e').addClass("l-checkboxlist").append(this.valueField);this.checkboxList.table=b("table:first",this.checkboxList);this.set(a);this._addClickEven()},destroy:function(){this.checkboxList&&this.checkboxList.remove();this.options=null;b.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setCss:function(a){a&&this.checkboxList.addClass(a)},_setDisabled:function(a){a?(this.checkboxList.addClass("l-checkboxlist-disabled"),b("input:checkbox",this.radioList).attr("disabled",!0)):(this.checkboxList.removeClass("l-checkboxlist-disabled"),b("input:checkbox",this.radioList).removeAttr("disabled"))},_setWidth:function(a){this.checkboxList.width(a)},_setHeight:function(a){this.checkboxList.height(a)},indexOf:function(a){var c=this.options;if(!this.data)return-1;for(var d=0,b=this.data.length;d<b;d++)if("object"==typeof a){if(this.data[d]==a)return d}else if(this.data[d][c.valueField].toString()==a.toString())return d;return-1},removeItems:function(a){var c=this;c.data&&(b(a).each(function(d,a){var b=c.indexOf(a);-1!=b&&c.data.splice(b,1)}),c.refresh())},removeItem:function(a){this.data&&(a=this.indexOf(a),-1!=a&&(this.data.splice(a,1),this.refresh()))},insertItem:function(a,c){this.data||(this.data=[]);this.data.splice(c,0,a);this.refresh()},addItems:function(a){var c=this;c.data||(c.data=[]);b(a).each(function(d,a){c.data.push(a)});c.refresh()},addItem:function(a){this.data||(this.data=[]);this.data.push(a);this.refresh()},_setValue:function(a){var c=this.options;c.value=a;this.valueField.val(c.value);this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(a){if(a){var c=this,d=this.options,d=b.isFunction(d.parms)?d.parms():d.parms;b.ajax({type:"post",url:a,data:d,cache:!1,dataType:"json",success:function(d){c.setData(d);c.trigger("success",[d])},error:function(d,a){c.trigger("error",[d,a])}})}},setUrl:function(a){return this._setUrl(a)},setParm:function(a,c){if(a){var d=this.get("parms");d||(d={});d[a]=c;this.set("parms",d)}},clearContent:function(){b("table",this.checkboxList).html("")},_setData:function(a){this.setData(a)},setData:function(a){a&&a.length&&(this.data=a,this.refresh(),this.updateStyle())},refresh:function(){var a=this.options,c=this.data;this.clearContent();if(c){for(var d=[],b=a.rowSize,e=!1,f=a.name||this.id,h=0;h<c.length;h++){var k=c[h][a.valueField],m=c[h][a.textField],n=this.id+"-"+h;0==h%b&&(e&&d.push("\x3c/tr\x3e"),d.push("\x3ctr\x3e"),e=!0);d.push("\x3ctd\x3e\x3cinput type\x3d'checkbox' name\x3d'"+f+"' value\x3d'"+k+"' id\x3d'"+n+"'/\x3e\x3clabel for\x3d'"+n+"'\x3e"+m+"\x3c/label\x3e\x3c/td\x3e")}e&&d.push("\x3c/tr\x3e");this.checkboxList.table.append(d.join(""))}},_getValue:function(){var a=this.options,c=[];b('input:checkbox[name\x3d"'+(a.name||this.id)+'"]:checked').each(function(){c.push(this.value)});return c.length?c.join(a.split):null},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},_dataInit:function(){var a=this.valueField.val();this._changeValue(a)},_changeValue:function(a){var c=this.options,d=c.name||this.id,g=a?a.split(c.split):[];b("input:checkbox[name\x3d'"+d+"']",this.checkboxList).each(function(){this.checked=-1<b.inArray(this.value,g)});this.valueField.val(a);this.selectedValue=a},_addClickEven:function(){var a=this;a.checkboxList.click(function(c){(c=a.getValue())&&a.valueField.val(c)})}})})(jQuery);(function(b){b.fn.ligerComboBox=function(a){return b.ligerui.run.call(this,"ligerComboBox",arguments)};b.fn.ligerGetComboBoxManager=function(){return b.ligerui.run.call(this,"ligerGetComboBoxManager",arguments)};b.ligerDefaults.ComboBox={resize:!0,isMultiSelect:!1,isShowCheckBox:!1,columns:null,selectBoxWidth:null,selectBoxHeight:120,onBeforeSelect:!1,onSelected:null,initValue:null,initText:null,valueField:"id",textField:"text",valueFieldID:null,slide:!1,split:";",data:null,tree:null,treeLeafOnly:!0,condition:null,grid:null,onStartResize:null,onEndResize:null,hideOnLoseFocus:!0,hideGridOnLoseFocus:!1,url:null,emptyText:"\uff08\u7a7a\uff09",addRowButton:"\u65b0\u589e",addRowButtonClick:null,triggerIcon:null,onSuccess:null,onError:null,onBeforeOpen:null,onButtonClick:null,render:null,absolute:!0,cancelable:!0,css:null,parms:null,renderItem:null,autocomplete:!1,highLight:!1,readonly:!1,ajaxType:"post",alwayShowInTop:!1,valueFieldCssClass:null};b.ligerDefaults.ComboBoxString={Search:"\u641c\u7d22"};b.ligerMethos.ComboBox=b.ligerMethos.ComboBox||{};b.ligerui.controls.ComboBox=function(a,c){b.ligerui.controls.ComboBox.base.constructor.call(this,a,c)};b.ligerui.controls.ComboBox.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"ComboBox"},_extendMethods:function(){return b.ligerMethos.ComboBox},_init:function(){b.ligerui.controls.ComboBox.base._init.call(this);var a=this.options;a.columns&&(a.isShowCheckBox=!0);a.isMultiSelect&&(a.isShowCheckBox=!0)},_render:function(){var a=this,c=this.options;a.data=c.data;a.inputText=null;a.select=null;a.textFieldID="";a.valueFieldID="";a.valueField=null;"input"==this.element.tagName.toLowerCase()?(this.element.readOnly=!0,a.inputText=b(this.element),a.textFieldID=this.element.id):"select"==this.element.tagName.toLowerCase()&&(b(this.element).hide(),a.select=b(this.element),c.isMultiSelect=!1,c.isShowCheckBox=!1,c.cancelable=!1,a.textFieldID=this.element.id+"_txt",a.inputText=b('\x3cinput type\x3d"text" readonly\x3d"true"/\x3e'),a.inputText.attr("id",a.textFieldID).insertAfter(b(this.element)));void 0==a.inputText[0].name&&(a.inputText[0].name=a.textFieldID);a.valueField=null;c.valueFieldID?(a.valueField=b("#"+c.valueFieldID+":input,[name\x3d"+c.valueFieldID+"]:input").filter("input:hidden"),0==a.valueField.length&&(a.valueField=b('\x3cinput type\x3d"hidden"/\x3e')),a.valueField[0].id=a.valueField[0].name=c.valueFieldID):(a.valueField=b('\x3cinput type\x3d"hidden"/\x3e'),a.valueField[0].id=a.valueField[0].name=a.textFieldID+"_val");c.valueFieldCssClass&&a.valueField.addClass(c.valueFieldCssClass);void 0==a.valueField[0].name&&(a.valueField[0].name=a.valueField[0].id);null!=c.initValue&&(a.valueField[0].value=c.initValue);a.valueField.attr("data-ligerid",a.id);a.link=b('\x3cdiv class\x3d"l-trigger"\x3e\x3cdiv class\x3d"l-trigger-icon"\x3e\x3c/div\x3e\x3c/div\x3e');c.triggerIcon&&a.link.find("div:first").addClass(c.triggerIcon);a.selectBox=b('\x3cdiv class\x3d"l-box-select" style\x3d"display:none"\x3e\x3cdiv class\x3d"l-box-select-inner"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" border\x3d"0" class\x3d"l-box-select-table"\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e');a.selectBox.table=b("table:first",a.selectBox);a.selectBoxInner=a.selectBox.find(".l-box-select-inner:first");a.wrapper=a.inputText.wrap('\x3cdiv class\x3d"l-text l-text-combobox"\x3e\x3c/div\x3e').parent();a.wrapper.append('\x3cdiv class\x3d"l-text-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-text-r"\x3e\x3c/div\x3e');a.wrapper.append(a.link);a.textwrapper=a.wrapper.wrap('\x3cdiv class\x3d"l-text-wrapper"\x3e\x3c/div\x3e').parent();c.absolute?a.selectBox.appendTo("body").addClass("l-box-select-absolute"):a.textwrapper.append(a.selectBox);a.textwrapper.append(a.valueField);a.inputText.addClass("l-text-field");c.isShowCheckBox&&!a.select?b("table",a.selectBox).addClass("l-table-checkbox"):(c.isShowCheckBox=!1,b("table",a.selectBox).addClass("l-table-nocheckbox"));a.link.hover(function(){c.disabled||c.readonly||(this.className="l-trigger-hover")},function(){c.disabled||c.readonly||(this.className="l-trigger")}).mousedown(function(){c.disabled||c.readonly||(this.className="l-trigger-pressed")}).mouseup(function(){c.disabled||c.readonly||(this.className="l-trigger-hover")}).click(function(){if(!c.disabled&&!c.readonly){if(!1==a.trigger("buttonClick")||!1==a.trigger("beforeOpen"))return!1;a._toggleSelectBox(a.selectBox.is(":visible"))}});a.inputText.click(function(){if(!c.disabled&&!c.readonly){if(!1==a.trigger("beforeOpen"))return!1;a._toggleSelectBox(a.selectBox.is(":visible"))}}).blur(function(){c.disabled||a.wrapper.removeClass("l-text-focus")}).focus(function(){c.disabled||c.readonly||a.wrapper.addClass("l-text-focus")});a.wrapper.hover(function(){c.disabled||c.readonly||a.wrapper.addClass("l-text-over")},function(){c.disabled||c.readonly||a.wrapper.removeClass("l-text-over")});a.resizing=!1;a.selectBox.hover(null,function(d){c.hideOnLoseFocus&&a.selectBox.is(":visible")&&!a.boxToggling&&!a.resizing&&a._toggleSelectBox(!0)});a.bulidContent();a.set(c);c.selectBoxWidth?a.selectBox.width(c.selectBoxWidth):a.selectBox.css("width",a.wrapper.css("width"));c.grid&&a.bind("show",function(){a.grid||(a.setGrid(c.grid),a.set("SelectBoxHeight",c.selectBoxHeight))});a.updateSelectBoxPosition();b(document).bind("click.combobox",function(d){d=(d.target||d.srcElement).tagName.toLowerCase();"html"!=d&&"body"!=d||a._toggleSelectBox(!0)})},destroy:function(){this.wrapper&&this.wrapper.remove();this.selectBox&&this.selectBox.remove();this.options=null;b.ligerui.remove(this)},clear:function(){this._changeValue("","");b("a.l-checkbox-checked",this.selectBox).removeClass("l-checkbox-checked");b("td.l-selected",this.selectBox).removeClass("l-selected");b(":checkbox",this.selectBox).each(function(){this.checked=!1});this.trigger("clear")},_setSelectBoxHeight:function(a){if(a){var c=this.options;c.grid?this.grid&&this.grid.set("height",this.getGridHeight(a)):(a=b("tr",this.selectBox.table).length,!c.selectBoxHeight&&8>a&&(c.selectBoxHeight=30*a),c.selectBoxHeight&&(8>a?this.selectBoxInner.height("auto"):this.selectBoxInner.height(c.selectBoxHeight)))}},_setCss:function(a){a&&this.wrapper.addClass(a)},_setCancelable:function(a){var c=this,d=this.options;!a&&c.unselect&&(c.unselect.remove(),c.unselect=null);if(a||c.unselect)c.unselect=b('\x3cdiv class\x3d"l-trigger l-trigger-cancel"\x3e\x3cdiv class\x3d"l-trigger-icon"\x3e\x3c/div\x3e\x3c/div\x3e').hide(),c.wrapper.hover(function(){c.unselect.show()},function(){c.unselect.hide()}),d.disabled||d.readonly||!d.cancelable||c.wrapper.append(c.unselect),c.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){c.clear()})},_setDisabled:function(a){a?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_setReadonly:function(a){a?this.wrapper.addClass("l-text-readonly"):this.wrapper.removeClass("l-text-readonly")},_setLable:function(a){var c=this.options;a&&(this.labelwrapper?this.labelwrapper.find(".l-text-label:first").html(a+":\x26nbsp"):(this.labelwrapper=this.textwrapper.wrap('\x3cdiv class\x3d"l-labeltext"\x3e\x3c/div\x3e').parent(),this.labelwrapper.prepend('\x3cdiv class\x3d"l-text-label" style\x3d"float:left;display:inline;"\x3e'+a+":\x26nbsp\x3c/div\x3e"),this.textwrapper.css("float","left")),c.labelWidth?b(".l-text-label",this.labelwrapper).outerWidth(c.labelWidth):c.labelWidth=b(".l-text-label",this.labelwrapper).outerWidth(),b(".l-text-label",this.labelwrapper).width(c.labelWidth),b(".l-text-label",this.labelwrapper).height(this.wrapper.height()),this.labelwrapper.append('\x3cbr style\x3d"clear:both;" /\x3e'),c.labelAlign&&b(".l-text-label",this.labelwrapper).css("text-align",c.labelAlign),this.textwrapper.css({display:"inline"}),this.labelwrapper.width(this.wrapper.outerWidth()+c.labelWidth+2))},_setWidth:function(a){var c=this.options;20<a&&(this.wrapper.css({width:a}),this.inputText.css({width:a-20}),c.selectBoxWidth||this.selectBox.css({width:a}))},_setHeight:function(a){10<a&&(this.wrapper.height(a),this.inputText.height(a-2))},_setResize:function(a){var c=this,d=this.options;!d.columns&&a&&b.fn.ligerResizable&&(c.selectBox.ligerResizable({handles:d.selectBoxHeight?"e":"se,s,e",onStartResize:function(){c.resizing=!0;c.trigger("startResize")},onEndResize:function(){c.resizing=!1;if(!1==c.trigger("endResize"))return!1},onStopResize:function(d,a){return c.grid?(d.newWidth&&c.selectBox.width(d.newWidth),d.newHeight&&c.set({selectBoxHeight:d.newHeight}),c.grid.refreshSize(),c.trigger("endResize"),!1):!0}}),c.selectBox.append("\x3cdiv class\x3d'l-btn-nw-drop'\x3e\x3c/div\x3e"))},findTextByValue:function(a){var c=this.options;if(null==a)return"";var d="";b(this.data).each(function(b,e){var f=e[c.textField],h;a:{h=e[c.valueField];for(var k=a.toString().split(c.split),m=0;m<k.length;m++)if(k[m]==h){h=!0;break a}h=!1}h&&(d+=f+c.split)});0<d.length&&(d=d.substr(0,d.length-1));return d},findValueByText:function(a){var c=this.options;if(!a&&""==a)return"";var d="";b(this.data).each(function(b,e){var f=e[c.valueField],h;a:{h=e[c.textField];for(var k=a.toString().split(c.split),m=0;m<k.length;m++)if(k[m]==h){h=!0;break a}h=!1}h&&(d+=f+c.split)});0<d.length&&(d=d.substr(0,d.length-1));return d},insertItem:function(a,c){this.data=this.data||[];this.data.splice(c,0,a);this.setData(this.data)},addItem:function(a){this.insertItem(a,(this.data||[]).length)},_setValue:function(a,c){var d=this.options;c=this.findTextByValue(a);if(d.tree)this.selectValueByTree(a);else if(d.isMultiSelect){if(this._changeValue(a,c),null!=a){d=a.toString().split(d.split);b("table.l-table-checkbox :checkbox",this.selectBox).each(function(){this.checked=!1});for(var g=0;g<d.length;g++)b("table.l-table-checkbox tr[value\x3d"+d[g]+"] :checkbox",this.selectBox).each(function(){this.checked=!0})}}else this._changeValue(a,c),b("tr[value\x3d'"+a+"'] td",this.selectBox).addClass("l-selected"),b("tr[value!\x3d'"+a+"'] td",this.selectBox).removeClass("l-selected")},selectValue:function(a){this._setValue(a)},bulidContent:function(){var a=this.options;this.clearContent();this.select?this.setSelect():a.tree&&this.setTree(a.tree)},reload:function(){var a=this.options;a.url?this.set("url",a.url):this.grid&&this.grid.reload()},_setUrl:function(a){if(a){var c=this,d=this.options,g=b.isFunction(d.parms)?d.parms():d.parms;b.ajax({type:d.ajaxType,url:a,data:g,cache:!1,dataType:"json",success:function(d){c.setData(d);c.trigger("success",[d])},error:function(d,a){c.trigger("error",[d,a])}})}},setUrl:function(a){return this._setUrl(a)},setParm:function(a,c){if(a){var d=this.get("parms");d||(d={});d[a]=c;this.set("parms",d)}},clearContent:function(){b("table",this.selectBox).html("");this.inputText.val("");this.valueField.val("")},setSelect:function(){var a=this,c=this.options;this.clearContent();b("option",a.select).each(function(d){var c=b(this).val(),e=b(this).html();d=b("\x3ctr\x3e\x3ctd index\x3d'"+d+"' value\x3d'"+c+"' text\x3d'"+e+"'\x3e"+e+"\x3c/td\x3e");b("table.l-table-nocheckbox",a.selectBox).append(d);b("td",d).hover(function(){b(this).addClass("l-over")},function(){b(this).removeClass("l-over")})});b("td:eq("+a.select[0].selectedIndex+")",a.selectBox).each(function(){if(b(this).hasClass("l-selected"))a.selectBox.hide();else{b(".l-selected",a.selectBox).removeClass("l-selected");b(this).addClass("l-selected");a.select[0].selectedIndex!=b(this).attr("index")&&a.select[0].onchange&&(a.select[0].selectedIndex=b(this).attr("index"),a.select[0].onchange());var d=parseInt(b(this).attr("index"));a.select[0].selectedIndex=d;a.select.trigger("change");a.selectBox.hide();var d=b(this).attr("value"),g=b(this).html();c.render?a.inputText.val(c.render(d,g)):a.inputText.val(g)}});a._addClickEven()},_setData:function(a){this.setData(a)},setData:function(a){var c=this,d=this.options;a&&a.length||(a=[]);c.data!=a&&(c.data=a);this.clearContent();if(d.columns){c.selectBox.table.headrow=b("\x3ctr class\x3d'l-table-headerow'\x3e\x3ctd width\x3d'18px'\x3e\x3c/td\x3e\x3c/tr\x3e");c.selectBox.table.append(c.selectBox.table.headrow);c.selectBox.table.addClass("l-box-select-grid");for(var g=0;g<d.columns.length;g++){var e=b("\x3ctd columnindex\x3d'"+g+"' columnname\x3d'"+d.columns[g].name+"'\x3e"+d.columns[g].header+"\x3c/td\x3e");d.columns[g].width&&e.width(d.columns[g].width);c.selectBox.table.headrow.append(e)}}e=[];d.emptyText&&!c.emptyRow&&(c.emptyRow={},c.emptyRow[d.textField]=d.emptyText,c.emptyRow[d.valueField]=null,a.splice(0,0,c.emptyRow));for(var f=0;f<a.length;f++){var g=a[f][d.valueField],h=a[f][d.textField];if(d.columns){e.push("\x3ctr value\x3d'"+g+"'\x3e\x3ctd style\x3d'width:18px;'  index\x3d'"+f+"' value\x3d'"+g+"' text\x3d'"+h+"' \x3e\x3cinput type\x3d'checkbox' /\x3e\x3c/td\x3e");for(g=0;g<d.columns.length;g++)e.push("\x3ctd\x3e"+a[f][d.columns[g].name]+"\x3c/td\x3e");e.push("\x3c/tr\x3e")}else{e.push("\x3ctr value\x3d'"+g+"'\x3e");d.isShowCheckBox&&e.push("\x3ctd style\x3d'width:18px;'  index\x3d'"+f+"' value\x3d'"+g+"' text\x3d'"+h+"' \x3e\x3cinput type\x3d'checkbox' /\x3e\x3c/td\x3e");var k=h;d.renderItem?k=d.renderItem.call(c,{data:a[f],value:g,text:h,key:c.inputText.val()}):d.autocomplete&&d.highLight&&(k=c._highLight(h,c.inputText.val()));e.push("\x3ctd index\x3d'"+f+"' value\x3d'"+g+"' text\x3d'"+h+"' align\x3d'left'\x3e"+k+"\x3c/td\x3e\x3c/tr\x3e")}}d.columns?c.selectBox.table.append(e.join("")):d.isShowCheckBox?b("table.l-table-checkbox",c.selectBox).append(e.join("")):b("table.l-table-nocheckbox",c.selectBox).append(e.join(""));d.addRowButton&&d.addRowButtonClick&&!c.addRowButton&&(c.addRowButton=b('\x3cdiv class\x3d"l-box-select-add"\x3e\x3ca href\x3d"javascript:void(0)" class\x3d"link"\x3e\x3cdiv class\x3d"icon"\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e'),c.addRowButton.find(".link").append(d.addRowButton).click(d.addRowButtonClick),c.selectBoxInner.after(c.addRowButton));c.set("selectBoxHeight",d.selectBoxHeight);d.isShowCheckBox&&b.fn.ligerCheckBox&&b("table input:checkbox",c.selectBox).ligerCheckBox();b(".l-table-checkbox input:checkbox",c.selectBox).change(function(){if(this.checked&&c.hasBind("beforeSelect")){var a=null,a="div"==b(this).parent().get(0).tagName.toLowerCase()?b(this).parent().parent():b(this).parent();if(null!=a&&!1==c.trigger("beforeSelect",[a.attr("value"),a.attr("text")]))return c.selectBox.slideToggle("fast"),!1}!d.isMultiSelect&&this.checked&&(b("input:checked",c.selectBox).not(this).each(function(){this.checked=!1;b(".l-checkbox-checked",b(this).parent()).removeClass("l-checkbox-checked")}),c.selectBox.slideToggle("fast"));c._checkboxUpdateValue()});b("table.l-table-nocheckbox td",c.selectBox).hover(function(){b(this).addClass("l-over")},function(){b(this).removeClass("l-over")});c._addClickEven();d.autocomplete||c.updateStyle()},setTree:function(a){var c=this,d=this.options;this.clearContent();c.selectBox.table.remove();!1!=a.checkbox?a.onCheck=function(){var a=c.treeManager.getChecked(),e=[],f=[];b(a).each(function(a,c){d.treeLeafOnly&&c.data.children||(e.push(c.data[d.valueField]),f.push(c.data[d.textField]))});c._changeValue(e.join(d.split),f.join(d.split))}:(a.onSelect=function(a){!1!=c.trigger("BeforeSelect"[a])&&(d.treeLeafOnly&&a.data.children||c._changeValue(a.data[d.valueField],a.data[d.textField]))},a.onCancelSelect=function(d){c._changeValue("","")});a.onAfterAppend=function(a,b){if(c.treeManager){var f=null;d.initValue?f=d.initValue:""!=c.valueField.val()&&(f=c.valueField.val());c.selectValueByTree(f)}};c.tree=b("\x3cul\x3e\x3c/ul\x3e");b("div:first",c.selectBox).append(c.tree);c.tree.ligerTree(a);c.treeManager=c.tree.ligerGetTreeManager()},selectValueByTree:function(a){var c=this,d=this.options;if(null!=a){var g="",e=a.toString().split(d.split);b(e).each(function(a,b){c.treeManager.selectNode(b.toString());g+=c.treeManager.getTextByID(b);a<e.length-1&&(g+=d.split)});c._changeValue(a,g)}},setGrid:function(a){var c=this,d=this.options;if(!c.grid){d.hideOnLoseFocus=d.hideGridOnLoseFocus?!0:!1;this.clearContent();c.selectBox.addClass("l-box-select-lookup");c.selectBox.table.remove();var g=b("div:first",c.selectBox),e=b("\x3cdiv\x3e\x3c/div\x3e").appendTo(g),g=b("\x3cdiv\x3e\x3c/div\x3e").appendTo(g);c.conditionPanel=e;if(d.condition){var f=b.extend({labelWidth:60,space:20,width:d.selectBoxWidth},d.condition);c.condition=e.ligerForm(f)}else e.remove();a=b.extend({columnWidth:120,alternatingRow:!1,frozen:!0,rownumbers:!0,allowUnSelectRow:!0},a,{width:"100%",height:c.getGridHeight(),inWindow:!1,parms:d.parms,isChecked:function(a){var g=c.getValue();return g&&d.valueField&&a[d.valueField]?-1!=b.inArray(a[d.valueField].toString(),g.split(d.split)):!1}});c.grid=c.gridManager=g.ligerGrid(a);c.grid.bind("afterShowData",function(){c.updateSelectBoxPosition()});var h=[],k=function(){var g=[],e=[];b(h).each(function(a,c){g.push(c[d.valueField]);e.push(c[d.textField])});c.selected=a.checkbox?h:h.length?h[0]:null;c._changeValue(g.join(d.split),e.join(d.split));c.trigger("gridSelect",{value:g.join(d.split),text:e.join(d.split),data:h})},m=function(a){for(var c=h.length-1;0<=c;c--)h[c][d.valueField]==a[d.valueField]&&h.splice(c,1)},n=function(a){for(var c=h.length-1;0<=c;c--)if(h[c][d.valueField]==a[d.valueField])return;h.push(a)};a.checkbox?(c.grid.bind("CheckAllRow",function(d){b(c.grid.rows).each(function(a){d&&n(a);!d&&m(a)});k()}),c.grid.bind("CheckRow",function(d,a){d&&n(a);!d&&m(a);k()})):(c.grid.bind("SelectRow",function(d){h=[d];k();c._toggleSelectBox(!0)}),c.grid.bind("UnSelectRow",function(){h=[];k()}));c.bind("show",function(){c.grid.refreshSize()});c.bind("clear",function(){h=[];c.grid.selecteds=[];c.grid._showData()});d.condition&&(g=b('\x3cli style\x3d"margin-right:9px"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/li\x3e'),f=b('\x3cli style\x3d"margin-right:9px;float:right"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/li\x3e'),b("ul:first",e).append(g).append(f).after('\x3cdiv class\x3d"l-clear"\x3e\x3c/div\x3e'),b("div",g).ligerButton({text:d.Search,width:40,click:function(){var d=c.condition.toConditions();c.grid.setParm(a.conditionParmName||"condition",b.ligerui.toJSON(d));c.grid.reload()}}),b("div",f).ligerButton({text:"\u5173\u95ed",width:40,click:function(){c.selectBox.hide()}}));c.grid.refreshSize()}},getGridHeight:function(a){a=a||this.selectBox.height();return a-=this.conditionPanel.height()},_getValue:function(){return b(this.valueField).val()},getValue:function(){return this._getValue()},getSelected:function(){return this.selected},getText:function(){return this.inputText.val()},setText:function(a){this.inputText.val(a)},updateStyle:function(){this.options.initValue=this._getValue();this._dataInit()},_dataInit:function(){var a=this.options,c=null;null!=a.initValue&&null!=a.initText&&this._changeValue(a.initValue,a.initText);if(null!=a.initValue)if(c=a.initValue,a.tree)c&&this.selectValueByTree(c);else{if(this.data){var d=this.findTextByValue(c);this._changeValue(c,d)}}else""!=this.valueField.val()&&(c=this.valueField.val(),a.tree?c&&this.selectValueByTree(c):this.data&&(d=this.findTextByValue(c),this._changeValue(c,d)));a.isShowCheckBox?b(":checkbox",this.selectBox).each(function(){var d=null,e=b(this),d="div"==e.parent().get(0).tagName.toLowerCase()?e.parent().parent():e.parent();if(null!=d){b(".l-checkbox",d).removeClass("l-checkbox-checked");e[0].checked=!1;var f=(c||"").toString().split(a.split);b(f).each(function(a,f){null!=c&&f==d.attr("value")&&(b(".l-checkbox",d).addClass("l-checkbox-checked"),e[0].checked=!0)})}}):b("table tr",this.selectBox).find("td:first").each(function(){null!=c&&c==b(this).attr("value")?b(this).addClass("l-selected"):b(this).removeClass("l-selected")})},_changeValue:function(a,c){var d=this.options;this.valueField.val(a);d&&d.render?this.inputText.val(d.render(a,c)):this.inputText.val(c);this.selectedValue=a;this.selectedText=c;this.inputText.trigger("change").focus();this.trigger("selected",[a,c])},_checkboxUpdateValue:function(){var a=this.options,c="",d="";b("input:checked",this.selectBox).each(function(){var g=null;if(g="div"==b(this).parent().get(0).tagName.toLowerCase()?b(this).parent().parent():b(this).parent())c+=g.attr("value")+a.split,d+=g.attr("text")+a.split});0<c.length&&(c=c.substr(0,c.length-1));0<d.length&&(d=d.substr(0,d.length-1));this._changeValue(c,d)},_addClickEven:function(){var a=this,c=this.options;b(".l-table-nocheckbox td",a.selectBox).click(function(){var d=b(this).attr("value"),g=parseInt(b(this).attr("index")),e=b(this).attr("text");if(a.hasBind("beforeSelect")&&!1==a.trigger("beforeSelect",[d,e]))return c.slide?a.selectBox.slideToggle("fast"):a.selectBox.hide(),!1;b(this).hasClass("l-selected")?c.slide?a.selectBox.slideToggle("fast"):a.selectBox.hide():(b(".l-selected",a.selectBox).removeClass("l-selected"),b(this).addClass("l-selected"),a.select&&a.select[0].selectedIndex!=g&&(a.select[0].selectedIndex=g,a.select.trigger("change")),c.slide?(a.boxToggling=!0,a.selectBox.hide("fast",function(){a.boxToggling=!1})):a.selectBox.hide(),a._changeValue(d,e))})},updateSelectBoxPosition:function(){var a=this.options;if(a&&a.absolute){var c=b(document).height();a.alwayShowInTop||Number(this.wrapper.offset().top+1+this.wrapper.outerHeight()+this.selectBox.height())>c&&c>Number(this.selectBox.height()+1)?this.selectBox.css({left:this.wrapper.offset().left,top:this.wrapper.offset().top-1-this.selectBox.height()}):this.selectBox.css({left:this.wrapper.offset().left,top:this.wrapper.offset().top+1+this.wrapper.outerHeight()})}else a=this.wrapper.offset().top-b(window).scrollTop(),c=this.selectBox.height()+textHeight+4,a+c>b(window).height()&&a>c&&this.selectBox.css("marginTop",-1*(this.selectBox.height()+textHeight+5))},_toggleSelectBox:function(a){var c=this,d=this.options;c.wrapper.height();c.boxToggling=!0;if(a)d.slide?c.selectBox.slideToggle("fast",function(){c.boxToggling=!1}):(c.selectBox.hide(),c.boxToggling=!1);else if(c.updateSelectBoxPosition(),d.slide)c.selectBox.slideToggle("fast",function(){c.boxToggling=!1;if(!d.isShowCheckBox&&0<b("td.l-selected",c.selectBox).length){var a=b("td.l-selected",c.selectBox).offset().top-c.selectBox.offset().top;b(".l-box-select-inner",c.selectBox).animate({scrollTop:a})}});else if(c.selectBox.show(),c.boxToggling=!1,!c.tree&&!c.grid&&!d.isShowCheckBox&&0<b("td.l-selected",c.selectBox).length){var g=b("td.l-selected",c.selectBox).offset().top-c.selectBox.offset().top;b(".l-box-select-inner",c.selectBox).animate({scrollTop:g})}c.isShowed=c.selectBox.is(":visible");c.trigger("toggle",[a]);c.trigger(a?"hide":"show")},_highLight:function(a,c){if(!a)return a;var d=a.indexOf(c);return-1==d?a:a.substring(0,d)+"\x3cspan class\x3d'l-highLight'\x3e"+c+"\x3c/span\x3e"+a.substring(c.length+d)},_setAutocomplete:function(a){var c=this,d=this.options;if(a){c.inputText.removeAttr("readonly");var b=c.inputText.val();c.inputText.keyup(function(){setTimeout(function(){b!=c.inputText.val()&&(d.initValue="",c.valueField.val(""),d.url?(c.setParm("key",c.inputText.val()),c.set("url",d.url),c.selectBox.show()):d.grid&&(c.grid.setParm("key",c.inputText.val()),c.grid.reload()),b=c.inputText.val())},1)})}}});b.ligerui.controls.ComboBox.prototype.setValue=b.ligerui.controls.ComboBox.prototype.selectValue;b.ligerui.controls.ComboBox.prototype.setInputValue=b.ligerui.controls.ComboBox.prototype._changeValue})(jQuery);(function(b){b.fn.ligerDateEditor=function(){return b.ligerui.run.call(this,"ligerDateEditor",arguments)};b.fn.ligerGetDateEditorManager=function(){return b.ligerui.run.call(this,"ligerGetDateEditorManager",arguments)};b.ligerDefaults.DateEditor={format:"yyyy-MM-dd hh:mm",showTime:!1,onChangeDate:!1,absolute:!0,cancelable:!0,readonly:!1};b.ligerDefaults.DateEditorString={dayMessage:"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split(""),monthMessage:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),todayMessage:"\u4eca\u5929",closeMessage:"\u5173\u95ed"};b.ligerMethos.DateEditor={};b.ligerui.controls.DateEditor=function(a,c){b.ligerui.controls.DateEditor.base.constructor.call(this,a,c)};b.ligerui.controls.DateEditor.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return b.ligerMethos.DateEditor},_render:function(){var a=this,c=this.options;!c.showTime&&-1<c.format.indexOf(" hh:mm")&&(c.format=c.format.replace(" hh:mm",""));if("input"==this.element.tagName.toLowerCase()&&"text"==this.element.type){a.inputText=b(this.element);a.inputText.hasClass("l-text-field")||a.inputText.addClass("l-text-field");a.link=b('\x3cdiv class\x3d"l-trigger"\x3e\x3cdiv class\x3d"l-trigger-icon"\x3e\x3c/div\x3e\x3c/div\x3e');a.text=a.inputText.wrap('\x3cdiv class\x3d"l-text l-text-date"\x3e\x3c/div\x3e').parent();a.text.append('\x3cdiv class\x3d"l-text-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-text-r"\x3e\x3c/div\x3e');a.text.append(a.link);a.textwrapper=a.text.wrap('\x3cdiv class\x3d"l-text-wrapper"\x3e\x3c/div\x3e').parent();var d;d="\x3cdiv class\x3d'l-box-dateeditor' style\x3d'display:none'\x3e    \x3cdiv class\x3d'l-box-dateeditor-header'\x3e";d+="        \x3cdiv class\x3d'l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e";d+="        \x3cdiv class\x3d'l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e";d+="        \x3cdiv class\x3d'l-box-dateeditor-header-text'\x3e\x3ca class\x3d'l-box-dateeditor-header-month'\x3e\x3c/a\x3e , \x3ca  class\x3d'l-box-dateeditor-header-year'\x3e\x3c/a\x3e\x3c/div\x3e";d+="        \x3cdiv class\x3d'l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e";d+="        \x3cdiv class\x3d'l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e";d+="    \x3c/div\x3e";d+="    \x3cdiv class\x3d'l-box-dateeditor-body'\x3e";d+="        \x3ctable cellpadding\x3d'0' cellspacing\x3d'0' border\x3d'0' class\x3d'l-box-dateeditor-calendar'\x3e";d+="            \x3cthead\x3e";d+="                \x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3c/tr\x3e";d+="            \x3c/thead\x3e";d+="            \x3ctbody\x3e";d+="                \x3ctr class\x3d'l-first'\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3ctd align\x3d'center'\x3e\x3c/td\x3e\x3c/tr\x3e";d+="            \x3c/tbody\x3e";d+="        \x3c/table\x3e";d+="        \x3cul class\x3d'l-box-dateeditor-monthselector'\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3c/ul\x3e";d+="        \x3cul class\x3d'l-box-dateeditor-yearselector'\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3c/ul\x3e";d+="        \x3cul class\x3d'l-box-dateeditor-hourselector'\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3c/ul\x3e";d+="        \x3cul class\x3d'l-box-dateeditor-minuteselector'\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3cli\x3e\x3c/li\x3e\x3c/ul\x3e";d+="    \x3c/div\x3e";d+="    \x3cdiv class\x3d'l-box-dateeditor-toolbar'\x3e";d+="        \x3cdiv class\x3d'l-box-dateeditor-time'\x3e\x3c/div\x3e";d+="        \x3cdiv class\x3d'l-button l-button-today'\x3e\x3c/div\x3e";d+="        \x3cdiv class\x3d'l-button l-button-close'\x3e\x3c/div\x3e";d+="        \x3cdiv class\x3d'l-clear'\x3e\x3c/div\x3e";d+="    \x3c/div\x3e";d+="\x3c/div\x3e";a.dateeditor=b(d);c.absolute?a.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute"):a.textwrapper.append(a.dateeditor);a.header=b(".l-box-dateeditor-header",a.dateeditor);a.body=b(".l-box-dateeditor-body",a.dateeditor);a.toolbar=b(".l-box-dateeditor-toolbar",a.dateeditor);a.body.thead=b("thead",a.body);a.body.tbody=b("tbody",a.body);a.body.monthselector=b(".l-box-dateeditor-monthselector",a.body);a.body.yearselector=b(".l-box-dateeditor-yearselector",a.body);a.body.hourselector=b(".l-box-dateeditor-hourselector",a.body);a.body.minuteselector=b(".l-box-dateeditor-minuteselector",a.body);a.toolbar.time=b(".l-box-dateeditor-time",a.toolbar);a.toolbar.time.hour=b("\x3ca\x3e\x3c/a\x3e");a.toolbar.time.minute=b("\x3ca\x3e\x3c/a\x3e");a.buttons={btnPrevYear:b(".l-box-dateeditor-header-prevyear",a.header),btnNextYear:b(".l-box-dateeditor-header-nextyear",a.header),btnPrevMonth:b(".l-box-dateeditor-header-prevmonth",a.header),btnNextMonth:b(".l-box-dateeditor-header-nextmonth",a.header),btnYear:b(".l-box-dateeditor-header-year",a.header),btnMonth:b(".l-box-dateeditor-header-month",a.header),btnToday:b(".l-button-today",a.toolbar),btnClose:b(".l-button-close",a.toolbar)};d=new Date;a.now={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDay(),date:d.getDate(),hour:d.getHours(),minute:d.getMinutes()};a.currentDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDay(),date:d.getDate(),hour:d.getHours(),minute:d.getMinutes()};a.selectedDate=null;a.usedDate=null;b("td",a.body.thead).each(function(d,a){b(a).html(c.dayMessage[d])});b("li",a.body.monthselector).each(function(d,a){b(a).html(c.monthMessage[d])});a.buttons.btnToday.html(c.todayMessage);a.buttons.btnClose.html(c.closeMessage);c.showTime&&(a.toolbar.time.show(),a.toolbar.time.append(a.toolbar.time.hour).append(":").append(a.toolbar.time.minute),b("li",a.body.hourselector).each(function(d,a){var c=d;10>d&&(c="0"+d.toString());b(this).html(c)}),b("li",a.body.minuteselector).each(function(d,a){var c=d;10>d&&(c="0"+d.toString());b(this).html(c)}));a.bulidContent();c.initValue&&a.inputText.val(c.initValue);if(""!=a.inputText.val())a.onTextChange();a.dateeditor.hover(null,function(d){a.dateeditor.is(":visible")&&!a.editorToggling&&a.toggleDateEditor(!0)});a.link.hover(function(){c.disabled||(this.className="l-trigger-hover")},function(){c.disabled||(this.className="l-trigger")}).mousedown(function(){c.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){c.disabled||(this.className="l-trigger-hover")}).click(function(){c.disabled||(a.bulidContent(),a.toggleDateEditor(a.dateeditor.is(":visible")))});c.disabled&&(a.inputText.attr("readonly","readonly"),a.text.addClass("l-text-disabled"));a.buttons.btnClose.click(function(){a.toggleDateEditor(!0)});b("td",a.body.tbody).hover(function(){b(this).hasClass("l-box-dateeditor-today")||b(this).addClass("l-box-dateeditor-over")},function(){b(this).removeClass("l-box-dateeditor-over")}).click(function(){b(".l-box-dateeditor-selected",a.body.tbody).removeClass("l-box-dateeditor-selected");b(this).hasClass("l-box-dateeditor-today")||b(this).addClass("l-box-dateeditor-selected");a.currentDate.date=parseInt(b(this).html());a.currentDate.day=(new Date(a.currentDate.year,a.currentDate.month-1,1)).getDay();b(this).hasClass("l-box-dateeditor-out")&&(0==b("tr",a.body.tbody).index(b(this).parent())?0==--a.currentDate.month&&(a.currentDate.month=12,a.currentDate.year--):13==++a.currentDate.month&&(a.currentDate.month=1,a.currentDate.year++));a.selectedDate={year:a.currentDate.year,month:a.currentDate.month,date:a.currentDate.date};a.showDate();a.editorToggling=!0;a.dateeditor.slideToggle("fast",function(){a.editorToggling=!1})});b(".l-box-dateeditor-header-btn",a.header).hover(function(){b(this).addClass("l-box-dateeditor-header-btn-over")},function(){b(this).removeClass("l-box-dateeditor-header-btn-over")});a.buttons.btnYear.click(function(){a.body.yearselector.is(":visible")||b("li",a.body.yearselector).each(function(d,c){var f=a.currentDate.year+(d-4);f==a.currentDate.year?b(this).addClass("l-selected"):b(this).removeClass("l-selected");b(this).html(f)});a.body.yearselector.slideToggle()});a.body.yearselector.hover(function(){},function(){b(this).slideUp()});b("li",a.body.yearselector).click(function(){a.currentDate.year=parseInt(b(this).html());a.body.yearselector.slideToggle();a.bulidContent()});a.buttons.btnMonth.click(function(){b("li",a.body.monthselector).each(function(d,c){a.currentDate.month==d+1?b(this).addClass("l-selected"):b(this).removeClass("l-selected")});a.body.monthselector.slideToggle()});a.body.monthselector.hover(function(){},function(){b(this).slideUp("fast")});b("li",a.body.monthselector).click(function(){var d=b("li",a.body.monthselector).index(this);a.currentDate.month=d+1;a.body.monthselector.slideToggle();a.bulidContent()});a.toolbar.time.hour.click(function(){b("li",a.body.hourselector).each(function(d,c){a.currentDate.hour==d?b(this).addClass("l-selected"):b(this).removeClass("l-selected")});a.body.hourselector.slideToggle()});a.body.hourselector.hover(function(){},function(){b(this).slideUp("fast")});b("li",a.body.hourselector).click(function(){var d=b("li",a.body.hourselector).index(this);a.currentDate.hour=d;a.body.hourselector.slideToggle();a.bulidContent();a.showDate()});a.toolbar.time.minute.click(function(){b("li",a.body.minuteselector).each(function(d,c){a.currentDate.minute==d?b(this).addClass("l-selected"):b(this).removeClass("l-selected")});a.body.minuteselector.slideToggle("fast",function(){if(29<b("li",this).index(b("li.l-selected",this))){var d=b("li.l-selected",this).offset().top-b(this).offset().top;b(this).animate({scrollTop:d})}})});a.body.minuteselector.hover(function(){},function(){b(this).slideUp("fast")});b("li",a.body.minuteselector).click(function(){var d=b("li",a.body.minuteselector).index(this);a.currentDate.minute=d;a.body.minuteselector.slideToggle("fast");a.bulidContent();a.showDate()});a.buttons.btnPrevMonth.click(function(){0==--a.currentDate.month&&(a.currentDate.month=12,a.currentDate.year--);a.bulidContent()});a.buttons.btnNextMonth.click(function(){13==++a.currentDate.month&&(a.currentDate.month=1,a.currentDate.year++);a.bulidContent()});a.buttons.btnPrevYear.click(function(){a.currentDate.year--;a.bulidContent()});a.buttons.btnNextYear.click(function(){a.currentDate.year++;a.bulidContent()});a.buttons.btnToday.click(function(){a.currentDate={year:a.now.year,month:a.now.month,day:a.now.day,date:a.now.date};a.selectedDate={year:a.now.year,month:a.now.month,day:a.now.day,date:a.now.date};a.showDate();a.dateeditor.slideToggle("fast")});a.inputText.change(function(){a.onTextChange()}).blur(function(){a.text.removeClass("l-text-focus")}).focus(function(){a.text.addClass("l-text-focus")});a.text.hover(function(){a.text.addClass("l-text-over")},function(){a.text.removeClass("l-text-over")});c.label&&(a.labelwrapper=a.textwrapper.wrap('\x3cdiv class\x3d"l-labeltext"\x3e\x3c/div\x3e').parent(),a.labelwrapper.prepend('\x3cdiv class\x3d"l-text-label" style\x3d"float:left;display:inline;"\x3e'+c.label+":\x26nbsp\x3c/div\x3e"),a.textwrapper.css("float","left"),c.labelWidth?b(".l-text-label",a.labelwrapper).outerWidth(c.labelWidth):c.labelWidth=b(".l-text-label",a.labelwrapper).outerWidth(),b(".l-text-label",a.labelwrapper).width(c.labelWidth),b(".l-text-label",a.labelwrapper).height(a.text.height()),a.labelwrapper.append('\x3cbr style\x3d"clear:both;" /\x3e'),c.labelAlign&&b(".l-text-label",a.labelwrapper).css("text-align",c.labelAlign),a.textwrapper.css({display:"inline"}),a.labelwrapper.width(a.text.outerWidth()+c.labelWidth+2));a.set(c)}},destroy:function(){this.textwrapper&&this.textwrapper.remove();this.dateeditor&&this.dateeditor.remove();this.options=null;b.ligerui.remove(this)},bulidContent:function(){var a=this,c=this.options,d=(new Date(a.currentDate.year,a.currentDate.month-1,1)).getDay(),g=a.currentDate.month,e=a.currentDate.year;13==++g&&(g=1,e++);var f=(new Date(e,g-1,0)).getDate(),h=(new Date(a.currentDate.year,a.currentDate.month-1,0)).getDate();a.buttons.btnMonth.html(c.monthMessage[a.currentDate.month-1]);a.buttons.btnYear.html(a.currentDate.year);a.toolbar.time.hour.html(a.currentDate.hour);a.toolbar.time.minute.html(a.currentDate.minute);1==a.toolbar.time.hour.html().length&&a.toolbar.time.hour.html("0"+a.toolbar.time.hour.html());1==a.toolbar.time.minute.html().length&&a.toolbar.time.minute.html("0"+a.toolbar.time.minute.html());b("td",this.body.tbody).each(function(){this.className=""});b("tr",this.body.tbody).each(function(c,g){b("td",g).each(function(g,e){var m=7*c+(g-d),s=m+1;a.selectedDate&&a.currentDate.year==a.selectedDate.year&&a.currentDate.month==a.selectedDate.month&&m+1==a.selectedDate.date?(0!=g&&6!=g||b(e).addClass("l-box-dateeditor-holiday"),b(e).addClass("l-box-dateeditor-selected"),b(e).siblings().removeClass("l-box-dateeditor-selected")):a.currentDate.year==a.now.year&&a.currentDate.month==a.now.month&&m+1==a.now.date?(0!=g&&6!=g||b(e).addClass("l-box-dateeditor-holiday"),b(e).addClass("l-box-dateeditor-today")):0>m?(s=h+s,b(e).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):m>f-1?(s-=f,b(e).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):0==g||6==g?b(e).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected"):e.className="";b(e).html(s)})})},updateSelectBoxPosition:function(){if(this.options.absolute){var a=b(document).height();Number(this.text.offset().top+1+this.text.outerHeight()+this.dateeditor.height())>a&&a>Number(this.dateeditor.height()+1)?this.dateeditor.css({left:this.text.offset().left,top:this.text.offset().top-1-this.dateeditor.height()}):this.dateeditor.css({left:this.text.offset().left,top:this.text.offset().top+1+this.text.outerHeight()})}else this.text.offset().top+4>this.dateeditor.height()&&this.text.offset().top+this.dateeditor.height()+textHeight+4-b(window).scrollTop()>b(window).height()?(this.dateeditor.css("marginTop",-1*(this.dateeditor.height()+textHeight+5)),this.showOnTop=!0):this.showOnTop=!1},toggleDateEditor:function(a){var c=this;c.text.height();c.editorToggling=!0;a?c.dateeditor.hide("fast",function(){c.editorToggling=!1}):(c.updateSelectBoxPosition(),c.dateeditor.slideDown("fast",function(){c.editorToggling=!1}))},showDate:function(){if(this.currentDate){this.currentDate.hour=parseInt(this.toolbar.time.hour.html(),10);this.currentDate.minute=parseInt(this.toolbar.time.minute.html(),10);var a=this.currentDate.year+"/"+this.currentDate.month+"/"+this.currentDate.date+" "+this.currentDate.hour+":"+this.currentDate.minute,a=this.getFormatDate(new Date(a));this.inputText.val(a);this.onTextChange()}},isDateTime:function(a){a=a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(null==a)return!1;var c=new Date(a[1],a[3]-1,a[4]);return"NaN"==c?!1:c.getFullYear()==a[1]&&c.getMonth()+1==a[3]&&c.getDate()==a[4]},isLongDateTime:function(a){a=a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/);if(null==a)return!1;var c=new Date(a[1],a[3]-1,a[4],a[5],a[6]);return"NaN"==c?!1:c.getFullYear()==a[1]&&c.getMonth()+1==a[3]&&c.getDate()==a[4]&&c.getHours()==a[5]&&c.getMinutes()==a[6]},getFormatDate:function(a){if("NaN"==a)return null;var c=this.options.format,d={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(c)&&(c=c.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var b in d)RegExp("("+b+")").test(c)&&(c=c.replace(RegExp.$1,1==RegExp.$1.length?d[b]:("00"+d[b]).substr((""+d[b]).length)));return c},clear:function(){this.set("value","");this.usedDate=null},_setCancelable:function(a){var c=this,d=this.options;!a&&c.unselect&&(c.unselect.remove(),c.unselect=null);if(a||c.unselect)c.unselect=b('\x3cdiv class\x3d"l-trigger l-trigger-cancel"\x3e\x3cdiv class\x3d"l-trigger-icon"\x3e\x3c/div\x3e\x3c/div\x3e').hide(),c.text.hover(function(){c.unselect.show()},function(){c.unselect.hide()}),!d.disabled&&d.cancelable&&c.text.append(c.unselect),c.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){d.readonly||c.clear()})},_rever:function(){this.usedDate?this.inputText.val(this.getFormatDate(this.usedDate)):this.inputText.val("")},_getMatch:function(a){var c=[-1,-1,-1,-1,-1,-1],d=0,b="^";for(a=a||this.options.format;;){var e=a.match(/^yyyy|MM|dd|mm|hh|HH|ss|-|\/|:|\s/);if(e){var f=e[0].charAt(0),e=e[0].length,h="yMdhms".indexOf(f);-1!=h?(c[h]=d+1,b+="(\\d{1,"+e+"})"):b+="("+(" "==f?"\\s":f)+")";d++;if(e==a.length){b+="$";break}a=a.substring(e)}else return null}return{reg:RegExp(b),position:c}},_bulidDate:function(a){var c=this.options,d=this._getMatch();if(!d)return null;var b=a.match(d.reg);if(!b)return null;var e=-1==d.position[0]?1900:b[d.position[0]],f=-1==d.position[1]?0:parseInt(b[d.position[1]],10)-1,h=-1==d.position[2]?1:parseInt(b[d.position[2]],10);a=-1==d.position[3]?0:parseInt(b[d.position[3]],10);var k=-1==d.position[4]?0:parseInt(b[d.position[4]],10),d=-1==d.position[5]?0:parseInt(b[d.position[5]],10);if(0>f||11<f||0>h||31<h)return null;e=new Date(e,f,h);if(c.showTime){if(0>k||59<k||0>a||23<a||0>d||59<d)return null;e.setHours(a);e.setMinutes(k);e.setSeconds(d)}return e},updateStyle:function(){this.onTextChange()},onTextChange:function(){var a=this.inputText.val();if(!a)return this.selectedDate=null,!0;(a=this._bulidDate(a))?(this.usedDate=a,this.selectedDate={year:this.usedDate.getFullYear(),month:this.usedDate.getMonth()+1,day:this.usedDate.getDay(),date:this.usedDate.getDate(),hour:this.usedDate.getHours(),minute:this.usedDate.getMinutes()},this.currentDate={year:this.usedDate.getFullYear(),month:this.usedDate.getMonth()+1,day:this.usedDate.getDay(),date:this.usedDate.getDate(),hour:this.usedDate.getHours(),minute:this.usedDate.getMinutes()},a=this.getFormatDate(a),this.inputText.val(a),this.trigger("changeDate",[a]),b(this.dateeditor).is(":visible")&&this.bulidContent()):this._rever()},_setHeight:function(a){4<a&&(this.text.css({height:a}),this.inputText.css({height:a}),this.textwrapper.css({height:a}))},_setWidth:function(a){20<a&&(this.text.css({width:a}),this.inputText.css({width:a-20}),this.textwrapper.css({width:a}))},_setValue:function(a){a||this.inputText.val("");"string"==typeof a&&(/^\/Date/.test(a)?(a=a.replace(/^\//,"new ").replace(/\/$/,""),eval("value \x3d "+a)):this.inputText.val(a));"object"==typeof a&&a instanceof Date&&(this.inputText.val(this.getFormatDate(a)),this.onTextChange())},_getValue:function(){return this.usedDate},setEnabled:function(){var a=this.options;this.inputText.removeAttr("readonly");this.text.removeClass("l-text-disabled");a.disabled=!1},setDisabled:function(){var a=this.options;this.inputText.attr("readonly","readonly");this.text.addClass("l-text-disabled");a.disabled=!0}})})(jQuery);(function(b){var a=b.ligerui;b(".l-dialog-btn").live("mouseover",function(){b(this).addClass("l-dialog-btn-over")}).live("mouseout",function(){b(this).removeClass("l-dialog-btn-over")});b(".l-dialog-tc .l-dialog-close").live("mouseover",function(){b(this).addClass("l-dialog-close-over")}).live("mouseout",function(){b(this).removeClass("l-dialog-close-over")});b.ligerDialog=function(){return a.run.call(null,"ligerDialog",arguments,{isStatic:!0})};b.ligerui.DialogImagePath="../../lib/ligerUI/skins/Aqua/images/win/";b.ligerDefaults.Dialog={cls:null,id:null,buttons:null,isDrag:!0,width:280,height:null,content:"",target:null,url:null,load:!1,type:"none",left:null,top:null,modal:!0,data:null,name:null,isResize:!1,allowClose:!0,opener:null,timeParmName:null,closeWhenEnter:null,isHidden:!0,show:!0,title:"\u63d0\u793a",showMax:!1,showToggle:!1,showMin:!1,slide:b.browser.msie?!1:!0,fixedType:null,showType:null,onLoaded:null,onExtend:null,onExtended:null,onCollapse:null,onCollapseed:null,onContentHeightChange:null,onClose:null,onClosed:null,onStopResize:null};b.ligerDefaults.DialogString={titleMessage:"\u63d0\u793a",ok:"\u786e\u5b9a",yes:"\u662f",no:"\u5426",cancel:"\u53d6\u6d88",waittingMessage:"\u6b63\u5728\u7b49\u5f85\u4e2d,\u8bf7\u7a0d\u5019..."};b.ligerMethos.Dialog=b.ligerMethos.Dialog||{};a.controls.Dialog=function(c){a.controls.Dialog.base.constructor.call(this,null,c)};a.controls.Dialog.ligerExtend(a.core.Win,{__getType:function(){return"Dialog"},__idPrev:function(){return"Dialog"},_extendMethods:function(){return b.ligerMethos.Dialog},_render:function(){var c=this,d=this.options,g="";c.set(d,!0);var e=b('\x3cdiv class\x3d"l-dialog"\x3e\x3ctable class\x3d"l-dialog-table" style\x3d" z-index:9230" cellpadding\x3d"0" cellspacing\x3d"0" border\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd class\x3d"l-dialog-tl"\x3e\x3c/td\x3e\x3ctd class\x3d"l-dialog-tc"\x3e\x3cdiv class\x3d"l-dialog-tc-inner"\x3e\x3cdiv class\x3d"l-dialog-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-dialog-title"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-dialog-winbtns"\x3e\x3cdiv class\x3d"l-dialog-winbtn l-dialog-close"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd class\x3d"l-dialog-tr"\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd class\x3d"l-dialog-cl"\x3e\x3c/td\x3e\x3ctd class\x3d"l-dialog-cc"\x3e\x3cdiv class\x3d"l-dialog-body"\x3e\x3cdiv class\x3d"l-dialog-image"\x3e\x3c/div\x3e \x3cdiv class\x3d"l-dialog-content"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-dialog-buttons"\x3e\x3cdiv class\x3d"l-dialog-buttons-inner"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd class\x3d"l-dialog-cr"\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd class\x3d"l-dialog-bl"\x3e\x3c/td\x3e\x3ctd class\x3d"l-dialog-bc"\x3e\x3c/td\x3e\x3ctd class\x3d"l-dialog-br"\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e'),f=b('\x3cdiv id\x3d"hidde" style\x3d" z-index:9201"\x3e\x3ciframe frameborder\x3d"0"   class\x3d"IframeMask" \x3e\x3c/iframe\x3e');b("body").append(e);c.dialog=e;c.hidden=f;c.dialog.append(c.hidden);c.element=e[0];c.dialog.body=b(".l-dialog-body:first",c.dialog);c.dialog.header=b(".l-dialog-tc-inner:first",c.dialog);c.dialog.winbtns=b(".l-dialog-winbtns:first",c.dialog.header);c.dialog.buttons=b(".l-dialog-buttons:first",c.dialog);c.dialog.content=b(".l-dialog-content:first",c.dialog);c.set(d,!1);!1==d.allowClose&&b(".l-dialog-close",c.dialog).remove();if(d.target||d.url||"none"==d.type)d.type=null,c.dialog.addClass("l-dialog-win");d.cls&&c.dialog.addClass(d.cls);d.id&&c.dialog.attr("id",d.id);c.mask();d.isDrag&&c._applyDrag();d.isResize&&c._applyResize();d.type?c._setImage():(b(".l-dialog-image",c.dialog).remove(),c.dialog.content.addClass("l-dialog-content-noimage"));d.show||(c.unmask(),c.dialog.hide());d.target?(c.dialog.content.prepend(d.target),b(d.target).show()):d.url&&(d.timeParmName&&(d.url+=-1==d.url.indexOf("?")?"?":"\x26",d.url+=d.timeParmName+"\x3d"+(new Date).getTime()),d.load?c.dialog.body.load(d.url,function(){c._saveStatus();c.trigger("loaded")}):(c.jiframe=b("\x3ciframe frameborder\x3d'0'\x3e\x3c/iframe\x3e"),g=d.name?d.name:"ligerwindow"+(new Date).getTime(),c.jiframe.attr("name",g),c.jiframe.attr("id",g),c.dialog.content.prepend(c.jiframe),c.dialog.content.addClass("l-dialog-content-nopadding l-dialog-content-frame"),setTimeout(function(){0==c.dialog.body.find(".l-dialog-loading:first").length&&c.dialog.body.append("\x3cdiv class\x3d'l-dialog-loading' style\x3d'display:block;'\x3e\x3c/div\x3e");var a=b(".l-dialog-loading:first",c.dialog.body);c.jiframe[0].dialog=c;c.jiframe.attr("src",d.url).bind("load.dialog",function(){a.hide();c.trigger("loaded")});c.frame=window.frames[c.jiframe.attr("name")]},0),g="jquery_ligerui_"+(new Date).getTime(),c.tmpInput=b("\x3cinput\x3e\x3c/input\x3e"),c.tmpInput.attr("id",g),c.dialog.content.prepend(c.tmpInput)));d.opener&&(c.dialog.opener=d.opener);d.buttons?b(d.buttons).each(function(d,a){var g=b('\x3cdiv class\x3d"l-dialog-btn"\x3e\x3cdiv class\x3d"l-dialog-btn-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-dialog-btn-r"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-dialog-btn-inner"\x3e\x3c/div\x3e\x3c/div\x3e');b(".l-dialog-btn-inner",g).html(a.text);b(".l-dialog-buttons-inner",c.dialog.buttons).prepend(g);a.width&&g.width(a.width);a.onclick&&g.click(function(){a.onclick(a,c,d)});a.cls&&g.addClass(a.cls)}):c.dialog.buttons.remove();b(".l-dialog-buttons-inner",c.dialog.buttons).append("\x3cdiv class\x3d'l-clear'\x3e\x3c/div\x3e");b(".l-dialog-title",c.dialog).bind("selectstart",function(){return!1});c.dialog.click(function(){a.win.setFront(c)});b(".l-dialog-tc .l-dialog-close",c.dialog).click(function(){d.isHidden?c.hide():c.close()});if(!d.fixedType){var f=e=0,h=d.width||c.dialog.width();!0==d.slide&&(d.slide="fast");null!=d.left?e=d.left:d.left=e=0.5*(b(window).width()-h);null!=d.top?f=d.top:d.top=f=0.5*(b(window).height()-c.dialog.height())+b(window).scrollTop()-10;0>e&&(d.left=e=0);0>f&&(d.top=f=0);c.dialog.css({left:e,top:f})}c.show();b("body").bind("keydown.dialog",function(d){d=d.which;13==d?c.enter():27==d&&c.esc()});c._updateBtnsWidth();c._saveStatus();c._onReisze();""!=g&&(b("#"+g).focus(),b("#"+g).remove())},_borderX:12,_borderY:32,doMax:function(c){var d=this,g=this.options,e=b(window).width(),f=b(window).height(),h=0;a.win.taskbar&&(f-=a.win.taskbar.outerHeight(),a.win.top&&(h+=a.win.taskbar.outerHeight()));c?(d.dialog.body.animate({width:e-d._borderX},g.slide),d.dialog.animate({left:0,top:h},g.slide),d.dialog.content.animate({height:f-d._borderY-d.dialog.buttons.outerHeight()},g.slide,function(){d._onReisze()})):(d.set({width:e,height:f,left:0,top:h}),d._onReisze())},max:function(){var a=this,d=this.options;a.winmax&&(a.winmax.addClass("l-dialog-recover"),a.doMax(d.slide),a.wintoggle&&(a.wintoggle.hasClass("l-dialog-extend")?a.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-extend-disabled"):a.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-collapse-disabled")),a.resizable&&a.resizable.set({disabled:!0}),a.draggable&&a.draggable.set({disabled:!0}),a.maximum=!0,b(window).bind("resize.dialogmax",function(){a.doMax(!1)}))},recover:function(){var a=this,d=this.options;a.winmax&&(a.winmax.removeClass("l-dialog-recover"),d.slide?(a.dialog.body.animate({width:a._width-a._borderX},d.slide),a.dialog.animate({left:a._left,top:a._top},d.slide),a.dialog.content.animate({height:a._height-a._borderY-a.dialog.buttons.outerHeight()},d.slide,function(){a._onReisze()})):(a.set({width:a._width,height:a._height,left:a._left,top:a._top}),a._onReisze()),a.wintoggle&&a.wintoggle.removeClass("l-dialog-toggle-disabled l-dialog-extend-disabled l-dialog-collapse-disabled"),b(window).unbind("resize.dialogmax"));this.resizable&&this.resizable.set({disabled:!1});a.draggable&&a.draggable.set({disabled:!1});a.maximum=!1},min:function(){var b=this,d=this.options,g=a.win.getTask(this);d.slide?(b.dialog.body.animate({width:1},d.slide),g.y=g.offset().top+g.height(),g.x=g.offset().left+g.width()/2,b.dialog.animate({left:g.x,top:g.y},d.slide,function(){b.dialog.hide()})):b.dialog.hide();b.unmask();b.minimize=!0;b.actived=!1},active:function(){var c=this.options;if(this.minimize){var d=this._width,g=this._height,e=this._left,f=this._top;this.maximum&&(d=b(window).width(),g=b(window).height(),e=f=0,a.win.taskbar&&(g-=a.win.taskbar.outerHeight(),a.win.top&&(f+=a.win.taskbar.outerHeight())));c.slide?(this.dialog.body.animate({width:d-this._borderX},c.slide),this.dialog.animate({left:e,top:f},c.slide)):this.set({width:d,height:g,left:e,top:f})}this.actived=!0;this.minimize=!1;a.win.setFront(this);this.show()},toggle:function(){this.wintoggle&&(this.wintoggle.hasClass("l-dialog-extend")?this.extend():this.collapse())},collapse:function(){var a=this.options;this.wintoggle&&(a.slide?this.dialog.content.animate({height:1},a.slide):this.dialog.content.height(1),this.resizable&&this.resizable.set({disabled:!0}))},extend:function(){var a=this.options;if(this.wintoggle){var d=this._height-this._borderY-this.dialog.buttons.outerHeight();a.slide?this.dialog.content.animate({height:d},a.slide):this.dialog.content.height(d);this.resizable&&this.resizable.set({disabled:!1})}},_updateBtnsWidth:function(){var a=b("\x3ediv",this.dialog.winbtns).length;this.dialog.winbtns.width(22*a)},_setLeft:function(a){this.dialog&&null!=a&&this.dialog.css({left:a})},_setTop:function(a){this.dialog&&null!=a&&this.dialog.css({top:a})},_setWidth:function(a){this.dialog&&a>=this._borderX&&this.dialog.body.width(a-this._borderX)},_setHeight:function(a){this.dialog&&("auto"==a?this.dialog.content.height("auto"):a>=this._borderY&&(a=a-this._borderY-this.dialog.buttons.outerHeight(),!1!=this.trigger("ContentHeightChange",[a])&&(this.dialog.content.height(a),this.trigger("ContentHeightChanged",[a]))))},_setShowMax:function(a){var d=this;a?d.winmax||(d.winmax=b('\x3cdiv class\x3d"l-dialog-winbtn l-dialog-max"\x3e\x3c/div\x3e').appendTo(d.dialog.winbtns).hover(function(){b(this).hasClass("l-dialog-recover")?b(this).addClass("l-dialog-recover-over"):b(this).addClass("l-dialog-max-over")},function(){b(this).removeClass("l-dialog-max-over l-dialog-recover-over")}).click(function(){b(this).hasClass("l-dialog-recover")?d.recover():d.max()})):d.winmax&&(d.winmax.remove(),d.winmax=null);d._updateBtnsWidth()},_setShowMin:function(c){var d=this;c?d.winmin||(d.winmin=b('\x3cdiv class\x3d"l-dialog-winbtn l-dialog-min"\x3e\x3c/div\x3e').appendTo(d.dialog.winbtns).hover(function(){b(this).addClass("l-dialog-min-over")},function(){b(this).removeClass("l-dialog-min-over")}).click(function(){d.min()}),a.win.addTask(d)):d.winmin&&(d.winmin.remove(),d.winmin=null);d._updateBtnsWidth()},_setShowToggle:function(a){var d=this;a?d.wintoggle||(d.wintoggle=b('\x3cdiv class\x3d"l-dialog-winbtn l-dialog-collapse"\x3e\x3c/div\x3e').appendTo(d.dialog.winbtns).hover(function(){b(this).hasClass("l-dialog-toggle-disabled")||(b(this).hasClass("l-dialog-extend")?b(this).addClass("l-dialog-extend-over"):b(this).addClass("l-dialog-collapse-over"))},function(){b(this).removeClass("l-dialog-extend-over l-dialog-collapse-over")}).click(function(){b(this).hasClass("l-dialog-toggle-disabled")||(d.wintoggle.hasClass("l-dialog-extend")?!1!=d.trigger("extend")&&(d.wintoggle.removeClass("l-dialog-extend"),d.extend(),d.trigger("extended")):!1!=d.trigger("collapse")&&(d.wintoggle.addClass("l-dialog-extend"),d.collapse(),d.trigger("collapseed")))})):d.wintoggle&&(d.wintoggle.remove(),d.wintoggle=null)},enter:function(){var a=this.options,d;if(void 0!=a.closeWhenEnter)d=a.closeWhenEnter;else if("warn"==a.type||"error"==a.type||"success"==a.type||"question"==a.type)d=!0;d&&this.close()},esc:function(){},_removeDialog:function(){function a(){var c=b("iframe",d.dialog);if(c.length){var g=c[0];g.src="about:blank";g.contentWindow&&g.contentWindow.document&&g.contentWindow.document.write("");b.browser.msie&&CollectGarbage();c.remove()}d.dialog.remove()}var d=this,g=this.options;g.showType&&g.fixedType?d.dialog.animate({bottom:-1*g.height},function(){a()}):a()},close:function(){!1!=this.trigger("Close")&&(this.doClose(),this.trigger("Closed"))},doClose:function(){a.win.removeTask(this);b.ligerui.remove(this);this.unmask();this._removeDialog();b("body").unbind("keydown.dialog")},_getVisible:function(){return this.dialog.is(":visible")},_setUrl:function(a){var d=this,b=this.options;b.url=a;b.load?d.dialog.body.html("").load(b.url,function(){d.trigger("loaded")}):d.jiframe&&d.jiframe.attr("src",b.url)},_setContent:function(a){this.dialog.content.html(a)},_setTitle:function(a){a&&b(".l-dialog-title",this.dialog).html(a)},_hideDialog:function(){var a=this,d=this.options;d.showType&&d.fixedType?a.dialog.animate({bottom:-1*d.height},function(){a.dialog.hide()}):a.dialog.hide()},hidden:function(){a.win.removeTask(this);this.dialog.hide();this.unmask()},show:function(){var a=this.options;this.mask();a.fixedType?a.showType?(this.dialog.css({bottom:-1*a.height}).addClass("l-dialog-fixed"),this.dialog.show().animate({bottom:0})):this.dialog.show().css({bottom:0}):this.dialog.show();b.ligerui.win.setFront.ligerDefer(b.ligerui.win,100,[this])},setUrl:function(a){this._setUrl(a)},_saveStatus:function(){this._width=this.dialog.body.width();this._height=this.dialog.body.height();var a=0,d=0;isNaN(parseInt(this.dialog.css("top")))||(a=parseInt(this.dialog.css("top")));isNaN(parseInt(this.dialog.css("left")))||(d=parseInt(this.dialog.css("left")));this._top=a;this._left=d},_applyDrag:function(){var c=this,d=this.options;b.fn.ligerDrag&&(c.draggable=c.dialog.ligerDrag({handler:".l-dialog-title",animate:!1,onStartDrag:function(){a.win.setFront(c);var d=b("\x3cdiv class\x3d'l-dragging-mask' style\x3d'display:block'\x3e\x3c/div\x3e").height(c.dialog.height());c.dialog.append(d);c.dialog.content.addClass("l-dialog-content-dragging")},onDrag:function(d,a){if(0>(a.pageY||a.screenY))return!1},onStopDrag:function(){c.dialog.find("div.l-dragging-mask:first").remove();c.dialog.content.removeClass("l-dialog-content-dragging");if(d.target){var g=a.find(b.ligerui.controls.DateEditor),e=a.find(b.ligerui.controls.ComboBox);b(b.merge(g,e)).each(function(){this.updateSelectBoxPosition&&this.updateSelectBoxPosition()})}c._saveStatus()}}))},_onReisze:function(){var a=this.options;if(a.target){var d=b(a.target).liger();d||(d=b(a.target).find(":first").liger());if(d){var a=this.dialog.content.height(),g=this.dialog.content.width();d.trigger("resize",[{width:g,height:a}])}}},_applyResize:function(){var a=this;b.fn.ligerResizable&&(a.resizable=a.dialog.ligerResizable({onStopResize:function(d,b){var e=0,f=0;isNaN(parseInt(a.dialog.css("top")))||(e=parseInt(a.dialog.css("top")));isNaN(parseInt(a.dialog.css("left")))||(f=parseInt(a.dialog.css("left")));d.diffLeft&&a.set({left:f+d.diffLeft});d.diffTop&&a.set({top:e+d.diffTop});d.newWidth&&(a.set({width:d.newWidth}),a.dialog.body.css({width:d.newWidth-a._borderX}));d.newHeight&&a.set({height:d.newHeight});a._onReisze();a._saveStatus();a.trigger("stopResize");return!1},animate:!1}))},_setImage:function(){var a=this.options;a.type&&("success"==a.type||"donne"==a.type||"ok"==a.type?(b(".l-dialog-image",this.dialog).addClass("l-dialog-image-donne").show(),this.dialog.content.css({paddingLeft:64,paddingBottom:30})):"error"==a.type?(b(".l-dialog-image",this.dialog).addClass("l-dialog-image-error").show(),this.dialog.content.css({paddingLeft:64,paddingBottom:30})):"warn"==a.type?(b(".l-dialog-image",this.dialog).addClass("l-dialog-image-warn").show(),this.dialog.content.css({paddingLeft:64,paddingBottom:30})):"question"==a.type&&(b(".l-dialog-image",this.dialog).addClass("l-dialog-image-question").show(),this.dialog.content.css({paddingLeft:64,paddingBottom:40})))}});a.controls.Dialog.prototype.hide=a.controls.Dialog.prototype.hidden;b.ligerDialog.open=function(a){return b.ligerDialog(a)};b.ligerDialog.close=function(){var b=a.find(a.controls.Dialog.prototype.__getType()),d;for(d in b){var g=b[d];g.destroy.ligerDefer(g,5)}a.win.unmask()};b.ligerDialog.show=function(c){var d=a.find(a.controls.Dialog.prototype.__getType());if(d.length)for(var g in d){d[g].show();return}return b.ligerDialog(c)};b.ligerDialog.hide=function(){var b=a.find(a.controls.Dialog.prototype.__getType()),d;for(d in b)b[d].hide()};b.ligerDialog.tip=function(a){a=b.extend({showType:"slide",width:240,modal:!1,height:100},a||{});b.extend(a,{fixedType:"se",type:"none",isDrag:!1,isResize:!1,showMax:!1,showToggle:!1,showMin:!1});return b.ligerDialog.open(a)};b.ligerDialog.alert=function(a,d,g,e){"function"==typeof d?(e=d,g=null):"function"==typeof g&&(e=g);p={content:a||"",buttons:[{text:b.ligerDefaults.DialogString.ok,onclick:function(d,a,b){a.close();e&&e(d,a,b)}}]};"string"==typeof d&&""!=d&&(p.title=d);"string"==typeof g&&""!=g&&(p.type=g);b.extend(p,{showMax:!1,showToggle:!1,showMin:!1});return b.ligerDialog(p)};b.ligerDialog.confirm=function(a,d,g){"function"==typeof d&&(g=d,type=null);var e=function(d,a){a.close();g&&g("ok"==d.type)};p={type:"question",content:a,buttons:[{text:b.ligerDefaults.DialogString.yes,onclick:e,type:"ok"},{text:b.ligerDefaults.DialogString.no,onclick:e,type:"no"}]};"string"==typeof d&&""!=d&&(p.title=d);b.extend(p,{showMax:!1,showToggle:!1,showMin:!1});return b.ligerDialog(p)};b.ligerDialog.warning=function(a,d,g){"function"==typeof d&&(g=d,type=null);var e=function(d,a){a.close();g&&g(d.type)};p={type:"question",content:a,buttons:[{text:b.ligerDefaults.DialogString.yes,onclick:e,type:"yes"},{text:b.ligerDefaults.DialogString.no,onclick:e,type:"no"},{text:b.ligerDefaults.DialogString.cancel,onclick:e,type:"cancel"}]};"string"==typeof d&&""!=d&&(p.title=d);b.extend(p,{showMax:!1,showToggle:!1,showMin:!1});return b.ligerDialog(p)};b.ligerDialog.waitting=function(a){a=a||b.ligerDefaults.Dialog.waittingMessage;return b.ligerDialog.open({cls:"l-dialog-waittingdialog",type:"none",content:'\x3cdiv style\x3d"padding:4px"\x3e'+a+"\x3c/div\x3e",allowClose:!1})};b.ligerDialog.closeWaitting=function(){var b=a.find(a.controls.Dialog),d;for(d in b){var g=b[d];g.dialog.hasClass("l-dialog-waittingdialog")&&g.close()}};b.ligerDialog.success=function(a,d,g){return b.ligerDialog.alert(a,d,"success",g)};b.ligerDialog.error=function(a,d,g){return b.ligerDialog.alert(a,d,"error",g)};b.ligerDialog.warn=function(a,d,g){return b.ligerDialog.alert(a,d,"warn",g)};b.ligerDialog.question=function(a,d){return b.ligerDialog.alert(a,d,"question")};b.ligerDialog.prompt=function(a,d,g,e){var f=b('\x3cinput type\x3d"text" class\x3d"l-dialog-inputtext"/\x3e');"function"==typeof g&&(e=g);"function"==typeof d?e=d:"boolean"==typeof d&&(g=d);"boolean"==typeof g&&g&&(f=b('\x3ctextarea class\x3d"l-dialog-textarea"\x3e\x3c/textarea\x3e'));"string"!=typeof d&&"int"!=typeof d||f.val(d);d=function(a,d,b){d.close();e&&e("yes"==a.type,f.val())};p={title:a,target:f,width:320,buttons:[{text:b.ligerDefaults.DialogString.ok,onclick:d,type:"yes"},{text:b.ligerDefaults.DialogString.cancel,onclick:d,type:"cancel"}]};return b.ligerDialog(p)}})(jQuery);(function(b){var a=b.ligerui;b.fn.ligerDrag=function(b){return a.run.call(this,"ligerDrag",arguments,{idAttrName:"ligeruidragid",hasElement:!1,propertyToElemnt:"target"})};b.fn.ligerGetDragManager=function(){return a.run.call(this,"ligerGetDragManager",arguments,{idAttrName:"ligeruidragid",hasElement:!1,propertyToElemnt:"target"})};b.ligerDefaults.Drag={onStartDrag:!1,onDrag:!1,onStopDrag:!1,handler:null,proxy:!0,revert:!1,animate:!0,onRevert:null,onEndRevert:null,receive:null,onDragEnter:null,onDragOver:null,onDragLeave:null,onDrop:null,disabled:!1,proxyX:null,proxyY:null};a.controls.Drag=function(b){a.controls.Drag.base.constructor.call(this,null,b)};a.controls.Drag.ligerExtend(a.core.UIComponent,{__getType:function(){return"Drag"},__idPrev:function(){return"Drag"},_render:function(){var a=this,d=this.options;this.set(d);a.cursor="move";a.handler.css("cursor",a.cursor);a.handler.bind("mousedown.drag",function(b){d.disabled||2!=b.button&&a._start.call(a,b)}).bind("mousemove.drag",function(){d.disabled||a.handler.css("cursor",a.cursor)})},_rendered:function(){this.options.target.ligeruidragid=this.id},_start:function(c){var d=this,g=this.options;if(!d.reverting&&!g.disabled){d.current={target:d.target,left:d.target.offset().left,top:d.target.offset().top,startX:c.pageX||c.screenX,startY:c.pageY||c.clientY};if(!1==d.trigger("startDrag",[d.current,c]))return!1;d.cursor="move";d._createProxy(g.proxy,c);if(g.proxy&&!d.proxy)return!1;(d.proxy||d.handler).css("cursor",d.cursor);b(document).bind("selectstart.drag",function(){return!1});b(document).bind("mousemove.drag",function(){d._drag.apply(d,arguments)});a.draggable.dragging=!0;b(document).bind("mouseup.drag",function(){a.draggable.dragging=!1;d._stop.apply(d,arguments)})}},_drag:function(a){var d=this;if(d.current){var g=a.pageX||a.screenX,e=a.pageY||a.screenY;d.current.diffX=g-d.current.startX;d.current.diffY=e-d.current.startY;(d.proxy||d.handler).css("cursor",d.cursor);d.receive&&d.receive.each(function(f,h){var k=b(h),m=k.offset();g>m.left&&g<m.left+k.width()&&e>m.top&&e<m.top+k.height()?d.receiveEntered[f]?d.trigger("dragOver",[h,d.proxy||d.target,a]):(d.receiveEntered[f]=!0,d.trigger("dragEnter",[h,d.proxy||d.target,a])):d.receiveEntered[f]&&(d.receiveEntered[f]=!1,d.trigger("dragLeave",[h,d.proxy||d.target,a]))});d.hasBind("drag")?!1!=d.trigger("drag",[d.current,a])?d._applyDrag():d.proxy?d._removeProxy():d._stop():d._applyDrag()}},_stop:function(a){var d=this,g=this.options;b(document).unbind("mousemove.drag");b(document).unbind("mouseup.drag");b(document).unbind("selectstart.drag");d.receive&&d.receive.each(function(b,g){d.receiveEntered[b]&&d.trigger("drop",[g,d.proxy||d.target,a])});d.proxy&&(g.revert?d.hasBind("revert")?!1!=d.trigger("revert",[d.current,a])?d._revert(a):d._removeProxy():d._revert(a):(d._applyDrag(d.target),d._removeProxy()));d.cursor="move";d.trigger("stopDrag",[d.current,a]);d.current=null;d.handler.css("cursor",d.cursor)},_revert:function(a){var d=this;d.reverting=!0;d.proxy.animate({left:d.current.left,top:d.current.top},function(){d.reverting=!1;d._removeProxy();d.trigger("endRevert",[d.current,a]);d.current=null})},_applyDrag:function(a){var d=this,b=this.options;a=a||d.proxy||d.target;var e={},f=a==d.target;d.current.diffX&&(e.left=f||null==b.proxyX?d.current.left+d.current.diffX:d.current.startX+b.proxyX+d.current.diffX);d.current.diffY&&(e.top=f||null==b.proxyY?d.current.top+d.current.diffY:d.current.startY+b.proxyY+d.current.diffY);a==d.target&&d.proxy&&b.animate?(d.reverting=!0,a.animate(e,function(){d.reverting=!1})):a.css(e)},_setReceive:function(a){this.receiveEntered={};a&&(this.receive="string"==typeof a?b(a):a)},_setHandler:function(a){var d=this.options;this.handler=a?"string"==typeof a?b(a,d.target):a:b(d.target)},_setTarget:function(a){this.target=b(a)},_setCursor:function(a){this.cursor=a;(this.proxy||this.handler).css("cursor",a)},_createProxy:function(a,d){if(a){var g=this.options;"function"==typeof a?this.proxy=a.call(this.options.target,this,d):"clone"==a?(this.proxy=this.target.clone().css("position","absolute"),this.proxy.appendTo("body")):(this.proxy=b("\x3cdiv class\x3d'l-draggable'\x3e\x3c/div\x3e"),this.proxy.width(this.target.width()).height(this.target.height()),this.proxy.attr("dragid",this.id).appendTo("body"));this.proxy.css({left:null==g.proxyX?this.current.left:this.current.startX+g.proxyX,top:null==g.proxyY?this.current.top:this.current.startY+g.proxyY}).show()}},_removeProxy:function(){this.proxy&&(this.proxy.remove(),this.proxy=null)}})})(jQuery);(function(b){b.fn.ligerEasyTab=function(){return b.ligerui.run.call(this,"ligerEasyTab",arguments)};b.fn.ligerGetEasyTabManager=function(){return b.ligerui.run.call(this,"ligerGetEasyTabManager",arguments)};b.ligerDefaults.EasyTab={};b.ligerMethos.EasyTab={};b.ligerui.controls.EasyTab=function(a,c){b.ligerui.controls.EasyTab.base.constructor.call(this,a,c)};b.ligerui.controls.EasyTab.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"EasyTab"},__idPrev:function(){return"EasyTab"},_extendMethods:function(){return b.ligerMethos.EasyTab},_render:function(){var a=this,c=this.options;a.tabs=b(this.element);a.tabs.addClass("l-easytab");var d=0;0<b("\x3e div[lselected\x3dtrue]",a.tabs).length&&(d=b("\x3e div",a.tabs).index(b("\x3e div[lselected\x3dtrue]",a.tabs)));a.tabs.ul=b('\x3cul class\x3d"l-easytab-header"\x3e\x3c/ul\x3e');b("\x3e div",a.tabs).each(function(c,e){var f=b("\x3cli\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e");c==d&&b("span",f).addClass("l-selected");b(e).attr("title")&&b("span",f).html(b(e).attr("title"));a.tabs.ul.append(f);b(e).hasClass("l-easytab-panelbox")||b(e).addClass("l-easytab-panelbox")});a.tabs.ul.prependTo(a.tabs);b(".l-easytab-panelbox:eq("+d+")",a.tabs).show().siblings(".l-easytab-panelbox").hide();b("\x3e ul:first span",a.tabs).click(function(){if(!b(this).hasClass("l-selected")){var d=b("\x3e ul:first span",a.tabs).index(this);b(this).addClass("l-selected").parent().siblings().find("span.l-selected").removeClass("l-selected");b(".l-easytab-panelbox:eq("+d+")",a.tabs).show().siblings(".l-easytab-panelbox").hide()}}).not("l-selected").hover(function(){b(this).addClass("l-over")},function(){b(this).removeClass("l-over")});a.set(c)}})})(jQuery);(function(b){b.fn.ligerFilter=function(){return b.ligerui.run.call(this,"ligerFilter",arguments)};b.fn.ligerGetFilterManager=function(){return b.ligerui.run.call(this,"ligerGetFilterManager",arguments)};b.ligerDefaults.Filter={fields:[],operators:{},editors:{}};b.ligerDefaults.FilterString={strings:{and:"\u5e76\u4e14",or:"\u6216\u8005",equal:"\u76f8\u7b49",notequal:"\u4e0d\u76f8\u7b49",startwith:"\u4ee5..\u5f00\u59cb",endwith:"\u4ee5..\u7ed3\u675f",like:"\u76f8\u4f3c",greater:"\u5927\u4e8e",greaterorequal:"\u5927\u4e8e\u6216\u7b49\u4e8e",less:"\u5c0f\u4e8e",lessorequal:"\u5c0f\u4e8e\u6216\u7b49\u4e8e","in":"\u5305\u62ec\u5728...",notin:"\u4e0d\u5305\u62ec...",addgroup:"\u589e\u52a0\u5206\u7ec4",addrule:"\u589e\u52a0\u6761\u4ef6",deletegroup:"\u5220\u9664\u5206\u7ec4"}};b.ligerDefaults.Filter.operators.string=b.ligerDefaults.Filter.operators.text="equal notequal startwith endwith like greater greaterorequal less lessorequal in notin".split(" ");b.ligerDefaults.Filter.operators.number=b.ligerDefaults.Filter.operators["int"]=b.ligerDefaults.Filter.operators["float"]=b.ligerDefaults.Filter.operators.date="equal notequal greater greaterorequal less lessorequal in notin".split(" ");b.ligerDefaults.Filter.editors.string={create:function(a,c){var d=b("\x3cinput type\x3d'text'/\x3e");a.append(d);d.ligerTextBox(c.editor.options||{});return d},setValue:function(a,b){a.val(b)},getValue:function(a){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}};b.ligerDefaults.Filter.editors.date={create:function(a,c){var d=b("\x3cinput type\x3d'text'/\x3e");a.append(d);d.ligerDateEditor(c.editor.options||{});return d},setValue:function(a,b){a.liger("option","value",b)},getValue:function(a,b){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}};b.ligerDefaults.Filter.editors.number={create:function(a,c){var d=b("\x3cinput type\x3d'text'/\x3e");a.append(d);d.ligerSpinner(b.extend({minValue:c.editor.minValue,maxValue:c.editor.maxValue},c.editor.options||{}));return d},setValue:function(a,b){a.val(b)},getValue:function(a,b){return"int"==b.editor.type?parseInt(a.val(),10):parseFloat(a.val())},destroy:function(a){a.liger("destroy")}};b.ligerDefaults.Filter.editors.combobox={create:function(a,c){var d=b("\x3cinput type\x3d'text'/\x3e");a.append(d);var g={data:c.data,slide:!1,valueField:c.editor.valueField||c.editor.valueColumnName,textField:c.editor.textField||c.editor.displayColumnName};b.extend(g,c.editor.options||{});d.ligerComboBox(g);return d},setValue:function(a,b){a.liger("option","value",b)},getValue:function(a){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}};b.ligerui.controls.Filter=function(a,c){b.ligerui.controls.Filter.base.constructor.call(this,a,c)};b.ligerui.controls.Filter.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Filter"},__idPrev:function(){return"Filter"},_init:function(){b.ligerui.controls.Filter.base._init.call(this)},_render:function(){var a=this;a.set(this.options);b("#"+a.id+" .addgroup").live("click",function(){var c=b(this).parent().parent().parent().parent();a.addGroup(c)});b("#"+a.id+" .deletegroup").live("click",function(){var c=b(this).parent().parent().parent().parent();a.deleteGroup(c)});b("#"+a.id+" .addrule").live("click",function(){var c=b(this).parent().parent().parent().parent();a.addRule(c)});b("#"+a.id+" .deleterole").live("click",function(){var c=b(this).parent().parent();a.deleteRule(c)})},_setFields:function(a){this.group&&this.group.remove();this.group=b(this._bulidGroupTableHtml()).appendTo(this.element)},editors:{},editorCounter:0,addGroup:function(a){a=b(a||this.group);var c=b("\x3etbody:first \x3e tr:last",a),d=[];d.push('\x3ctr class\x3d"l-filter-rowgroup"\x3e\x3ctd class\x3d"l-filter-cellgroup" colSpan\x3d"4"\x3e');a=!a.hasClass("l-filter-group-alt");d.push(this._bulidGroupTableHtml(a,!0));d.push("\x3c/td\x3e\x3c/tr\x3e");d=b(d.join(""));c.before(d);return d.find("table:first")},deleteGroup:function(a){var c=this;b("td.l-filter-value",a).each(function(){var a=b(this).parent();b("select.fieldsel",a).unbind();c.removeEditor(a)});b(a).parent().parent().remove()},removeEditor:function(a){var c=this.options,d=b(a).attr("editortype"),g=b(a).attr("editorid");(g=this.editors[g])&&c.editors[d].destroy(g);b("td.l-filter-value:first",a).html("")},setData:function(a,c){var d=this,g=this.options;c=c||d.group;var e=b("\x3etbody:first \x3e tr:last",c);c.find("\x3etbody:first \x3e tr").not(e).remove();b("select:first",e).val(a.op);a.rules&&b(a.rules).each(function(){var a=d.addRule(c);a.attr("fieldtype",this.type||"string");b("select.opsel",a).val(this.op);b("select.fieldsel",a).val(this.field).trigger("change");var e=a.attr("editorid");e&&d.editors[e]?(a=d.getField(this.field))&&a.editor&&g.editors[a.editor.type].setValue(d.editors[e],this.value,a):b(":text",a).val(this.value)});a.groups&&b(a.groups).each(function(){var a=d.addGroup(c);d.setData(this,a)})},addRule:function(a){var c=this,d=this.options;a=a||c.group;a=b("\x3etbody:first \x3e tr:last",a);var g=b(c._bulidRuleRowHtml());a.before(g);d.fields.length&&c.appendEditor(g,d.fields[0]);b("select.fieldsel",g).bind("change",function(){var a=b(this).parent().next().find("select:first"),d=b(this).val();if(d){var d=c.getField(d),h=d.type||"string",k=g.attr("fieldtype");h!=k&&(a.html(c._bulidOpSelectOptionsHtml(h)),g.attr("fieldtype",h));a=null;h=g.attr("editortype");c.enabledEditor(d)&&(a=d.editor.type);h&&c.removeEditor(g);a?c.appendEditor(g,d):(g.removeAttr("editortype").removeAttr("editorid"),b("td.l-filter-value:first",g).html('\x3cinput type\x3d"text" class\x3d"valtxt" /\x3e'))}});return g},deleteRule:function(a){b("select.fieldsel",a).unbind();this.removeEditor(a);b(a).remove()},appendEditor:function(a,c){var d=this.options;if(this.enabledEditor(c)){var g=b("td.l-filter-value:first",a).html(""),d=d.editors[c.editor.type];this.editors[++this.editorCounter]=d.create(g,c);a.attr("editortype",c.editor.type).attr("editorid",this.editorCounter)}},getData:function(a){var c=this;a=a||c.group;var d={};b("\x3e tbody \x3e tr",a).each(function(a,e){var f=b(e).hasClass("l-filter-rowlast");if(b(e).hasClass("l-filter-rowgroup"))f=b("\x3e td:first \x3e table:first",e),f.length&&(d.groups||(d.groups=[]),d.groups.push(c.getData(f)));else if(f)d.op=b(".groupopsel:first",e).val();else{var f=b("select.fieldsel:first",e).val(),h=c.getField(f),k=b(".opsel:first",e).val(),h=c._getRuleValue(e,h),m=b(e).attr("fieldtype")||"string";d.rules||(d.rules=[]);d.rules.push({field:f,op:k,value:h,type:m})}});return d},_getRuleValue:function(a,c){var d=this.options,g=b(a).attr("editorid"),e=b(a).attr("editortype");return(g=this.editors[g])?d.editors[e].getValue(g,c):b(".valtxt:first",a).val()},enabledEditor:function(a){return a.editor&&a.editor.type?a.editor.type in this.options.editors:!1},getField:function(a){for(var b=this.options,d=0,g=b.fields.length;d<g;d++){var e=b.fields[d];if(e.name==a)return e}return null},_bulidGroupTableHtml:function(a,b){var d=this.options,g=[];g.push('\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" border\x3d"0" class\x3d"l-filter-group');a&&g.push(" l-filter-group-alt");g.push('"\x3e\x3ctbody\x3e');g.push('\x3ctr class\x3d"l-filter-rowlast"\x3e\x3ctd class\x3d"l-filter-rowlastcell" align\x3d"right" colSpan\x3d"4"\x3e');g.push('\x3cselect class\x3d"groupopsel"\x3e');g.push('\x3coption value\x3d"and"\x3e'+d.strings.and+"\x3c/option\x3e");g.push('\x3coption value\x3d"or"\x3e'+d.strings.or+"\x3c/option\x3e");g.push("\x3c/select\x3e");g.push('\x3cinput type\x3d"button" value\x3d"'+d.strings.addgroup+'" class\x3d"addgroup"\x3e');g.push('\x3cinput type\x3d"button" value\x3d"'+d.strings.addrule+'" class\x3d"addrule"\x3e');b&&g.push('\x3cinput type\x3d"button" value\x3d"'+d.strings.deletegroup+'" class\x3d"deletegroup"\x3e');g.push("\x3c/td\x3e\x3c/tr\x3e");g.push("\x3c/tbody\x3e\x3c/table\x3e");return g.join("")},_bulidRuleRowHtml:function(a){var b=this.options;a=a||b.fields;var b=[],d=a[0].type||"string";b.push('\x3ctr fieldtype\x3d"'+d+'"\x3e\x3ctd class\x3d"l-filter-column"\x3e');b.push('\x3cselect class\x3d"fieldsel"\x3e');for(var g=0,e=a.length;g<e;g++){var f=a[g];b.push('\x3coption value\x3d"'+f.name+'"');0==g&&b.push(" selected ");b.push("\x3e");b.push(f.display);b.push("\x3c/option\x3e")}b.push("\x3c/select\x3e");b.push("\x3c/td\x3e");b.push('\x3ctd class\x3d"l-filter-op"\x3e');b.push('\x3cselect class\x3d"opsel"\x3e');b.push(this._bulidOpSelectOptionsHtml(d));b.push("\x3c/select\x3e");b.push("\x3c/td\x3e");b.push('\x3ctd class\x3d"l-filter-value"\x3e');b.push('\x3cinput type\x3d"text" class\x3d"valtxt" /\x3e');b.push("\x3c/td\x3e");b.push("\x3ctd\x3e");b.push('\x3cdiv class\x3d"l-icon-cross deleterole"\x3e\x3c/div\x3e');b.push("\x3c/td\x3e");b.push("\x3c/tr\x3e");return b.join("")},_bulidOpSelectOptionsHtml:function(a){var b=this.options;a=b.operators[a];for(var d=[],g=0,e=a.length;g<e;g++){var f=a[g];d[d.length]='\x3coption value\x3d"'+f+'"\x3e';d[d.length]=b.strings[f];d[d.length]="\x3c/option\x3e"}return d.join("")}})})(jQuery);(function(b){function a(a){var d=[];b(a).each(function(a,c){var f=b(c.element).parents("li:first").prev("li:first").html();d.push("\x3cdiv\x3e"+f+" "+c.message+"\x3c/div\x3e")});return d.join("")}b.fn.ligerForm=function(){return b.ligerui.run.call(this,"ligerForm",arguments)};b.ligerui.getConditions=function(a,d){if(!a)return null;if((a=liger.get(b(a)))&&a.toConditions)return a.toConditions()};b.ligerDefaults=b.ligerDefaults||{};b.ligerDefaults.Form={width:null,inputWidth:180,labelWidth:90,space:40,rightToken:"\uff1a",labelAlign:"left",align:"left",fields:[],appendID:!0,prefixID:null,toJSON:b.ligerui.toJSON,labelCss:null,fieldCss:null,spaceCss:null,onAfterSetFields:null,buttons:null,readonly:!1,editors:{},validate:null,unSetValidateAttr:!1};b.ligerDefaults.FormString={invalidMessage:"\u5b58\u5728{errorCount}\u4e2a\u5b57\u6bb5\u9a8c\u8bc1\u4e0d\u901a\u8fc7\uff0c\u8bf7\u68c0\u67e5!",detailMessage:"\u8be6\u7ec6",okMessage:"\u786e\u5b9a"};b.ligerDefaults.Form.editors.textarea={create:function(a,d,g){var e=b('\x3ctextarea class\x3d"l-textarea" /\x3e');d=(g.prefixID||"")+d.field.name;b("#"+d).length&&(e=b("#"+d));e.attr({id:d,name:d});g.readonly&&e.attr("readonly",!0);a.append(e);return e},getValue:function(a,d){return a.val()},setValue:function(a,d,b){a.val(d)},resize:function(a,d,b,e){a.css({width:d-2}).parent().css("width","auto")}};b.ligerDefaults.Form.editors.hidden={create:function(a,d,g){var e=b('\x3cinput type \x3d "hidden"  /\x3e');d=(g.prefixID||"")+d.field.name;b("#"+d).length&&(e=b("#"+d));e.attr({id:d,name:d});a.append(e);return e},getValue:function(a,d){return a.val()},setValue:function(a,d,b){a.val(d)}};b.ligerDefaults.Form_fields={name:null,textField:null,type:null,editor:null,label:null,newline:!0,op:null,vt:null,attr:null,validate:null};b.ligerDefaults.Form_editor={};b.ligerDefaults.Form.editorBulider=function(a){var d=this.options,g={},e=a.attr("ltype"),f={};d.readonly&&(g.readonly=!0);g=b.extend({width:(f.width||d.inputWidth)-2},f.options,f.editor,g);"autocomplete"==e&&(g.autocomplete=!0);if(a.is("select"))a.ligerComboBox(g);else if(a.is(":password"))a.ligerTextBox(g);else if(a.is(":text"))switch(e){case "select":case "combobox":case "autocomplete":a.ligerComboBox(g);break;case "spinner":a.ligerSpinner(g);break;case "date":a.ligerDateEditor(g);break;case "popup":a.ligerPopupEdit(g);break;case "currency":g.currency=!0;case "float":case "number":g.number=!0;a.ligerTextBox(g);break;case "int":case "digits":g.digits=!0;default:a.ligerTextBox(g)}else a.is(":radio")?a.ligerRadio(g):a.is(":checkbox")?a.ligerCheckBox(g):a.is("textarea")&&a.addClass("l-textarea")};b.ligerui.controls.Form=function(a,d){b.ligerui.controls.Form.base.constructor.call(this,a,d)};b.ligerui.controls.Form.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Form"},__idPrev:function(){return"Form"},_init:function(){var a=this.options;b.ligerui.controls.Form.base._init.call(this);for(var d in liger.editors){var g=liger.editors[d];!g||d in a.editors||(a.editors[d]=liger.getEditor(b.extend({type:d,master:this},g)))}},_render:function(){var a=this,d=this.options,g=b(this.element);a.form=g.is("form")?g:g.parents("form:first");b("input,select,textarea",g).each(function(){d.editorBulider.call(a,b(this))});a.set(d);if(d.buttons){var e=b('\x3cul class\x3d"l-form-buttons"\x3e\x3c/ul\x3e').appendTo(g);b(d.buttons).each(function(){var a=b("\x3cli\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/li\x3e").appendTo(e);b("div:first",a).ligerButton(this)})}a.element.id||(a.element.id=a.id);b("#"+a.element.id+" .togglebtn").live("click",function(){b(this).hasClass("togglebtn-down")?b(this).removeClass("togglebtn-down"):b(this).addClass("togglebtn-down");for(var a=b(this).parent().nextAll("ul,div"),d=0;d<a.length;d++){var c=b(a[d]);if(c.hasClass("l-group"))break;b(this).hasClass("togglebtn-down")?c.hide():c.show()}})},_setWidth:function(a){a&&this.form.width(a)},getEditor:function(a){var d=this.options;if(this.editors)for(var b=0,e=d.fields.length;b<e;b++)if(d.fields[b].name==a&&this.editors[b])return this.editors[b].control},getField:function(a){var d=this.options;return d.fields?d.fields[a]:null},toConditions:function(){var a=this,d=[];b(this.options.fields).each(function(b,e){var f=e.name,h=a.editors[b];h&&f&&(h=h.editor.getValue(h.control),null!=h&&""!==h&&d.push({op:e.operator||"like",field:f,value:h,type:e.type||"string"}))});return d},_preSetFields:function(a){var d=this.options,g=null,e=null;b(d.fields).each(function(a,b){(d.readonly||b.readonly||b.editor&&b.editor.readonly)&&delete b.validate;"hidden"!=b.type&&(b.type=b.type||"text",null==b.newline&&(b.newline=!0),g&&!b.group&&(b.group=g,b.groupicon=e),b.group&&(b.group=b.group.toString().replace(/^\s\s*/,"").replace(/\s\s*$/,""),g=b.group,e=b.groupicon))})},_setReadonly:function(a){if(a&&this.editors)for(var d in this.editors)(a=this.editors[d].control)&&a._setReadonly&&a._setReadonly(!0)},_setFields:function(a){var d=this,g=this.options;b.isFunction(g.prefixID)&&(g.prefixID=g.prefixID(d));d.validate={};var e=b(this.element);b(".l-form-container",e).remove();var f=0,h=0;if(a&&a.length){d._preSetFields(a);e.hasClass("l-form")||e.addClass("l-form");var k=['\x3cdiv class\x3d"l-form-container"\x3e'],m=!1,n=null,q=[];b(a).each(function(a,c){var e=c.readonly||c.editor&&c.editor.readonly?!0:!1,f=(g.prefixID||"")+(c.textField||c.id||c.name);c.validate&&!e&&(d.validate.rules=d.validate.rules||{},d.validate.rules[f]=c.validate,c.validateMessage&&(d.validate.messages=d.validate.messages||{},d.validate.messages[f]=c.validateMessage));-1==b.inArray(c.group,q)&&q.push(c.group)});b(q).each(function(e,q){b(a).each(function(e,r){if(r.group==q){var w=b.inArray(r,a),x=r.newline,v=(g.prefixID||"")+(r.id||r.name);if(r.id||r.name)if("hidden"==r.type)b("#"+v).length||k.push('\x3cdiv style\x3d"display:none" id\x3d"'+(d.id+"|"+e)+'"\x3e\x3c/div\x3e');else{v=r.group&&r.group!=n;if(0==w||v)x=!0;x&&(f=0,m&&(k.push("\x3c/ul\x3e"),m=!1),v&&(k.push('\x3cdiv class\x3d"l-group'),r.groupicon&&k.push(" l-group-hasicon"),k.push('"\x3e'),r.groupicon&&k.push('\x3cimg src\x3d"'+r.groupicon+'" /\x3e'),k.push("\x3cspan\x3e"+r.group+"\x3c/span\x3e\x3c/div\x3e"),n=r.group),k.push("\x3cul\x3e"),m=!0);k.push('\x3cli class\x3d"l-fieldcontainer');x&&k.push(" l-fieldcontainer-first");k.push('"');k.push(" fieldindex\x3d"+w);k.push("\x3e\x3cul\x3e");k.push(d._buliderLabelContainer(r,w));k.push(d._buliderControlContainer(r,w));k.push(d._buliderSpaceContainer(r,w));k.push("\x3c/ul\x3e\x3c/li\x3e");f+=r.width||g.inputWidth||0;f+=r.space||g.space||0;f+=r.labelWidth||g.labelWidth||0;f>h&&(h=f)}}})});m&&(k.push("\x3c/ul\x3e"),m=!1);k.push("\x3c/div\x3e");e.append(k.join(""));(!g.width||h>g.width)&&e.width(h+10);b(".l-group .togglebtn",e).remove();b(".l-group",e).width(0.95*e.width()).append("\x3cdiv class\x3d'togglebtn'\x3e\x3c/div\x3e")}(function(){d.editors=d.editors||{};b(a).each(function(a,c){var e=document.getElementById(d.id+"|"+a),f=g.editors[c.type];e&&(e=b(e),e=d._createEditor(f,e,{field:c},e.width(),e.height()),d.editors[a]&&d.editors[a].control&&d.editors[a].control.destroy&&d.editors[a].control.destroy(),d.editors[a]={control:e,editor:f})});d.initValidate();d.trigger("afterSetFields")})()},getData:function(){var a=this,d=this.options;a.data={};b(d.fields).each(function(d,b){var f=b.name,h=b.textField,k=a.editors[d];if(k){if(f){var m=k.editor.getValue(k.control);a._setValueByName(a.data,f,m)}h&&(m=k.editor.getText(k.control),a._setValueByName(a.data,h,m))}});return a.data},setData:function(a){var d=this,g=d.get("fields");d.data=a||{};(function(){b(g).each(function(a,b){var c=b.name,g=b.textField,m=d.editors[a];m&&(c&&c in d.data&&(c=d._getValueByName(d.data,c),m.editor.setValue(m.control,c)),g&&g in d.data&&(g=d._getValueByName(d.data,g),m.editor.setText(m.control,g)))})})()},_setValueByName:function(a,d,b){if(!a||!d)return null;if(-1==d.indexOf("."))a[d]=b;else try{(new Function("data,value","data."+d+"\x3dvalue;"))(a,b)}catch(e){}},_getValueByName:function(a,d){if(!a||!d)return null;if(-1==d.indexOf("."))return a[d];try{return(new Function("data","return data."+d+";"))(a)}catch(b){return null}},valid:function(){if(this.form&&this.validator)return this.form.valid()},initValidate:function(){var a=this.options;this.form&&a.validate&&this.form.validate?(a=b.extend({errorPlacement:function(a,c){c.attr("id")||c.attr("id",(new Date).getTime());c.hasClass("l-textarea")?c.addClass("l-textarea-invalid"):c.hasClass("l-text-field")&&c.parent().addClass("l-text-invalid");b(c).removeAttr("title").ligerHideTip();b(c).attr("title",a.html()).ligerTip({distanceX:5,distanceY:-3,auto:!0})},success:function(a){a.attr("for")&&(a=b("#"+a.attr("for")),a.hasClass("l-textarea")?a.removeClass("l-textarea-invalid"):a.hasClass("l-text-field")&&a.parent().removeClass("l-text-invalid"),b(a).removeAttr("title").ligerHideTip())}},!0==a.validate?{}:a.validate,{rules:this.validate.rules,messages:this.validate.messages}),this.validator=this.form.validate(a)):this.validator=null},showInvalid:function(c){c=this.options;if(this.validator){var d=b('\x3cdiv\x3e\x3cdiv class\x3d"invalid"\x3e'+c.invalidMessage.replace("{errorCount}",this.validator.errorList.length)+'\x3ca class\x3d"viewInvalidDetail" href\x3d"javascript:void(0)"\x3e'+c.detailMessage+'\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"invalidDetail" style\x3d"display:none;"\x3e'+a(this.validator.errorList)+"\x3c/div\x3e\x3c/div\x3e");d.find("a.viewInvalidDetail:first").bind("click",function(){b(this).parent().next("div.invalidDetail").toggle()});b.ligerDialog.open({type:"error",width:350,showMax:!1,showToggle:!1,showMin:!1,target:d,buttons:[{text:c.okMessage,onclick:function(a,d){d.close()}}]})}},_createEditor:function(a,d,b,e,f){(d=a.create.call(this,d,b,this.options))&&a.resize&&a.resize.call(this,d,e,f,b);return d},_buliderLabelContainer:function(a){var d=this.options,b=a.label||a.display,e=a.labelWidth||a.labelwidth||d.labelWidth;a=a.labelAlign||d.labelAlign;b&&(b+=d.rightToken);var f=[];f.push("\x3cli");d.labelCss&&f.push(' class\x3d"'+d.labelCss+'"');f.push(' style\x3d"');/px$/i.test(e)||/auto/i.test(e)||/%$/i.test(e)?f.push("width:"+e+";"):e&&f.push("width:"+e+"px;");a&&f.push("text-align:"+a+";");f.push('"\x3e');b&&f.push(b);f.push("\x3c/li\x3e");return f.join("")},_buliderControlContainer:function(a,d){var b=this.options,e=a.width||b.inputWidth,f=a.align||a.textAlign||a.textalign||b.align,h=[];h.push("\x3cli");h.push(' id\x3d"'+(this.id+"|"+d)+'"');b.fieldCss&&h.push(' class\x3d"'+b.fieldCss+'"');h.push(' style\x3d"');e&&h.push("width:"+e+"px;");f&&h.push("text-align:"+f+";");h.push('"\x3e');h.push("\x3c/li\x3e");return h.join("")},_buliderSpaceContainer:function(a){var d=this.options,b=a.space||a.spaceWidth||d.space;if(0===a.space||0===a.spaceWidth)b=0;var e=[];e.push("\x3cli");d.spaceCss&&e.push(' class\x3d"'+d.spaceCss+'"');e.push(' style\x3d"');(/px$/i.test(b)||/auto/i.test(b)||/%$/i.test(b))&&e.push("width:"+b+";");b&&e.push("width:"+b+"px;");e.push('"\x3e');a.validate&&a.validate.required&&e.push("\x3cspan class\x3d'l-star'\x3e*\x3c/span\x3e");e.push("\x3c/li\x3e");return e.join("")},_buliderControl:function(a,d){var g=this.options,e=a.name||a.id,f=(a.type||"text").toLowerCase(),h=a.readonly||a.editor&&a.editor.readonly?!0:!1,k=[];"textarea"==f||"htmleditor"==f?k.push("\x3ctextarea "):-1!=b.inArray(f,["checkbox","radio","password","file"])?k.push('\x3cinput type\x3d"'+f+'" '):-1!=b.inArray(f,"select combobox autocomplete popup radiolist checkboxlist listbox".split(" "))?k.push('\x3cinput type\x3d"hidden" '):k.push('\x3cinput type\x3d"text" ');k.push('name\x3d"'+e+'" ');k.push('fieldindex\x3d"'+d+'" ');a.cssClass&&k.push('class\x3d"'+a.cssClass+'" ');g.appendID&&k.push(' id\x3d"'+e+'" ');k.push(this._getInputAttrHtml(a));a.validate&&!h&&(k.push(" validate\x3d'"+g.toJSON(a.validate)+"' "),this.validate=this.validate||{},this.validate.rules=this.validate.rules||{},this.validate.rules[e]=a.validate,a.validateMessage&&(this.validate.messages=this.validate.messages||{},this.validate.messages[e]=a.validateMessage));k.push(" /\x3e");return k.join("")},_getInputAttrHtml:function(a){var d=[],b=(a.type||"text").toLowerCase();"textarea"==b&&(a.cols&&d.push('cols\x3d"'+a.cols+'" '),a.rows&&d.push('rows\x3d"'+a.rows+'" '));d.push('ltype\x3d"'+b+'" ');a.op&&d.push('op\x3d"'+a.op+'" ');a.vt&&d.push('vt\x3d"'+a.vt+'" ');if(a.attr)for(var e in a.attr)d.push(e+'\x3d"'+a.attr[e]+'" ');return d.join("")}})})(jQuery);(function(b){function a(a,b){for(var c=a.length-1;0<=c;c--)b(a[c])&&a.splice(c,1)}var c=b.ligerui;b.fn.ligerGrid=function(a){return b.ligerui.run.call(this,"ligerGrid",arguments)};b.fn.ligerGetGridManager=function(){return b.ligerui.run.call(this,"ligerGetGridManager",arguments)};b.ligerDefaults.Grid={title:null,width:"auto",height:"auto",columnWidth:null,resizable:!0,url:!1,data:null,usePager:!0,page:1,pageSize:10,pageSizeOptions:[10,20,30,40,50],parms:[],columns:[],minColToggle:1,dataType:"server",dataAction:"server",showTableToggleBtn:!1,switchPageSizeApplyComboBox:!1,allowAdjustColWidth:!0,checkbox:!1,allowHideColumn:!0,enabledEdit:!1,isScroll:!0,dateFormat:"yyyy-MM-dd",inWindow:!0,statusName:"__status",method:"post",async:!0,fixedCellHeight:!0,heightDiff:0,cssClass:null,root:"Rows",record:"Total",pageParmName:"page",pagesizeParmName:"pagesize",sortnameParmName:"sortname",sortorderParmName:"sortorder",allowUnSelectRow:!1,alternatingRow:!0,mouseoverRowCssClass:"l-grid-row-over",enabledSort:!0,rowAttrRender:null,groupColumnName:null,groupColumnDisplay:"\u5206\u7ec4",groupRender:null,totalRender:null,delayLoad:!1,where:null,selectRowButtonOnly:!1,whenRClickToSelect:!1,contentType:null,checkboxColWidth:27,detailColWidth:29,clickToEdit:!0,detailToEdit:!1,onEndEdit:null,minColumnWidth:80,tree:null,isChecked:null,isSelected:null,frozen:!0,frozenDetail:!1,frozenCheckbox:!0,detail:null,detailHeight:260,isShowDetailToggle:null,rownumbers:!1,frozenRownumbers:!0,rownumbersColWidth:26,colDraggable:!1,rowDraggable:!1,rowDraggingRender:null,autoCheckChildren:!0,onRowDragDrop:null,rowHeight:28,headerRowHeight:28,toolbar:null,toolbarShowInLeft:!0,headerImg:null,unSetValidateAttr:!0,onDragCol:null,onToggleCol:null,onChangeSort:null,onSuccess:null,onDblClickRow:null,onSelectRow:null,onUnSelectRow:null,onBeforeCheckRow:null,onCheckRow:null,onBeforeCheckAllRow:null,onCheckAllRow:null,onBeforeShowData:null,onAfterShowData:null,onError:null,onSubmit:null,onReload:null,onToFirst:null,onToPrev:null,onToNext:null,onToLast:null,onAfterAddRow:null,onBeforeEdit:null,onBeforeSubmitEdit:null,onAfterEdit:null,onLoading:null,onLoaded:null,onContextmenu:null,onBeforeCancelEdit:null,onAfterSubmitEdit:null,onRowDragDrop:null,onGroupExtend:null,onGroupCollapse:null,onTreeExpand:null,onTreeCollapse:null,onTreeExpanded:null,onTreeCollapsed:null,onLoadData:null};b.ligerDefaults.GridString={errorMessage:"\u53d1\u751f\u9519\u8bef",pageStatMessage:"\u663e\u793a\u4ece{from}\u5230{to}\uff0c\u603b {total} \u6761 \u3002\u6bcf\u9875\u663e\u793a\uff1a{pagesize}",pageTextMessage:"Page",loadingMessage:"\u52a0\u8f7d\u4e2d...",findTextMessage:"\u67e5\u627e",noRecordMessage:"\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\u5b58\u5728",isContinueByDataChanged:"\u6570\u636e\u5df2\u7ecf\u6539\u53d8,\u5982\u679c\u7ee7\u7eed\u5c06\u4e22\u5931\u6570\u636e,\u662f\u5426\u7ee7\u7eed?",cancelMessage:"\u53d6\u6d88",saveMessage:"\u4fdd\u5b58",applyMessage:"\u5e94\u7528",draggingMessage:"{count}\u884c"};b.ligerDefaults.Grid_columns={id:null,name:null,totalSummary:null,display:null,headerRender:null,isAllowHide:!0,isSort:!1,type:null,columns:null,width:120,minWidth:80,format:null,align:"left",hide:!1,editor:null,render:null,textField:null};b.ligerDefaults.Grid_editor={type:null,ext:null,onChange:null,onChanged:null};b.ligerMethos.Grid=b.ligerMethos.Grid||{};b.ligerDefaults.Grid.sorters=b.ligerDefaults.Grid.sorters||{};b.ligerDefaults.Grid.formatters=b.ligerDefaults.Grid.formatters||{};b.ligerDefaults.Grid.editors=b.ligerDefaults.Grid.editors||{};b.ligerDefaults.Grid.sorters.date=function(a,b){return a<b?-1:a>b?1:0};b.ligerDefaults.Grid.sorters["int"]=function(a,b){return parseInt(a)<parseInt(b)?-1:parseInt(a)>parseInt(b)?1:0};b.ligerDefaults.Grid.sorters["float"]=function(a,b){return parseFloat(a)<parseFloat(b)?-1:parseFloat(a)>parseFloat(b)?1:0};b.ligerDefaults.Grid.sorters.string=function(a,b){return a?a.localeCompare(b):!1};b.ligerDefaults.Grid.formatters.date=function(a,b){function c(a,d){if(isNaN(a))return null;var b=d,g={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var e in g)RegExp("("+e+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?g[e]:("00"+g[e]).substr((""+g[e]).length)));return b}if(!a)return"";"string"==typeof a&&/^\/Date/.test(a)&&(a=a.replace(/^\//,"new ").replace(/\/$/,""),eval("value \x3d "+a));return a instanceof Date?c(a,b.format||this.options.dateFormat||"yyyy-MM-dd"):a.toString()};b.ligerui.controls.Grid=function(a,c){b.ligerui.controls.Grid.base.constructor.call(this,a,c)};b.ligerui.controls.Grid.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Grid"},__idPrev:function(){return"grid"},_extendMethods:function(){return b.ligerMethos.Grid},_init:function(){b.ligerui.controls.Grid.base._init.call(this);var a=this,c=this.options;c.dataType=c.url?"server":"local";"local"==c.dataType&&(c.data=c.data||[],c.dataAction="local");!1==c.isScroll&&(c.height="auto");c.frozen||(c.frozenCheckbox=!1,c.frozenDetail=!1,c.frozenRownumbers=!1);c.detailToEdit&&(c.enabledEdit=!0,c.clickToEdit=!1,c.detail={height:"auto",onShowDetail:function(e,f,m){function n(){b(f).parent().parent().remove();a.collapseDetail(e)}b(f).addClass("l-grid-detailpanel-edit");a.beginEdit(e,function(a,d){var e=b("\x3cdiv class\x3d'l-editbox'\x3e\x3c/div\x3e");e.width(120).height(c.rowHeight+1);e.appendTo(f);return e});b("\x3cdiv class\x3d'l-clear'\x3e\x3c/div\x3e").appendTo(f);b("\x3cdiv class\x3d'l-button'\x3e"+c.saveMessage+"\x3c/div\x3e").appendTo(f).click(function(){a.endEdit(e);n()});b("\x3cdiv class\x3d'l-button'\x3e"+c.applyMessage+"\x3c/div\x3e").appendTo(f).click(function(){a.submitEdit(e)});b("\x3cdiv class\x3d'l-button'\x3e"+c.cancelMessage+"\x3c/div\x3e").appendTo(f).click(function(){a.cancelEdit(e);n()})}});c.tree&&(c.tree.childrenName=c.tree.childrenName||"children",c.tree.isParent=c.tree.isParent||function(a){return c.tree.childrenName in a},c.tree.isExtend=c.tree.isExtend||function(a){return"isextend"in a&&!1==a.isextend?!1:!0});for(var e in liger.editors){var f=liger.editors[e];!f||e in c.editors||(c.editors[e]=liger.getEditor(b.extend({type:e,master:a},f)))}},_render:function(){var a=this,c=this.options;a.grid=b(a.element);a.grid.addClass("l-panel");var e=[];e.push("        \x3cdiv class\x3d'l-panel-header'\x3e\x3cspan class\x3d'l-panel-header-text'\x3e\x3c/span\x3e\x3c/div\x3e");e.push("                    \x3cdiv class\x3d'l-grid-loading'\x3e\x3c/div\x3e");e.push("        \x3cdiv class\x3d'l-panel-topbar' style\x3d'display:none'\x3e\x3cdiv class\x3d'l-panel-topbarinner'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'l-clear'\x3e\x3c/div\x3e");e.push("        \x3cdiv class\x3d'l-panel-bwarp'\x3e");e.push("            \x3cdiv class\x3d'l-panel-body'\x3e");e.push("                \x3cdiv class\x3d'l-grid'\x3e");e.push("                    \x3cdiv class\x3d'l-grid-dragging-line'\x3e\x3c/div\x3e");e.push("                    \x3cdiv class\x3d'l-grid-popup'\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e");e.push("                  \x3cdiv class\x3d'l-grid1'\x3e");e.push("                      \x3cdiv class\x3d'l-grid-header l-grid-header1'\x3e");e.push("                          \x3cdiv class\x3d'l-grid-header-inner'\x3e\x3ctable class\x3d'l-grid-header-table' cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e");e.push("                      \x3c/div\x3e");e.push("                      \x3cdiv class\x3d'l-grid-body l-grid-body1'\x3e");e.push("                      \x3c/div\x3e");e.push("                  \x3c/div\x3e");e.push("                  \x3cdiv class\x3d'l-grid2'\x3e");e.push("                      \x3cdiv class\x3d'l-grid-header l-grid-header2'\x3e");e.push("                          \x3cdiv class\x3d'l-grid-header-inner'\x3e\x3ctable class\x3d'l-grid-header-table' cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e");e.push("                      \x3c/div\x3e");e.push("                      \x3cdiv class\x3d'l-grid-body l-grid-body2 l-scroll'\x3e");e.push("                      \x3c/div\x3e");e.push("                  \x3c/div\x3e");e.push("                 \x3c/div\x3e");e.push("              \x3c/div\x3e");e.push("         \x3c/div\x3e");e.push("         \x3cdiv class\x3d'l-panel-bar'\x3e");e.push("            \x3cdiv class\x3d'l-panel-bbar-inner'\x3e");e.push("                \x3cdiv class\x3d'l-bar-group  l-bar-message'\x3e\x3cspan class\x3d'l-bar-text'\x3e\x3c/span\x3e\x3c/div\x3e");e.push("            \x3cdiv class\x3d'l-bar-group l-bar-selectpagesize'\x3e\x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-separator'\x3e\x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-group'\x3e");e.push("                    \x3cdiv class\x3d'l-bar-button l-bar-btnfirst'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e");e.push("                    \x3cdiv class\x3d'l-bar-button l-bar-btnprev'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e");e.push("                \x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-separator'\x3e\x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-group'\x3e\x3cspan class\x3d'pcontrol'\x3e \x3cinput type\x3d'text' size\x3d'4' value\x3d'1' style\x3d'width:20px' maxlength\x3d'3' /\x3e / \x3cspan\x3e\x3c/span\x3e\x3c/span\x3e\x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-separator'\x3e\x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-group'\x3e");e.push("                     \x3cdiv class\x3d'l-bar-button l-bar-btnnext'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e");e.push("                    \x3cdiv class\x3d'l-bar-button l-bar-btnlast'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e");e.push("                \x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-separator'\x3e\x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-group'\x3e");e.push("                     \x3cdiv class\x3d'l-bar-button l-bar-btnload'\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e");e.push("                \x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-bar-separator'\x3e\x3c/div\x3e");e.push("                \x3cdiv class\x3d'l-clear'\x3e\x3c/div\x3e");e.push("            \x3c/div\x3e");e.push("         \x3c/div\x3e");a.grid.html(e.join(""));a.header=b(".l-panel-header:first",a.grid);a.body=b(".l-panel-body:first",a.grid);a.toolbar=b(".l-panel-bar:first",a.grid);a.popup=b(".l-grid-popup:first",a.grid);a.gridloading=b(".l-grid-loading:first",a.grid);a.draggingline=b(".l-grid-dragging-line",a.grid);a.topbar=b(".l-panel-topbarinner:first",a.grid);a.gridview=b(".l-grid:first",a.grid);a.gridview.attr("id",a.id+"grid");a.gridview1=b(".l-grid1:first",a.gridview);a.gridview2=b(".l-grid2:first",a.gridview);a.gridheader=b(".l-grid-header:first",a.gridview2);a.gridbody=b(".l-grid-body:first",a.gridview2);a.f={};a.f.gridheader=b(".l-grid-header:first",a.gridview1);a.f.gridbody=b(".l-grid-body:first",a.gridview1);a.currentData=null;a.changedCells={};a.editors={};a.editor={editing:!1};a.cacheData={};"auto"==c.height&&a.bind("SysGridHeightChanged",function(){a.enabledFrozen()&&a.gridview.height(Math.max(a.gridview1.height(),a.gridview2.height()))});e=b.extend({},c);this._bulid();this._setColumns(c.columns);delete e.columns;delete e.data;delete e.url;a.set(e);c.delayLoad||(c.url?a.set({url:c.url}):c.data&&a.set({data:c.data}))},_setFrozen:function(a){a?this.grid.addClass("l-frozen"):this.grid.removeClass("l-frozen")},_setCssClass:function(a){this.grid.addClass(a)},_setLoadingMessage:function(a){this.gridloading.html(a)},_setToolbar:function(a){var c=this.options;if(a&&b.fn.ligerToolBar){this.topbar.parent().show();this.toolbarManager=this.topbar.ligerToolBar(a);if(a.title){var e=b("\x3cdiv class\x3d'l-panel-topbartitle'\x3e\x3cspan\x3e"+a.title+"\x3c/span\x3e\x3c/div\x3e");a.icon&&(e.append("\x3cimg class\x3d'l-panel-topbaricon' src\x3d'"+a.icon+"'\x3e\x3c/img\x3e"),e.addClass("l-panel-topbartitle-hasicon"));this.topbar.parent().append(e)}c.toolbarShowInLeft&&this.topbar.addClass("l-panel-topbarinner-left")}else this.topbar.parent().remove()},isHorizontalScrollShowed:function(){var a=this.gridbody.find(".l-grid-body-inner:first");return a.length?this.gridbody.width()-20<a.width():!1},_setHeight:function(a){var b=this,c=this.options;b.unbind("SysGridHeightChanged");"auto"==a?b.bind("SysGridHeightChanged",function(){b.enabledFrozen()&&b.gridview.height(Math.max(b.gridview1.height(),b.gridview2.height()))}):(a=b._calculateGridBodyHeight(a),0<a&&(b.gridbody.height(a),b.f.gridbody.height(a),b.gridview.height(a+(c.headerRowHeight*(b._columnMaxLevel-1)+c.headerRowHeight-1))),b._updateHorizontalScrollStatus.ligerDefer(b,10))},_calculateGridBodyHeight:function(a){var c=this.options;"string"==typeof a&&0<a.indexOf("%")&&(a=c.inWindow?0.01*b(window).height()*parseInt(a):0.01*this.grid.parent().height()*parseInt(a));c.title&&(a-=24);c.usePager&&(a-=32);c.totalRender&&(a-=25);c.toolbar&&(a-=this.topbar.outerHeight());return a-=c.headerRowHeight*(this._columnMaxLevel-1)+c.headerRowHeight-1},_updateHorizontalScrollStatus:function(){this.isHorizontalScrollShowed()?this.gridview.addClass("l-grid-hashorizontal"):this.gridview.removeClass("l-grid-hashorizontal")},_updateFrozenWidth:function(){if(this.enabledFrozen()){this.gridview1.width(this.f.gridtablewidth);var a=this.gridview.width()-this.f.gridtablewidth;this.gridview2.css({left:this.f.gridtablewidth});0<a&&this.gridview2.css({width:a})}},_setWidth:function(a){this.enabledFrozen()&&this._onResize()},_setUrl:function(a){(this.options.url=a)?(this.options.dataType="server",this.loadData(!0)):this.options.dataType="local"},removeParm:function(d){var b=this.get("parms");b||(b={});b instanceof Array?a(b,function(a){return a.name==d}):delete b[d];this.set("parms",b)},setParm:function(d,b){var c=this.get("parms");c||(c={});c instanceof Array?(a(c,function(a){return a.name==d}),c.push({name:d,value:b})):c[d]=b;this.set("parms",c)},_setData:function(a){this.loadData(this.options.data)},loadData:function(a){var c=this.options;this.loading=!0;this.trigger("loadData");var e=null,f=!0;"function"==typeof a?(e=a,this.lastData?this.data=this.lastData:(this.data=this.currentData,this.data||(this.data={}),this.data[c.root]||(this.data[c.root]=[]),this.lastData=this.data),f=!1):"boolean"==typeof a?f=a:"object"==typeof a&&a&&(f=!1,c.dataType="local",c.data=a);c.newPage||(c.newPage=1);"server"!=c.dataAction||c.sortOrder||(c.sortOrder="asc");var h=[];if(c.parms)if(a=b.isFunction(c.parms)?c.parms():c.parms,a.length)b(a).each(function(){h.push({name:this.name,value:this.value})});else if("object"==typeof a)for(var k in a)h.push({name:k,value:a[k]});"server"==c.dataAction&&(c.usePager&&(h.push({name:c.pageParmName,value:c.newPage}),h.push({name:c.pagesizeParmName,value:c.pageSize})),c.sortName&&(h.push({name:c.sortnameParmName,value:c.sortName}),h.push({name:c.sortorderParmName,value:c.sortOrder})));b(".l-bar-btnload span",this.toolbar).addClass("l-disabled");"local"==c.dataType?(this.filteredData=c.data||this.currentData,e&&(this.filteredData[c.root]=this._searchData(this.filteredData[c.root],e)),this.currentData=c.usePager?this._getCurrentPageData(this.filteredData):this.filteredData,this._convertTreeData(),this._showData()):"local"!=c.dataAction||f?this.loadServerData(h,e):this.data&&this.data[c.root]&&(this.filteredData=this.data,e&&(this.filteredData[c.root]=this._searchData(this.filteredData[c.root],e)),this.currentData=this._getCurrentPageData(this.filteredData),this._convertTreeData(),this._showData());this.loading=!1},_convertTreeData:function(){var a=this.options;a.tree&&a.tree.idField&&a.tree.parentIDField&&(this.currentData[a.root]=this.arrayToTree(this.currentData[a.root],a.tree.idField,a.tree.parentIDField),this.currentData[a.record]=this.currentData[a.root].length)},loadServerData:function(a,c){var e=this,f=this.options,h={type:f.method,url:f.url,data:a,async:f.async,dataType:"json",beforeSend:function(){e.hasBind("loading")?e.trigger("loading"):e.toggleLoading(!0)},success:function(a){e.trigger("success",[a,e]);a&&a[f.root]&&a[f.root].length?(e.data=a,null!=e.data[f.record]&&e.cacheData.records&&(e.cacheData.records=e.data[f.record]),"server"==f.dataAction?(e.currentData=e.data,null==e.currentData[f.record]&&e.cacheData.records&&(e.currentData[f.record]=e.cacheData.records)):(e.filteredData=e.data,c&&(e.filteredData[f.root]=e._searchData(e.filteredData[f.root],c)),e.currentData=f.usePager?e._getCurrentPageData(e.filteredData):e.filteredData),e._convertTreeData(),e._showData.ligerDefer(e,10,[e.currentData])):(e.currentData=e.data={},e.currentData[f.root]=e.data[f.root]=[],e.currentData[f.record]=a&&a[f.record]?e.data[f.record]=a[f.record]:e.data[f.record]=0,e._convertTreeData(),e._showData())},complete:function(){e.trigger("complete",[e]);e.hasBind("loaded")?e.trigger("loaded",[e]):e.toggleLoading.ligerDefer(e,10,[!1])},error:function(a,d,c){e.currentData=e.data={};e.currentData[f.root]=e.data[f.root]=[];e.currentData[f.record]=e.data[f.record]=0;e.toggleLoading.ligerDefer(e,10,[!1]);b(".l-bar-btnload span",e.toolbar).removeClass("l-disabled");e.trigger("error",[a,d,c])}};f.contentType&&(h.contentType=f.contentType);b.ajax(h)},toggleLoading:function(a){this.gridloading[a?"show":"hide"]()},_createEditor:function(a,b,c,f,h){b=a.create.call(this,b,c);a.setValue&&a.setValue.call(this,b,c.value,c);a.setText&&c.column.textField&&a.setText.call(this,b,c.text,c);a.resize&&a.resize.call(this,b,f,h,c);return b},beginEdit:function(a,c){var e=this,f=this.options;if(f.enabledEdit&&!f.clickToEdit){var h=e.getRow(a);if(!h._editing&&!1!=e.trigger("beginEdit",{record:h,rowindex:h.__index})){e.editors[h.__id]={};h._editing=!0;e.reRender({rowdata:h});c=c||function(a,d){var c=e.getCellObj(a,d),c=b(c).html("");e.setCellEditing(a,d,!0);return c};for(var k=0,m=e.columns.length;k<m;k++){var n=e.columns[k];if(n.name&&n.editor&&n.editor.type&&f.editors[n.editor.type]){var q=f.editors[n.editor.type],r={record:h,value:e._getValueByName(h,n.name),column:n,rowindex:h.__index,grid:e},s=c(h,n),t=s.width(),u=s.height(),t=e._createEditor(q,s,r,t,u);e.editors[h.__id][n.__id]={editor:q,input:t,editParm:r,container:s}}}e.trigger("afterBeginEdit",{record:h,rowindex:h.__index})}}},cancelEdit:function(a){if(void 0==a)for(var b in this.editors)this.cancelEdit(b);else if(a=this.getRow(a),this.editors[a.__id]&&!1!=this.trigger("beforeCancelEdit",{record:a,rowindex:a.__index})){for(var c in this.editors[a.__id])b=this.editors[a.__id][c],b.editor.destroy&&b.editor.destroy(b.input,b.editParm);delete this.editors[a.__id];delete a._editing;this.reRender({rowdata:a})}},addEditRow:function(a,b){this.submitEdit();a=this.add(a);this.beginEdit(a,b)},submitEdit:function(a){if(void 0==a)for(var b in this.editors)this.submitEdit(b);else if(a=this.getRow(a),b={},this.editors[a.__id]){for(var c in this.editors[a.__id]){var f=this.editors[a.__id][c],h=f.editParm.column;h.name&&(b[h.name]=f.editor.getValue(f.input,f.editParm));h.textField&&f.editor.getText&&(b[h.textField]=f.editor.getText(f.input,f.editParm))}if(!1==this.trigger("beforeSubmitEdit",{record:a,rowindex:a.__index,newdata:b}))return!1;this.updateRow(a,b);this.trigger("afterSubmitEdit",{record:a,rowindex:a.__index,newdata:b})}},endEdit:function(a){if(this.editor.editing)a=this.editor,this.trigger("sysEndEdit",[this.editor.editParm]),this.trigger("endEdit",[this.editor.editParm]),a.editor.destroy&&a.editor.destroy(a.input,a.editParm),this.editor.container.remove(),this.reRender({rowdata:this.editor.editParm.record,column:this.editor.editParm.column}),this.trigger("afterEdit",[this.editor.editParm]),this.editor={editing:!1};else if(void 0!=a){var b=this.getRow(a);if(!this.editors[b.__id])return;if(!1==this.submitEdit(a))return!1;for(var c in this.editors[b.__id])a=this.editors[b.__id][c],a.editor.destroy&&a.editor.destroy(a.input,a.editParm);delete this.editors[b.__id];delete b._editing;this.trigger("afterEdit",{record:b,rowindex:b.__index})}else for(b in this.editors)this.endEdit(b);this._fixHeight.ligerDefer(this,10)},setWidth:function(a){return this._setWidth(a)},setHeight:function(a){return this._setHeight(a)},enabledCheckbox:function(){return this.options.checkbox?!0:!1},enabledFrozen:function(){var a=this.options;if(!a.frozen)return!1;var b=this.columns||[];if(this.enabledDetail()&&a.frozenDetail||this.enabledCheckbox()&&a.frozenCheckbox||a.frozenRownumbers&&a.rownumbers)return!0;for(var a=0,c=b.length;a<c;a++)if(b[a].frozen)return!0;this._setFrozen(!1);return!1},enabledDetailEdit:function(){return this.enabledDetail()?this.options.detailToEdit?!0:!1:!1},enabledDetail:function(){return this.options.detail&&this.options.detail.onShowDetail?!0:!1},enabledGroup:function(){return this.options.groupColumnName?!0:!1},deleteSelectedRow:function(){if(this.selected){for(var a in this.selected){var b=this.selected[a];b.__id in this.records&&this._deleteData.ligerDefer(this,10,[b])}this.reRender.ligerDefer(this,20)}},removeRange:function(a){var c=this;b.each(a,function(){c._removeData(this)});c.reRender()},remove:function(a){this.getRow(a);this._removeData(a);this.reRender()},deleteRange:function(a){var c=this;b.each(a,function(){c._deleteData(this)});c.reRender()},deleteRow:function(a){if(a=this.getRow(a))this._deleteData(a),this.reRender(),this.isDataChanged=!0},_deleteData:function(a){var b=this.options;a=this.getRow(a);a[b.statusName]="delete";if(b.tree){var c=this.getChildren(a,!0);if(c)for(var f=0,h=c.length;f<h;f++)c[f][b.statusName]="delete"}this.deletedRows=this.deletedRows||[];this.deletedRows.push(a);this._removeSelected(a)},updateCell:function(a,c,e){var f=this.options,h,k;if("string"==typeof a)for(f=0,k=this.columns.length;f<k;f++)this.columns[f].name==a&&this.updateCell(f,c,e);else"number"==typeof a?(h=this.columns[a],k=this.getRow(e),this.getCellObj(k,h)):"object"==typeof a&&a.__id?(h=a,k=this.getRow(e),this.getCellObj(k,h)):(e=a.id.split("|"),h=this._columns[e[e.length-1]],a=b(a).parent(),k=k||this.getRow(a[0])),null!=c&&h.name&&(this._setValueByName(k,h.name,c),"add"!=k[f.statusName]&&(k[f.statusName]="update"),this.isDataChanged=!0),this.reRender({rowdata:k,column:h})},addRows:function(a,c,e,f){var h=this;b(a).each(function(){h.addRow(this,c,e,f)})},_createRowid:function(){return"r"+(1E3+this.recordNumber)},_isRowId:function(a){return a in this.records},_addNewRecord:function(a,b,c){var f=this.options;this.recordNumber++;a.__id=this._createRowid();if((a.__previd=b)&&-1!=b){b=this.records[b];if(b.__nextid&&-1!=b.__nextid){var h=this.records[b.__nextid];h&&(h.__previd=a.__id)}b.__nextid=a.__id;a.__index=b.__index+1}else a.__index=0;f.tree&&(c&&-1!=c?(b=this.records[c],a.__pid=c,a.__level=b.__level+1):(a.__pid=-1,a.__level=1),a.__hasChildren=a[f.tree.childrenName]?!0:!1);a[f.statusName]=a[f.statusName]||"nochanged";this.rows[a.__index]=a;return this.records[a.__id]=a},_getRows:function(a){function b(a){if(a&&a.length)for(var d=0,m=a.length;d<m;d++){var n=a[d];f.push(n);n[c.tree.childrenName]&&b(n[c.tree.childrenName])}}var c=this.options,f=[];b(a);return f},_updateGridData:function(){function a(h,k){if(h&&h.length)for(var m=0,n=h.length;m<n;m++){var q=h[m];b.formatRecord(q);"delete"!=q[c.statusName]&&(b._addNewRecord(q,f,k),f=q.__id,q.__hasChildren&&a(q[c.tree.childrenName],q.__id))}}var b=this,c=this.options;b.recordNumber=0;b.rows=[];b.records={};var f=-1;a(b.currentData[c.root],-1);return b.rows},_moveData:function(a,c,e){a=this.getRow(a);var f=this.getRow(c),h;c=this._getParentChildren(a);h=b.inArray(a,c);c.splice(h,1);c=this._getParentChildren(f);f=b.inArray(f,c);c.splice(f+(e?1:0),0,a)},move:function(a,b,c){this._moveData(a,b,c);this.reRender()},moveRange:function(a,b,c){for(var f in a)this._moveData(a[f],b,c);this.reRender()},up:function(a){a=this.getRow(a);var c=this._getParentChildren(a),e=b.inArray(a,c);if(-1!=e&&0!=e){var f=this.getSelected();this.move(a,c[e-1],!1);this.select(f)}},down:function(a){a=this.getRow(a);var c=this._getParentChildren(a),e=b.inArray(a,c);if(-1!=e&&e!=c.length-1){var f=this.getSelected();this.move(a,c[e+1],!0);this.select(f)}},addRow:function(a,b,c,f){var h=this.options;a=a||{};this._addData(a,f,b,c);this.reRender();a[h.statusName]="add";if(h.tree&&(b=this.getChildren(a,!0)))for(c=0,f=b.length;c<f;c++)b[c][h.statusName]="add";this.isDataChanged=!0;h.total=h.total?h.total+1:1;h.pageCount=Math.ceil(h.total/h.pageSize);this._buildPager();this.trigger("SysGridHeightChanged");this.trigger("afterAddRow",[a]);return a},updateRow:function(a,c){var e=this.options,f=this.getRow(a);this.isDataChanged=!0;b.extend(f,c||{});"add"!=f[e.statusName]&&(f[e.statusName]="update");this.reRender.ligerDefer(this,10,[{rowdata:f}]);return f},setCellEditing:function(a,c,e){var f=this.getCellObj(a,c);e=e?"addClass":"removeClass";b(f)[e]("l-grid-row-cell-editing");if(0!=a.__id){f=b(this.getRowObj(a.__id)).prev();if(!f.length)return;f=this.getRow(f[0]);f=this.getCellObj(f,c);if(!f)return;b(f)[e]("l-grid-row-cell-editing-topcell")}-1!=c.__previd&&null!=c.__previd&&(f=b(this.getCellObj(a,c)).prev(),b(f)[e]("l-grid-row-cell-editing-leftcell"))},reRender:function(a){var c=this,e=this.options;a=a||{};var f=a.rowdata;a=a.column;if(!a||!a.isdetail&&!a.ischeckbox)if(!f||"delete"!=f[e.statusName])if(f&&a)e=c.getCellObj(f,a),b(e).html(c._getCellHtml(f,a)),a.issystem||c.setCellEditing(f,a,!1);else if(f)b(c.columns).each(function(){c.reRender({rowdata:f,column:this})});else if(a){for(var h in c.records)c.reRender({rowdata:c.records[h],column:a});for(h=0;h<c.totalNumber;h++){var k=document.getElementById(c.id+"|total"+h+"|"+a.__id);b("div:first",k).html(c._getTotalCellContent(a,c.groups&&c.groups[h]?c.groups[h]:c.currentData[e.root]))}}else c._showData()},getData:function(a,c){var e=this.options,f=[];void 0==c&&(c=!0);for(var h in this.records){var k=b.extend(!0,{},this.records[h]);k[e.statusName]!=a&&void 0!=a||f.push(this.formatRecord(k,c))}return f},formatRecord:function(a,b){delete a.__id;delete a.__previd;delete a.__nextid;delete a.__index;this.options.tree&&(delete a.__pid,delete a.__level,delete a.__hasChildren);b&&delete a[this.options.statusName];return a},getUpdated:function(){return this.getData("update",!0)},getDeleted:function(){return this.deletedRows},getAdded:function(){return this.getData("add",!0)},getChanges:function(){var a=this,c=[];this.deletedRows&&b(this.deletedRows).each(function(){var e=b.extend(!0,{},this);c.push(a.formatRecord(e,!0))});b.merge(c,a.getUpdated());b.merge(c,a.getAdded());return c},getColumn:function(a){return"string"==typeof a?this._isColumnId(a)?this._columns[a]:this.columns[parseInt(a)]:"number"==typeof a?this.columns[a]:"object"==typeof a&&1==a.nodeType?(a=a.id.split("|"),this._columns[a[a.length-1]]):a},getColumnType:function(a){for(i=0;i<this.columns.length;i++)if(this.columns[i].name==a)return this.columns[i].type?this.columns[i].type:"string";return null},isTotalSummary:function(){for(var a=0;a<this.columns.length;a++)if(this.columns[a].totalSummary)return!0;return!1},getColumns:function(a){var b=[],c;for(c in this._columns){var f=this._columns[c];void 0!=a?f.__level==a&&b.push(f):f.__leaf&&b.push(f)}return b},changeSort:function(a,b){var c=this,f=this.options;if(c.loading)return!0;if("local"==f.dataAction){var h=c.getColumnType(a);c.sortedData||(c.sortedData=c.filteredData);if(!c.sortedData||!c.sortedData[f.root])return;f.sortName==a?c.sortedData[f.root].reverse():c.sortedData[f.root].sort(function(b,g){return c._compareData(b,g,a,h)});c.currentData=f.usePager?c._getCurrentPageData(c.sortedData):c.sortedData;c._showData()}f.sortName=a;f.sortOrder=b;"server"==f.dataAction&&c.loadData(f.where)},changePage:function(a){var c=this.options;if(this.loading)return!0;if("local"!=c.dataAction&&this.isDataChanged&&!confirm(c.isContinueByDataChanged))return!1;c.pageCount=parseInt(b(".pcontrol span",this.toolbar).html());switch(a){case "first":if(1==c.page)return;c.newPage=1;break;case "prev":if(1==c.page)return;1<c.page&&(c.newPage=parseInt(c.page)-1);break;case "next":if(c.page>=c.pageCount)return;c.newPage=parseInt(c.page)+1;break;case "last":if(c.page>=c.pageCount)return;c.newPage=c.pageCount;break;case "input":a=parseInt(b(".pcontrol input",this.toolbar).val()),isNaN(a)&&(a=1),1>a?a=1:a>c.pageCount&&(a=c.pageCount),b(".pcontrol input",this.toolbar).val(a),c.newPage=a}if(c.newPage==c.page)return!1;1==c.newPage?(b(".l-bar-btnfirst span",this.toolbar).addClass("l-disabled"),b(".l-bar-btnprev span",this.toolbar).addClass("l-disabled")):(b(".l-bar-btnfirst span",this.toolbar).removeClass("l-disabled"),b(".l-bar-btnprev span",this.toolbar).removeClass("l-disabled"));c.newPage==c.pageCount?(b(".l-bar-btnlast span",this.toolbar).addClass("l-disabled"),b(".l-bar-btnnext span",this.toolbar).addClass("l-disabled")):(b(".l-bar-btnlast span",this.toolbar).removeClass("l-disabled"),b(".l-bar-btnnext span",this.toolbar).removeClass("l-disabled"));this.trigger("changePage",[c.newPage]);"server"==c.dataAction?this.loadData(c.where):(this.currentData=this._getCurrentPageData(this.filteredData),this._showData())},getSelectedRow:function(){for(var a in this.selected){var b=this.selected[a];if(b.__id in this.records)return b}return null},getSelectedRows:function(){var a=[],b;for(b in this.selected){var c=this.selected[b];c.__id in this.records&&a.push(c)}return a},getSelectedRowObj:function(){for(var a in this.selected){var b=this.selected[a];if(b.__id in this.records)return this.getRowObj(b)}return null},getSelectedRowObjs:function(){var a=[],b;for(b in this.selected){var c=this.selected[b];c.__id in this.records&&a.push(this.getRowObj(c))}return a},getCellObj:function(a,b){var c=this.getRow(a);b=this.getColumn(b);return document.getElementById(this._getCellDomId(c,b))},getRowObj:function(a,b){return null==a?null:"string"==typeof a?this._isRowId(a)?document.getElementById(this.id+(b?"|1|":"|2|")+a):document.getElementById(this.id+(b?"|1|":"|2|")+this.rows[parseInt(a)].__id):"number"==typeof a?document.getElementById(this.id+(b?"|1|":"|2|")+this.rows[a].__id):"object"==typeof a&&a.__id?this.getRowObj(a.__id,b):a},getRow:function(a){return null==a?null:"string"==typeof a?this._isRowId(a)?this.records[a]:this.rows[parseInt(a)]:"number"==typeof a?this.rows[parseInt(a)]:"object"!=typeof a||1!=a.nodeType||a.__id?a:this._getRowByDomId(a.id)},_setColumnVisible:function(a,b){if(b){if(a._hide=!0,document.getElementById(a.__domid).style.display="none",-1!=a.__pid){for(var c=!0,f=this._columns[a.__pid],h=0;f&&h<f.columns.length;h++)if(!f.columns[h]._hide){c=!1;break}c&&(f._hide=!0,document.getElementById(f.__domid).style.display="none",this._setColumnVisible(f,b))}}else if(a._hide=!1,document.getElementById(a.__domid).style.display="",-1!=a.__pid){var f=this._columns[a.__pid];f._hide&&(document.getElementById(f.__domid).style.display="",this._setColumnVisible(f,b))}},toggleCol:function(a,c,e){var f=this,h;if("number"==typeof a)h=f.columns[a];else if("object"==typeof a&&a.__id)h=a;else if("string"==typeof a)if(f._isColumnId(a))h=f._columns[a];else{b(f.columns).each(function(){this.name==a&&f.toggleCol(this,c,e)});return}if(h){var k=h.__leafindex,m=document.getElementById(h.__domid);if(m){var m=b(m),m=[],n;for(n in f.rows){var q=f.getCellObj(f.rows[n],h);q&&m.push(q)}for(n=0;n<f.totalNumber;n++)(q=document.getElementById(f.id+"|total"+n+"|"+h.__id))&&m.push(q);n=h._width;c&&h._hide?(h.frozen?f.f.gridtablewidth+=parseInt(n)+1:f.gridtablewidth+=parseInt(n)+1,f._setColumnVisible(h,!1),b(m).show()):c||h._hide||(h.frozen?f.f.gridtablewidth-=parseInt(n)+1:f.gridtablewidth-=parseInt(n)+1,f._setColumnVisible(h,!0),b(m).hide());h.frozen?(b("div:first",f.f.gridheader).width(f.f.gridtablewidth),b("div:first",f.f.gridbody).width(f.f.gridtablewidth)):(b("div:first",f.gridheader).width(f.gridtablewidth+40),b("div:first",f.gridbody).width(f.gridtablewidth));f._updateFrozenWidth();e||b(":checkbox[columnindex\x3d"+k+"]",f.popup).each(function(){this.checked=c;if(b.fn.ligerCheckBox){var a=b(this).ligerGetCheckBoxManager();a&&a.updateStyle()}})}}},setColumnWidth:function(a,c){var e=this,f=this.options;if(c){c=parseInt(c,10);var h;if("number"==typeof a)h=e.columns[a];else if("object"==typeof a&&a.__id)h=a;else if("string"==typeof a)if(e._isColumnId(a))h=e._columns[a];else{b(e.columns).each(function(){this.name==a&&e.setColumnWidth(this,c)});return}if(h&&(f=f.minColumnWidth,h.minWidth&&(f=h.minWidth),c=c<f?f:c,f=c-h._width,!1!=e.trigger("beforeChangeColumnWidth",[h,c]))){h._width=c;h.frozen?(e.f.gridtablewidth+=f,b("div:first",e.f.gridheader).width(e.f.gridtablewidth),b("div:first",e.f.gridbody).width(e.f.gridtablewidth)):(e.gridtablewidth+=f,b("div:first",e.gridheader).width(e.gridtablewidth+40),b("div:first",e.gridbody).width(e.gridtablewidth));b(document.getElementById(h.__domid)).css("width",c);var f=[],k;for(k in e.records){var m=e.getCellObj(e.records[k],h);m&&f.push(m);!e.enabledDetailEdit()&&e.editors[k]&&e.editors[k][h.__id]&&(m=e.editors[k][h.__id],m.editor.resize&&m.editor.resize(m.input,c,m.container.height(),m.editParm))}for(k=0;k<e.totalNumber;k++)(m=document.getElementById(e.id+"|total"+k+"|"+h.__id))&&f.push(m);b(f).css("width",c).find("\x3e div.l-grid-row-cell-inner:first").css("width",c-8);e._updateFrozenWidth();e._updateHorizontalScrollStatus.ligerDefer(e,10);e.trigger("afterChangeColumnWidth",[h,c])}}},changeHeaderText:function(a,c){var e=this,f=this.options,h;if("number"==typeof a)h=e.columns[a];else if("object"==typeof a&&a.__id)h=a;else if("string"==typeof a)if(e._isColumnId(a))h=e._columns[a];else{b(e.columns).each(function(){this.name==a&&e.changeHeaderText(this,c)});return}if(h){var k=h.__leafindex;h=document.getElementById(h.__domid);b(".l-grid-hd-cell-text",h).html(c);f.allowHideColumn&&b(":checkbox[columnindex\x3d"+k+"]",e.popup).parent().next().html(c)}},changeCol:function(a,c,e){var f=this.options;if(a&&c){a=this.getColumn(a);var h=this.getColumn(c);a.frozen=h.frozen;var k=-1==a.__pid?f.columns:this._columns[a.__pid].columns,m=-1==h.__pid?f.columns:this._columns[h.__pid].columns;c=b.inArray(a,k);var h=b.inArray(h,m),n=k==m;m.splice(h+(e?1:0),0,a);n?e?k.splice(c,1):k.splice(c+1,1):k.splice(c,1);this._setColumns(f.columns);this.reRender()}},collapseDetail:function(a){if(a=this.getRow(a))for(var c=0,e=this.columns.length;c<e;c++)if(this.columns[c].isdetail){e=this.getRowObj(a);a=this.getCellObj(a,this.columns[c]);b(e).next("tr.l-grid-detailpanel").hide();b(".l-grid-row-cell-detailbtn:first",a).removeClass("l-open");this.trigger("SysGridHeightChanged");break}},extendDetail:function(a){if(a=this.getRow(a))for(var c=0,e=this.columns;c<e;c++)if(this.columns[c].isdetail){e=this.getRowObj(a);a=this.getCellObj(a,this.columns[c]);b(e).next("tr.l-grid-detailpanel").show();b(".l-grid-row-cell-detailbtn:first",a).addClass("l-open");this.trigger("SysGridHeightChanged");break}},getParent:function(a){return this.options.tree?(a=this.getRow(a))?a.__pid in this.records?this.records[a.__pid]:null:null:null},getChildren:function(a,b){function c(a){if(a[f.tree.childrenName])for(var d=0,h=a[f.tree.childrenName].length;d<h;d++){var r=a[f.tree.childrenName][d];"delete"!=r.__status&&(k.push(r),b&&c(r))}}var f=this.options;if(!f.tree)return null;var h=this.getRow(a);if(!h)return null;var k=[];c(h);return k},isLeaf:function(a){if(a=this.getRow(a))return a.__hasChildren?!1:!0},hasChildren:function(a){var b=this.options;if(a=this.getRow(a))return a[b.tree.childrenName]&&a[b.tree.childrenName].length?!0:!1},existRecord:function(a){for(var b in this.records)if(this.records[b]==a)return!0;return!1},_removeSelected:function(a){if(this.options.tree){var c=this.getChildren(a,!0);if(c)for(var e=0,f=c.length;e<f;e++){var h=b.inArray(c[e],this.selected);-1!=h&&this.selected.splice(h,1)}}a=b.inArray(a,this.selected);-1!=a&&this.selected.splice(a,1)},_getParentChildren:function(a){var b=this.options;a=this.getRow(a);return b.tree&&this.existRecord(a)&&a.__pid in this.records?this.records[a.__pid][b.tree.childrenName]:this.currentData[b.root]},_removeData:function(a){var c=this._getParentChildren(a),e=b.inArray(a,c);-1!=e&&c.splice(e,1);this._removeSelected(a)},_addData:function(a,c,e,f){var h=this.options;this.currentData||(this.currentData={});this.currentData[h.root]||(this.currentData[h.root]=[]);var k=this.currentData[h.root];e?(h.tree&&(c?k=c[h.tree.childrenName]:e.__pid in this.records&&(k=this.records[e.__pid][h.tree.childrenName])),c=b.inArray(e,k),k.splice(-1==c?-1:c+(f?0:1),0,a)):(h.tree&&c&&(k=c[h.tree.childrenName]),k.push(a))},_appendData:function(a,b,c,f){a[this.options.statusName]="update";this._removeData(a);this._addData(a,b,c,f)},appendRange:function(a,c,e,f){var h=this,k=!1;b.each(a,function(a,d){d.__id&&h.existRecord(d)?(h.isLeaf(c)&&h.upgrade(c),h._appendData(d,c,e,f),k=!0):h.appendRow(d,c,e,f)});k&&h.reRender()},appendRow:function(a,c,e,f){b.isArray(a)?this.appendRange(a,c,e,f):a.__id&&this.existRecord(a)?(this._appendData(a,c,e,f),this.reRender()):(c&&this.isLeaf(c)&&this.upgrade(c),this.addRow(a,e,f?!0:!1,c))},upgrade:function(a){var c=this.options;(a=this.getRow(a))&&c.tree&&(a[c.tree.childrenName]=a[c.tree.childrenName]||[],a.__hasChildren=!0,c=[this.getRowObj(a)],this.enabledFrozen()&&c.push(this.getRowObj(a,!0)),b("\x3e td \x3e div \x3e .l-grid-tree-space:last",c).addClass("l-grid-tree-link l-grid-tree-link-open"))},demotion:function(a){var c=this.options;if((a=this.getRow(a))&&c.tree){c=[this.getRowObj(a)];this.enabledFrozen()&&c.push(this.getRowObj(a,!0));b("\x3e td \x3e div \x3e .l-grid-tree-space:last",c).removeClass("l-grid-tree-link l-grid-tree-link-open l-grid-tree-link-close");if(this.hasChildren(a))for(var c=this.getChildren(a),e=0,f=c.length;e<f;e++)this.deleteRow(c[e]);a.__hasChildren=!1}},collapseAll:function(){var a=this;b(a.rows).each(function(c,e){var f=a.getRowObj(e);b(".l-grid-tree-link",f).hasClass("l-grid-tree-link-close")||a.toggle(e)})},expandAll:function(){var a=this;b(a.rows).each(function(c,e){var f=a.getRowObj(e);b(".l-grid-tree-link",f).hasClass("l-grid-tree-link-open")||a.toggle(e)})},collapse:function(a){var c=this.getRowObj(a);b(".l-grid-tree-link",c).hasClass("l-grid-tree-link-close")||this.toggle(a)},expand:function(a){var c=this.getRowObj(a);b(".l-grid-tree-link",c).hasClass("l-grid-tree-link-open")||this.toggle(a)},toggle:function(a){if(a){a=this.getRow(a);var c=[this.getRowObj(a)];this.enabledFrozen()&&c.push(this.getRowObj(a,!0));var e;e=b(".l-grid-tree-link:first",c);c=!0;this.collapsedRows=this.collapsedRows||[];if(e.hasClass("l-grid-tree-link-close")){if(this.hasBind("treeExpand")&&!1==this.trigger("treeExpand",[a]))return!1;e.removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");e=b.inArray(a,this.collapsedRows);-1!=e&&this.collapsedRows.splice(e,1)}else{if(this.hasBind("treeCollapse")&&!1==this.trigger("treeCollapse",[a]))return!1;c=!1;e.addClass("l-grid-tree-link-close").removeClass("l-grid-tree-link-open");e=b.inArray(a,this.collapsedRows);-1==e&&this.collapsedRows.push(a)}e=this.getChildren(a,!0);for(var f=0,h=e.length;f<h;f++){var k=e[f],m=b([this.getRowObj(k.__id)]);this.enabledFrozen()&&(m=m.add(this.getRowObj(k.__id,!0)));c?(b(".l-grid-tree-link",m).removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open"),m.show()):(b(".l-grid-tree-link",m).removeClass("l-grid-tree-link-open").addClass("l-grid-tree-link-close"),m.hide())}this.trigger(c?"treeExpanded":"treeCollapsed",[a])}},_bulid:function(){this._clearGrid();this._initBuildHeader();this._initHeight();this._initFootbar();this._buildPager();this._setEvent()},_setColumns:function(a){this._initColumns();this._initBuildGridHeader();this._initBuildPopup()},_initBuildHeader:function(){var a=this.options;a.title?(b(".l-panel-header-text",this.header).html(a.title),a.headerImg&&this.header.append("\x3cimg src\x3d'"+a.headerImg+"' /\x3e").addClass("l-panel-header-hasicon")):this.header.hide();a.toolbar?b.fn.ligerToolBar&&(this.toolbarManager=this.topbar.ligerToolBar(a.toolbar)):this.topbar.parent().remove()},_createColumnId:function(a){return null!=a.id&&""!=a.id?a.id.toString():"c"+(100+this._columnCount)},_isColumnId:function(a){return a in this._columns},_initColumns:function(){function a(b,e,f,h){var k="__id __pid __previd __nextid __domid __leaf __leafindex __level __colSpan __rowSpan".split(" "),m;for(m in k)k[m]in b&&delete b[k[m]];e>c._columnMaxLevel&&(c._columnMaxLevel=e);c._columnCount++;b.__id=c._createColumnId(b);b.__domid=c.id+"|hcell|"+b.__id;c._columns[b.__id]=b;b.columns&&b.columns.length||(b.__leafindex=c._columnLeafCount++);b.__level=e;b.__pid=f;b.__previd=h;if(!b.columns||!b.columns.length)return b.__leaf=!0,1;f=0;h=-1;k=0;for(m=b.columns.length;k<m;k++){var n=b.columns[k];f+=a(n,e+1,b.__id,h);h=n.__id}return b.__leafcount=f}var c=this,e=this.options;c._columns={};c._columnCount=0;c._columnLeafCount=0;c._columnMaxLevel=1;if(e.columns){var f=-1;if(e.rownumbers){var h=c.enabledGroup()?!1:e.frozen&&e.frozenRownumbers,h={isrownumber:!0,issystem:!0,width:e.rownumbersColWidth,frozen:h};a(h,1,-1,f);f=h.__id}c.enabledDetail()&&(h=c.enabledGroup()?!1:e.frozen&&e.frozenDetail,h={isdetail:!0,issystem:!0,width:e.detailColWidth,frozen:h},a(h,1,-1,f),f=h.__id);c.enabledCheckbox()&&(h=c.enabledGroup()?!1:e.frozen&&e.frozenCheckbox,h={ischeckbox:!0,issystem:!0,width:e.detailColWidth,frozen:h},a(h,1,-1,f),f=h.__id);for(var k=0,m=e.columns.length;k<m;k++)h=e.columns[k],a(h,1,-1,f),f=h.__id;for(var n in c._columns)h=c._columns[n],1<h.__leafcount&&(h.__colSpan=h.__leafcount),h.__leaf&&h.__level!=c._columnMaxLevel&&(h.__rowSpan=c._columnMaxLevel-h.__level+1);c.columns=c.getColumns();b(c.columns).each(function(a,d){d.columnname=d.name;d.columnindex=a;d.type=d.type||"string";d.islast=a==c.columns.length-1;d.isSort=!1==d.isSort?!1:!0;d.frozen=d.frozen?!0:!1;d._width=c._getColumnWidth(d);d._hide=d.hide?!0:!1})}},_getColumnWidth:function(a){var c=this,e=this.options;if(a._width)return a._width;var f=a.width||e.columnWidth;if(!f||"auto"==f){var h=0,k=0;b(c.columns).each(function(a,d){var b=d.width||e.columnWidth;b&&"auto"!=b?k+=parseInt(c._getColumnWidth(d))+1:h++});f=parseInt((c.grid.width()-k)/h)-1}"string"==typeof f&&0<f.indexOf("%")&&(a._width=f=parseInt(0.01*parseInt(f)*(c.grid.width()-c.columns.length)));a.minWidth&&f<a.minWidth&&(f=a.minWidth);a.maxWidth&&f>a.maxWidth&&(f=a.maxWidth);return f},_createHeaderCell:function(a){var c=this,e=this.options,f=b("\x3ctd class\x3d'l-grid-hd-cell'\x3e\x3cdiv class\x3d'l-grid-hd-cell-inner'\x3e\x3cspan class\x3d'l-grid-hd-cell-text'\x3e\x3c/span\x3e\x3c/div\x3e\x3c/td\x3e");f.attr("id",a.__domid);a.__leaf||f.addClass("l-grid-hd-cell-mul");a.columnindex==c.columns.length-1&&f.addClass("l-grid-hd-cell-last");a.isrownumber&&(f.addClass("l-grid-hd-cell-rownumbers"),f.html("\x3cdiv class\x3d'l-grid-hd-cell-inner'\x3e\x3c/div\x3e"));a.ischeckbox&&(f.addClass("l-grid-hd-cell-checkbox"),f.html("\x3cdiv class\x3d'l-grid-hd-cell-inner'\x3e\x3cdiv class\x3d'l-grid-hd-cell-text l-grid-hd-cell-btn-checkbox'\x3e\x3c/div\x3e\x3c/div\x3e"));a.isdetail&&(f.addClass("l-grid-hd-cell-detail"),f.html("\x3cdiv class\x3d'l-grid-hd-cell-inner'\x3e\x3cdiv class\x3d'l-grid-hd-cell-text l-grid-hd-cell-btn-detail'\x3e\x3c/div\x3e\x3c/div\x3e"));a.heightAlign&&b(".l-grid-hd-cell-inner:first",f).css("textAlign",a.heightAlign);a.__colSpan&&f.attr("colSpan",a.__colSpan);if(a.__rowSpan){f.attr("rowSpan",a.__rowSpan);f.height(e.headerRowHeight*a.__rowSpan);var h=(e.headerRowHeight*a.__rowSpan-e.headerRowHeight)/2-5;b(".l-grid-hd-cell-inner:first",f).css("paddingTop",h)}else f.height(e.headerRowHeight);a.__leaf&&(f.width(a._width),f.attr("columnindex",a.__leafindex));h=f.height();!a.__rowSpan&&10<h&&b("\x3ediv:first",f).height(h);a._hide&&f.hide();a.name&&f.attr({columnname:a.name});h="";h=a.display&&""!=a.display?a.display:a.headerRender?a.headerRender(a):"\x26nbsp;";b(".l-grid-hd-cell-text:first",f).html(h);!a.issystem&&a.__leaf&&!1!==a.resizable&&b.fn.ligerResizable&&e.allowAdjustColWidth&&(c.colResizable[a.__id]=f.ligerResizable({handles:"e",onStartResize:function(a,b){this.proxy.hide();c.draggingline.css({height:c.body.height(),top:0,left:b.pageX-c.grid.offset().left+parseInt(c.body[0].scrollLeft)}).show()},onResize:function(a,d){c.colresizing=!0;c.draggingline.css({left:d.pageX-c.grid.offset().left+parseInt(c.body[0].scrollLeft)});b("body").add(f).css("cursor","e-resize")},onStopResize:function(e){c.colresizing=!1;b("body").add(f).css("cursor","default");c.draggingline.hide();c.setColumnWidth(a,parseInt(a._width)+e.diffX);return!1}}));return f},_initBuildGridHeader:function(){var a=this,c=this.options;a.gridtablewidth=0;a.f.gridtablewidth=0;if(a.colResizable){for(var e in a.colResizable)a.colResizable[e].destroy();a.colResizable=null}a.colResizable={};b("tbody:first",a.gridheader).html("");b("tbody:first",a.f.gridheader).html("");for(e=1;e<=a._columnMaxLevel;e++){var f=a.getColumns(e),h=e==a._columnMaxLevel,k=b("\x3ctr class\x3d'l-grid-hd-row'\x3e\x3c/tr\x3e"),m=b("\x3ctr class\x3d'l-grid-hd-row'\x3e\x3c/tr\x3e");h||k.add(m).addClass("l-grid-hd-mul");b("tbody:first",a.gridheader).append(k);b("tbody:first",a.f.gridheader).append(m);b(f).each(function(b,c){(c.frozen?m:k).append(a._createHeaderCell(c));if(c.__leaf){var e=c._width;c.frozen?a.f.gridtablewidth+=(parseInt(e)?parseInt(e):0)+1:a.gridtablewidth+=(parseInt(e)?parseInt(e):0)+1}})}0<a._columnMaxLevel&&(e=c.headerRowHeight*a._columnMaxLevel,a.gridheader.add(a.f.gridheader).height(e),c.rownumbers&&c.frozenRownumbers&&a.f.gridheader.find("td:first").height(e));a._updateFrozenWidth();b("div:first",a.gridheader).width(a.gridtablewidth+40)},_initBuildPopup:function(){var a=this,c=this.options;b(":checkbox",a.popup).unbind();b("tbody tr",a.popup).remove();b(a.columns).each(function(c,e){if(!e.issystem&&!1!=e.isAllowHide){var g='checked\x3d"checked"';e._hide&&(g="");var m=e.display;b("tbody",a.popup).append('\x3ctr\x3e\x3ctd class\x3d"l-column-left"\x3e\x3cinput type\x3d"checkbox" '+g+' class\x3d"l-checkbox" columnindex\x3d"'+c+'"/\x3e\x3c/td\x3e\x3ctd class\x3d"l-column-right"\x3e'+m+"\x3c/td\x3e\x3c/tr\x3e")}});b.fn.ligerCheckBox&&b("input:checkbox",a.popup).ligerCheckBox({onBeforeClick:function(e){return e.checked?b("input:checked",a.popup).length<=c.minColToggle?!1:!0:!0}});if(c.allowHideColumn){b("tr",a.popup).hover(function(){b(this).addClass("l-popup-row-over")},function(){b(this).removeClass("l-popup-row-over")});var e=function(){if(b("input:checked",a.popup).length+1<=c.minColToggle)return!1;a.toggleCol(parseInt(b(this).attr("columnindex")),this.checked,!0)};b.fn.ligerCheckBox?b(":checkbox",a.popup).bind("change",e):b(":checkbox",a.popup).bind("click",e)}},_initHeight:function(){var a=this.options;"auto"==a.height&&(this.gridbody.height("auto"),this.f.gridbody.height("auto"));a.width&&this.grid.width(a.width);this._onResize.call(this)},_initFootbar:function(){var a=this,c=this.options;if(c.usePager){var e="",f=-1;b(c.pageSizeOptions).each(function(a,b){c.pageSize==b&&(f=a);e+="\x3coption value\x3d'"+b+"'  \x3e"+b+"\x3c/option\x3e"});b(".l-bar-selectpagesize",a.toolbar).append("\x3cselect name\x3d'rp'\x3e"+e+"\x3c/select\x3e");-1!=f&&(b(".l-bar-selectpagesize select",a.toolbar)[0].selectedIndex=f);c.switchPageSizeApplyComboBox&&b.fn.ligerComboBox&&b(".l-bar-selectpagesize select",a.toolbar).ligerComboBox({onBeforeSelect:function(){return c.url&&a.isDataChanged&&!confirm(c.isContinueByDataChanged)?!1:!0},width:45})}else a.toolbar.hide()},_searchData:function(a,b){for(var c=[],f=0;f<a.length;f++)b(a[f],f)&&(c[c.length]=a[f]);return c},_clearGrid:function(){for(var a in this.rows){var c=b(this.getRowObj(this.rows[a]));this.enabledFrozen()&&(c=c.add(this.getRowObj(this.rows[a],!0)));c.unbind()}this.gridbody.html("");this.f.gridbody.html("");this.recordNumber=0;this.records={};this.rows=[];this.selected=[];this.editorcounter=this.totalNumber=0},_fillGridBody:function(a,c){var e=this,f=this.options,h=['\x3cdiv class\x3d"l-grid-body-inner"\x3e\x3ctable class\x3d"l-grid-body-table" cellpadding\x3d0 cellspacing\x3d0\x3e\x3ctbody\x3e'];if(e.enabledGroup()){var k=[],m=[];e.groups=m;for(var n in a){var q=a[n],r=q[f.groupColumnName],s=b.inArray(r,k);-1==s&&(k.push(r),s=k.length-1,m.push([]));m[s].push(q)}b(m).each(function(a,b){1==m.length&&h.push('\x3ctr class\x3d"l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first"');a==m.length-1?h.push('\x3ctr class\x3d"l-grid-grouprow l-grid-grouprow-last"'):0==a?h.push('\x3ctr class\x3d"l-grid-grouprow l-grid-grouprow-first"'):h.push('\x3ctr class\x3d"l-grid-grouprow"');h.push(' groupindex"\x3d'+a+'" \x3e');h.push('\x3ctd colSpan\x3d"'+e.columns.length+'" class\x3d"l-grid-grouprow-cell"\x3e');h.push('\x3cspan class\x3d"l-grid-group-togglebtn"\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x3c/span\x3e');f.groupRender?h.push(f.groupRender(k[a],b,f.groupColumnDisplay)):h.push(f.groupColumnDisplay+":"+k[a]);h.push("\x3c/td\x3e");h.push("\x3c/tr\x3e");h.push(e._getHtmlFromData(b,c));e.isTotalSummary()&&h.push(e._getTotalSummaryHtml(b,"l-grid-totalsummary-group",c))})}else h.push(e._getHtmlFromData(a,c));h.push("\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e");(c?e.f.gridbody:e.gridbody).html(h.join(""));e.enabledGroup()||e._bulidTotalSummary(c);b("\x3e div:first",e.gridbody).width(e.gridtablewidth);e._onResize()},_showData:function(){var a=this,c=this.options;a.changedCells={};var e=a.currentData[c.root];c.usePager&&("server"==c.dataAction&&a.data&&a.data[c.record]?c.total=a.data[c.record]:a.filteredData&&a.filteredData[c.root]?c.total=a.filteredData[c.root].length:a.data&&a.data[c.root]?c.total=a.data[c.root].length:e&&(c.total=e.length),c.page=c.newPage,c.total||(c.total=0),c.page||(c.page=1),c.pageCount=Math.ceil(c.total/c.pageSize),c.pageCount||(c.pageCount=1),a._buildPager());b(".l-bar-btnloading:first",a.toolbar).removeClass("l-bar-btnloading");if(!1!=a.trigger("beforeShowData",[a.currentData]))if(a._clearGrid(),a.isDataChanged=!1,e&&e.length){a.gridview.removeClass("l-grid-empty");b(".l-bar-btnload:first span",a.toolbar).removeClass("l-disabled");a._updateGridData();a.enabledFrozen()&&a._fillGridBody(a.rows,!0);a._fillGridBody(a.rows,!1);a.trigger("SysGridHeightChanged");c.totalRender&&(b(".l-panel-bar-total",a.element).remove(),b(".l-panel-bar",a.element).before('\x3cdiv class\x3d"l-panel-bar-total"\x3e'+c.totalRender(a.data,a.filteredData)+"\x3c/div\x3e"));if(c.mouseoverRowCssClass)for(var f in a.rows)c=b(a.getRowObj(a.rows[f])),a.enabledFrozen()&&(c=c.add(a.getRowObj(a.rows[f],!0))),c.bind("mouseover.gridrow",function(){a._onRowOver(this,!0)}).bind("mouseout.gridrow",function(){a._onRowOver(this,!1)});a._fixHeight();a.gridbody.trigger("scroll.grid");a.trigger("afterShowData",[a.currentData])}else a.gridview.addClass("l-grid-empty"),b("\x3cdiv\x3e\x3c/div\x3e").addClass("l-grid-body-inner").appendTo(a.gridbody).css({width:a.gridheader.find("\x3ediv:first").width(),height:a.gridbody.height()}),a._onResize.ligerDefer(a,50)},_fixHeight:function(){var a=this.options;if(!a.fixedCellHeight&&a.frozen){var c,e,f;for(f in this.columns){a=this.columns[f];if(c&&e)break;a.frozen&&!c?c=a:a.frozen||e||(e=a)}if(c&&e)for(var h in this.records){f=this.getCellObj(h,c);var a=this.getCellObj(h,e),k=Math.max(b(f).height(),b(a).height());b(f).add(a).height(k)}}},_getRowDomId:function(a,b){return this.id+"|"+(b?"1":"2")+"|"+a.__id},_getCellDomId:function(a,b){return this._getRowDomId(a,b.frozen)+"|"+b.__id},_getHtmlFromData:function(a,c){if(!a)return"";for(var e=this,f=this.options,h=[],k=0,m=a.length;k<m;k++){var n=a[k],q=n.__id;n&&(h.push("\x3ctr"),h.push(' id\x3d"'+e._getRowDomId(n,c)+'"'),h.push(' class\x3d"l-grid-row'),!c&&e.enabledCheckbox()&&f.isChecked&&f.isChecked(n)?(e.select(n),h.push(" l-selected")):e.isSelected(n)?h.push(" l-selected"):f.isSelected&&f.isSelected(n)&&(e.select(n),h.push(" l-selected")),1==n.__index%2&&f.alternatingRow&&h.push(" l-grid-row-alt"),h.push('" '),f.rowAttrRender&&h.push(f.rowAttrRender(n,q)),f.tree&&e.collapsedRows&&e.collapsedRows.length&&function(){for(var a=e.getParent(n);a;){if(-1!=b.inArray(a,e.collapsedRows))return!0;a=e.getParent(a)}return!1}()&&h.push(' style\x3d"display:none;" '),h.push("\x3e"),b(e.columns).each(function(a,b){if(c==b.frozen)if(h.push("\x3ctd"),h.push(' id\x3d"'+e._getCellDomId(n,this)+'"'),this.isrownumber)h.push(' class\x3d"l-grid-row-cell l-grid-row-cell-rownumbers" style\x3d"width:'+this.width+'px"\x3e\x3cdiv class\x3d"l-grid-row-cell-inner"'),f.fixedCellHeight?h.push(' style \x3d "height:'+f.rowHeight+'px;" '):h.push(' style \x3d "min-height:'+f.rowHeight+'px;" '),h.push("\x3e"+(parseInt(n.__index)+1)+"\x3c/div\x3e\x3c/td\x3e");else if(this.ischeckbox)h.push(' class\x3d"l-grid-row-cell l-grid-row-cell-checkbox" style\x3d"width:'+this.width+'px"\x3e\x3cdiv class\x3d"l-grid-row-cell-inner"'),f.fixedCellHeight?h.push(' style \x3d "height:'+f.rowHeight+'px;" '):h.push(' style \x3d "min-height:'+f.rowHeight+'px;" '),h.push("\x3e"),h.push('\x3cspan class\x3d"l-grid-row-cell-btn-checkbox"\x3e\x3c/span\x3e'),h.push("\x3c/div\x3e\x3c/td\x3e");else if(this.isdetail)h.push(' class\x3d"l-grid-row-cell l-grid-row-cell-detail" style\x3d"width:'+this.width+'px"\x3e\x3cdiv class\x3d"l-grid-row-cell-inner"'),f.fixedCellHeight?h.push(' style \x3d "height:'+f.rowHeight+'px;" '):h.push(' style \x3d "min-height:'+f.rowHeight+'px;" '),h.push("\x3e"),f.isShowDetailToggle&&!f.isShowDetailToggle(n)||h.push('\x3cspan class\x3d"l-grid-row-cell-detailbtn"\x3e\x3c/span\x3e'),h.push("\x3c/div\x3e\x3c/td\x3e");else{var d=this._width;h.push(' class\x3d"l-grid-row-cell ');e.changedCells[q+"_"+this.__id]&&h.push("l-grid-row-cell-edited ");this.islast&&h.push("l-grid-row-cell-last ");h.push('"');h.push(' style \x3d "');h.push("width:"+d+"px; ");b._hide&&h.push("display:none;");h.push(' "\x3e');h.push(e._getCellHtml(n,b));h.push("\x3c/td\x3e")}}),h.push("\x3c/tr\x3e"))}return h.join("")},_getCellHtml:function(a,b){var c=this.options;if(b.isrownumber)return'\x3cdiv class\x3d"l-grid-row-cell-inner"\x3e'+(parseInt(a.__index)+1)+"\x3c/div\x3e";var f=[];f.push('\x3cdiv class\x3d"l-grid-row-cell-inner"');f.push(' style \x3d "width:'+parseInt(b._width-8)+"px;");c.fixedCellHeight&&f.push("height:"+c.rowHeight+"px;");f.push("min-height:"+c.rowHeight+"px; ");b.align&&f.push("text-align:"+b.align+";");c=this._getCellContent(a,b);f.push('"\x3e'+c+"\x3c/div\x3e");return f.join("")},_setValueByName:function(a,b,c){if(!a||!b)return null;if(-1==b.indexOf("."))a[b]=c;else try{(new Function("data,value","data."+b+"\x3dvalue;"))(a,c)}catch(f){}},_getValueByName:function(a,b){if(!a||!b)return null;if(-1==b.indexOf("."))return a[b];try{return(new Function("data","return data."+b+";"))(a)}catch(c){return null}},_getCellContent:function(a,b){var c=this.options;if(!a||!b)return"";if(b.isrownumber)return parseInt(a.__index)+1;var f=a.__index,h=this._getValueByName(a,b.name),k=this._getValueByName(a,b.textField),m="";b.render?m=b.render.call(this,a,f,h,b):c.formatters[b.type]?m=c.formatters[b.type].call(this,h,b):null!=k?m=k.toString():null!=h&&(m=h.toString());c.tree&&(null!=c.tree.columnName&&c.tree.columnName==b.name||null!=c.tree.columnId&&c.tree.columnId==b.id)&&(m=this._getTreeCellHtml(m,a));return m||""},_getTreeCellHtml:function(a,c){for(var e=c.__level,f=this.options,h=-1==b.inArray(c,this.collapsedRows||[]),f=f.tree.isParent(c),k="",e=parseInt(e)||1,m=1;m<e;m++)k+="\x3cdiv class\x3d'l-grid-tree-space'\x3e\x3c/div\x3e";return k=(h&&f?k+"\x3cdiv class\x3d'l-grid-tree-space l-grid-tree-link l-grid-tree-link-open'\x3e\x3c/div\x3e":f?k+"\x3cdiv class\x3d'l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'\x3e\x3c/div\x3e":k+"\x3cdiv class\x3d'l-grid-tree-space'\x3e\x3c/div\x3e")+("\x3cspan class\x3d'l-grid-tree-content'\x3e"+a+"\x3c/span\x3e")},_applyEditor:function(a){var c=this,e=this.options,f=a.id.split("|"),h=c._columns[f[f.length-1]],f=b(a).parent(),f=c.getRow(f[0]),k=f.__id,m=f.__index;if(h&&h.editor){var n=h.name;if(h.editor.type&&e.editors[h.editor.type]){var q=c._getValueByName(f,n),r={record:f,value:q,column:h,rowindex:m};h.textField&&(r.text=c._getValueByName(f,h.textField));if(!1==c.trigger("beforeEdit",[r]))return!1;c.lastEditRow=f;var s=e.editors[h.editor.type],m=b(a);b(a).offset();var n=b(a).width(),t=b(a).height(),u=b("\x3cdiv class\x3d'l-grid-editor'\x3e\x3c/div\x3e").appendTo(c.grid),w=0,x=0,x=m.position(),v=c.gridbody.position(),y=c.gridview2.position(),e=e.toolbar?c.topbar.parent().outerHeight():0+e.title?c.header.outerHeight():0,w=x.left+v.left+y.left,x=x.top+v.top+y.top+e;m.html("");c.setCellEditing(f,h,!0);u.css({left:w,top:b.browser.safari?x+2:x+1}).show();h.textField&&(r.text=c._getValueByName(f,h.textField));var z=c._createEditor(s,u,r,n,t-1);c.editor={editing:!0,editor:s,input:z,editParm:r,container:u};c.unbind("sysEndEdit");c.bind("sysEndEdit",function(){var e=s.getValue(z,r);if(e!=q){b(a).addClass("l-grid-row-cell-edited");c.changedCells[k+"_"+h.__id]=!0;r.value=e;h.textField&&s.getText&&(r.text=s.getText(z,r));s.getSelected&&(r.selected=s.getSelected(z,r));if(h.editor.onChange)h.editor.onChange(r);if(c._checkEditAndUpdateCell(r)&&h.editor.onChanged)h.editor.onChanged(r)}})}}},_checkEditAndUpdateCell:function(a){if(!1==this.trigger("beforeSubmitEdit",[a]))return!1;var b=a.column;a.text&&b.textField&&this._setValueByName(a.record,b.textField,a.text);this.updateCell(b,a.value,a.record);(b.render||this.enabledTotal())&&this.reRender({column:b});this.reRender({rowdata:a.record});return!0},_getCurrentPageData:function(a){var b=this.options,c={};c[b.root]=[];if(!a||!a[b.root]||!a[b.root].length)return c[b.record]=0,c;c[b.record]=a[b.root].length;b.newPage||(b.newPage=1);for(i=(b.newPage-1)*b.pageSize;i<a[b.root].length&&i<b.newPage*b.pageSize;i++)c[b.root].push(a[b.root][i]);return c},_compareData:function(a,b,c,f){var h=this.options;a=a[c];b=b[c];return null==a&&null!=b?1:null==a&&null==b?0:null!=a&&null==b?-1:h.sorters[f]?h.sorters[f].call(this,a,b):a<b?-1:a>b?1:0},_getTotalCellContent:function(a,b){var c=[];if(a.totalSummary){for(var f=function(a){for(var b=0;b<s.length;b++)if(s[b].toLowerCase()==a.toLowerCase())return!0;return!1},h=0,k=0,m=0,n=parseFloat(b[0][a.name]),q=parseFloat(b[0][a.name]),m=0;m<b.length;m++){var k=k+1,r=b[m][a.name];"string"==typeof r&&(r=r.replace(/\$|\,/g,""));if(r=parseFloat(r))h+=r,r>n&&(n=r),r<q&&(q=r)}m=1*h/b.length;if(a.totalSummary.render)f=a.totalSummary.render({sum:h,count:k,avg:m,min:q,max:n},a,this.data),c.push(f);else if(a.totalSummary.type){var s=a.totalSummary.type.split(",");f("sum")&&c.push("\x3cdiv\x3eSum\x3d"+h.toFixed(2)+"\x3c/div\x3e");f("count")&&c.push("\x3cdiv\x3eCount\x3d"+k+"\x3c/div\x3e");f("max")&&c.push("\x3cdiv\x3eMax\x3d"+n.toFixed(2)+"\x3c/div\x3e");f("min")&&c.push("\x3cdiv\x3eMin\x3d"+q.toFixed(2)+"\x3c/div\x3e");f("avg")&&c.push("\x3cdiv\x3eAvg\x3d"+m.toFixed(2)+"\x3c/div\x3e")}}return c.join("")},_getTotalSummaryHtml:function(a,c,e){var f=this,h=[];c?h.push('\x3ctr class\x3d"l-grid-totalsummary '+c+'"\x3e'):h.push('\x3ctr class\x3d"l-grid-totalsummary"\x3e');b(f.columns).each(function(b,c){this.frozen==e&&(this.isrownumber?h.push('\x3ctd class\x3d"l-grid-totalsummary-cell l-grid-totalsummary-cell-rownumbers" style\x3d"width:'+this.width+'px"\x3e\x3cdiv\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e'):this.ischeckbox?h.push('\x3ctd class\x3d"l-grid-totalsummary-cell l-grid-totalsummary-cell-checkbox" style\x3d"width:'+this.width+'px"\x3e\x3cdiv\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e'):this.isdetail?h.push('\x3ctd class\x3d"l-grid-totalsummary-cell l-grid-totalsummary-cell-detail" style\x3d"width:'+this.width+'px"\x3e\x3cdiv\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e'):(h.push('\x3ctd class\x3d"l-grid-totalsummary-cell'),this.islast&&h.push(" l-grid-totalsummary-cell-last"),h.push('" '),h.push('id\x3d"'+f.id+"|total"+f.totalNumber+"|"+c.__id+'" '),h.push('width\x3d"'+this._width+'" '),(columnname=this.columnname)&&h.push('columnname\x3d"'+columnname+'" '),h.push('columnindex\x3d"'+b+'" '),h.push('\x3e\x3cdiv class\x3d"l-grid-totalsummary-cell-inner"'),c.align&&h.push(' style\x3d"text-Align:'+c.align+';"'),h.push("\x3e"),h.push(f._getTotalCellContent(c,a)),h.push("\x3c/div\x3e\x3c/td\x3e")))});h.push("\x3c/tr\x3e");e||f.totalNumber++;return h.join("")},_bulidTotalSummary:function(a){var c=this.options;if(!this.isTotalSummary()||!this.currentData||0==this.currentData[c.root].length)return!1;c=b(this._getTotalSummaryHtml(this.currentData[c.root],null,a));b("tbody:first",a?this.f.gridbody:this.gridbody).append(c);a?this.totalRow1=c:this.totalRow2=c},updateTotalSummary:function(){var a=this.options;this.isTotalSummary()&&this.currentData&&0!=this.currentData[a.root].length&&(a=b(this._getTotalSummaryHtml(this.currentData[a.root],null,!1)),this.totalRow2&&this.totalRow2.html(a.html()))},_buildPager:function(){var a=this.options;b(".pcontrol input",this.toolbar).val(a.page);a.pageCount||(a.pageCount=1);b(".pcontrol span",this.toolbar).html(a.pageCount);var c=parseInt((a.page-1)*a.pageSize)+1,e=parseInt(c)+parseInt(a.pageSize)-1;a.total||(a.total=0);a.total<e&&(e=a.total);a.total||(c=e=0);0>c&&(c=0);0>e&&(e=0);var f=a.pageStatMessage,f=f.replace(/{from}/,c),f=f.replace(/{to}/,e),f=f.replace(/{total}/,a.total),f=f.replace(/{pagesize}/,a.pageSize);b(".l-bar-text",this.toolbar).html(f);a.total||b(".l-bar-btnfirst span,.l-bar-btnprev span,.l-bar-btnnext span,.l-bar-btnlast span",this.toolbar).addClass("l-disabled");1==a.page?(b(".l-bar-btnfirst span",this.toolbar).addClass("l-disabled"),b(".l-bar-btnprev span",this.toolbar).addClass("l-disabled")):a.page>a.pageCount&&0<a.pageCount&&(b(".l-bar-btnfirst span",this.toolbar).removeClass("l-disabled"),b(".l-bar-btnprev span",this.toolbar).removeClass("l-disabled"));a.page==a.pageCount?(b(".l-bar-btnlast span",this.toolbar).addClass("l-disabled"),b(".l-bar-btnnext span",this.toolbar).addClass("l-disabled")):a.page<a.pageCount&&0<a.pageCount&&(b(".l-bar-btnlast span",this.toolbar).removeClass("l-disabled"),b(".l-bar-btnnext span",this.toolbar).removeClass("l-disabled"))},_getRowIdByDomId:function(a){return a.split("|")[2]},_getRowByDomId:function(a){return this.records[this._getRowIdByDomId(a)]},_isEditing:function(a){return a.hasClass("l-box-dateeditor")||a.hasClass("l-box-select")},_getSrcElementByEvent:function(a){a=a.target||a.srcElement;var c=b(a).parents().add(a);a=function(a){for(var d=0,e=c.length;d<e;d++)if("string"==typeof a){if(b(c[d]).hasClass(a))return c[d]}else if("object"==typeof a&&c[d]==a)return c[d];return null};if(a("l-grid-editor"))return{editing:!0,editor:a("l-grid-editor")};if(-1==c.index(this.element))return this._isEditing(c)?{editing:!0}:{out:!0};var e=!1;if(c.hasClass("l-grid-detailpanel")&&this.detailrows)for(var f=0,h=this.detailrows.length;f<h;f++)if(-1!=c.index(this.detailrows[f])){e=!0;break}e={grid:a("l-panel"),indetail:e,frozen:a(this.gridview1[0])?!0:!1,header:a("l-panel-header"),gridheader:a("l-grid-header"),gridbody:a("l-grid-body"),total:a("l-panel-bar-total"),popup:a("l-grid-popup"),toolbar:a("l-panel-bar")};e.gridheader&&(e.hrow=a("l-grid-hd-row"),e.hcell=a("l-grid-hd-cell"),e.hcelltext=a("l-grid-hd-cell-text"),e.checkboxall=a("l-grid-hd-cell-checkbox"),e.hcell&&(f=e.hcell.id.split("|")[2],e.column=this._columns[f]));e.gridbody&&(e.row=a("l-grid-row"),e.cell=a("l-grid-row-cell"),e.checkbox=a("l-grid-row-cell-btn-checkbox"),e.groupbtn=a("l-grid-group-togglebtn"),e.grouprow=a("l-grid-grouprow"),e.detailbtn=a("l-grid-row-cell-detailbtn"),e.detailrow=a("l-grid-detailpanel"),e.totalrow=a("l-grid-totalsummary"),e.totalcell=a("l-grid-totalsummary-cell"),e.rownumberscell=b(e.cell).hasClass("l-grid-row-cell-rownumbers")?e.cell:null,e.detailcell=b(e.cell).hasClass("l-grid-row-cell-detail")?e.cell:null,e.checkboxcell=b(e.cell).hasClass("l-grid-row-cell-checkbox")?e.cell:null,e.treelink=a("l-grid-tree-link"),e.editor=a("l-grid-editor"),e.row&&(e.data=this._getRowByDomId(e.row.id)),e.cell&&(e.editing=b(e.cell).hasClass("l-grid-row-cell-editing")),e.editor&&(e.editing=!0),e.editing&&(e.out=!1));e.toolbar&&(e.first=a("l-bar-btnfirst"),e.last=a("l-bar-btnlast"),e.next=a("l-bar-btnnext"),e.prev=a("l-bar-btnprev"),e.load=a("l-bar-btnload"),e.button=a("l-bar-button"));return e},_setEvent:function(){var a=this,c=this.options;a.grid.bind("mousedown.grid",function(b){a._onMouseDown.call(a,b)});a.grid.bind("dblclick.grid",function(b){a._onDblClick.call(a,b)});a.grid.bind("contextmenu.grid",function(b){return a._onContextmenu.call(a,b)});b(document).bind("mouseup.grid",function(b){a._onMouseUp.call(a,b)});b(document).bind("click.grid",function(b){a._onClick.call(a,b)});b(window).bind("resize.grid",function(b){a._onResize.call(a)});b(document).bind("keydown.grid",function(b){b.ctrlKey&&(a.ctrlKey=!0)});b(document).bind("keyup.grid",function(b){delete a.ctrlKey});a.gridbody.bind("scroll.grid",function(){var b=a.gridbody.scrollLeft(),c=a.gridbody.scrollTop();null!=b&&(a.gridheader[0].scrollLeft=b);null!=c&&(a.f.gridbody[0].scrollTop=c);a.trigger("SysGridHeightChanged")});b("select",a.toolbar).change(function(){if(a.isDataChanged&&"local"!=c.dataAction&&!confirm(c.isContinueByDataChanged))return!1;c.newPage=1;c.pageSize=this.value;a.loadData("local"!=c.dataAction?c.where:!1)});b("span.pcontrol :text",a.toolbar).blur(function(b){a.changePage("input")});b("div.l-bar-button",a.toolbar).hover(function(){b(this).addClass("l-bar-button-over")},function(){b(this).removeClass("l-bar-button-over")});b.fn.ligerDrag&&c.colDraggable&&(a.colDroptip=b("\x3cdiv class\x3d'l-drag-coldroptip' style\x3d'display:none'\x3e\x3cdiv class\x3d'l-drop-move-up'\x3e\x3c/div\x3e\x3cdiv class\x3d'l-drop-move-down'\x3e\x3c/div\x3e\x3c/div\x3e").appendTo("body"),a.gridheader.add(a.f.gridheader).ligerDrag({revert:!0,animate:!1,proxyX:0,proxyY:0,proxy:function(c,f){var g=a._getSrcElementByEvent(f);if(g.hcell&&g.column){var g=b(".l-grid-hd-cell-text:first",g.hcell).html(),k=b("\x3cdiv class\x3d'l-drag-proxy' style\x3d'display:none'\x3e\x3cdiv class\x3d'l-drop-icon l-drop-no'\x3e\x3c/div\x3e\x3c/div\x3e").appendTo("body");k.append(g);return k}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default");a.children[this.id]=this},onStartDrag:function(c,f){if(2==f.button||a.colresizing)return!1;this.set("cursor","default");var g=a._getSrcElementByEvent(f);if(!g.hcell||!g.column||g.column.issystem||g.hcelltext||-1!=b(g.hcell).css("cursor").indexOf("resize"))return!1;this.draggingColumn=g.column;a.coldragging=!0;g=a.grid.offset();this.validRange={top:g.top,bottom:g.top+a.gridheader.height(),left:g.left-10,right:g.left+a.grid.width()+10}},onDrag:function(e,f){this.set("cursor","default");var h=this.draggingColumn;if(!h||a.colresizing)return!1;null==a.colDropIn&&(a.colDropIn=-1);var k=f.pageX,m=f.pageY,n=!1;a.grid.offset();var q=this.validRange;if(k<q.left||k>q.right||m>q.bottom||m<q.top)a.colDropIn=-1,a.colDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no");else for(var r in a._columns)if(q=a._columns[r],h==q)n=!0;else if(!q.issystem){var s=q.__level!=h.__level?!1:n?!0:!1;h.frozen!=q.frozen&&(s=q.frozen?!1:!0);if(-1==a.colDropIn||a.colDropIn==r){var t=document.getElementById(q.__domid),u=b(t).offset(),w=u.top,x=u.top+b(t).height(),v=u.left-10,u=u.left+10;s&&(t=b(t).width(),v+=t,u+=t);if(k>v&&k<u&&m>w&&m<x){h=c.headerRowHeight;q.__rowSpan&&(h*=q.__rowSpan);a.colDroptip.css({left:v+5,top:w-9,height:h+18}).show();a.colDropIn=r;a.colDropDir=s?"right":"left";this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no").addClass("l-drop-yes");break}else-1!=a.colDropIn&&(a.colDropIn=-1,a.colDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no"))}}},onStopDrag:function(b,c){var g=this.draggingColumn;a.coldragging=!1;-1!=a.colDropIn&&(a.changeCol.ligerDefer(a,0,[g,a.colDropIn,"right"==a.colDropDir]),a.colDropIn=-1);a.colDroptip.hide();this.set("cursor","default")}}));b.fn.ligerDrag&&c.rowDraggable&&(a.rowDroptip=b("\x3cdiv class\x3d'l-drag-rowdroptip' style\x3d'display:none'\x3e\x3c/div\x3e").appendTo("body"),a.gridbody.add(a.f.gridbody).ligerDrag({revert:!0,animate:!1,proxyX:0,proxyY:0,proxy:function(e,f){if(a._getSrcElementByEvent(f).row){var h=c.draggingMessage.replace(/{count}/,e.draggingRows?e.draggingRows.length:1);c.rowDraggingRender&&(h=c.rowDraggingRender(e.draggingRows,e,a));return b("\x3cdiv class\x3d'l-drag-proxy' style\x3d'display:none'\x3e\x3cdiv class\x3d'l-drop-icon l-drop-no'\x3e\x3c/div\x3e"+h+"\x3c/div\x3e").appendTo("body")}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default");a.children[this.id]=this},onStartDrag:function(b,c){if(2==c.button||a.colresizing||!a.columns.length)return!1;this.set("cursor","default");var g=a._getSrcElementByEvent(c);if(!g.cell||!g.data||g.checkbox)return!1;var k=g.cell.id.split("|"),k=a._columns[k[k.length-1]];if(g.rownumberscell||g.detailcell||g.checkboxcell||k==a.columns[0]){if(a.enabledCheckbox()){if(this.draggingRows=a.getSelecteds(),!this.draggingRows||!this.draggingRows.length)return!1}else this.draggingRows=[g.data];this.draggingRow=g.data;this.set("cursor","move");a.rowdragging=!0;this.validRange={top:a.gridbody.offset().top,bottom:a.gridbody.offset().top+a.gridbody.height(),left:a.grid.offset().left-10,right:a.grid.offset().left+a.grid.width()+10}}else return!1},onDrag:function(e,f){var h=this.draggingRow;if(!h)return!1;var k=this.draggingRows?this.draggingRows:[h];if(a.colresizing)return!1;null==a.rowDropIn&&(a.rowDropIn=-1);var m=f.pageX,n=f.pageY,q=!1,r=this.validRange;if(m<r.left||m>r.right||n>r.bottom||n<r.top)a.rowDropIn=-1,a.rowDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");else for(var s in a.rows){var t=a.rows[s],r=t.__id;h==t&&(q=!0);if(-1==b.inArray(t,k)&&(t=q?!0:!1,-1==a.rowDropIn||a.rowDropIn==r)){var u=a.getRowObj(r),w=b(u).offset(),x=w.top-4,v=w.top+b(u).height()+4,y=a.grid.offset().left,z=a.grid.offset().left+a.grid.width();if(m>y&&m<z&&n>x&&n<v){h=w.top;t&&(h+=b(u).height());a.rowDroptip.css({left:y,top:h,width:z-y}).show();a.rowDropIn=r;a.rowDropDir=t?"bottom":"top";c.tree&&n>x+5&&n<v-5?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),a.rowDroptip.hide(),a.rowDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),a.rowDroptip.show(),a.rowDropInParent=!1);break}else-1!=a.rowDropIn&&(a.rowDropIn=-1,a.rowDropInParent=!1,a.rowDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}}},onStopDrag:function(e,f){var h=this.draggingRows;a.rowdragging=!1;for(var k=0;k<h.length;k++){var m=h[k].children;m&&(h=b.grep(h,function(a,c){return-1==b.inArray(a,m)}))}if(-1!=a.rowDropIn){if(c.tree){var n,q;a.rowDropInParent?q=a.getRow(a.rowDropIn):(n=a.getRow(a.rowDropIn),q=a.getParent(n));a.appendRange(h,q,n,"bottom"!=a.rowDropDir);a.trigger("rowDragDrop",{rows:h,parent:q,near:n,after:"bottom"==a.rowDropDir})}else a.moveRange(h,a.rowDropIn,"bottom"==a.rowDropDir),a.trigger("rowDragDrop",{rows:h,parent:q,near:a.getRow(a.rowDropIn),after:"bottom"==a.rowDropDir});a.rowDropIn=-1}a.rowDroptip.hide();this.set("cursor","default")}}))},_onRowOver:function(a,g){if(!c.draggable.dragging){var e=this.options,f=this.getRow(a),h=g?"addClass":"removeClass";if(this.enabledFrozen())b(this.getRowObj(f,!0))[h](e.mouseoverRowCssClass);b(this.getRowObj(f,!1))[h](e.mouseoverRowCssClass)}},_onMouseUp:function(a){if(c.draggable.dragging){var b=this._getSrcElementByEvent(a);b.hcell&&b.column?this.trigger("dragdrop",[{type:"header",column:b.column,cell:b.hcell},a]):b.row&&this.trigger("dragdrop",[{type:"row",record:b.data,row:b.row},a])}},_onMouseDown:function(a){},_onContextmenu:function(a){var c=this.options,e=this._getSrcElementByEvent(a);if(e.row){if(c.whenRClickToSelect&&this.select(e.data),this.hasBind("contextmenu"))return this.trigger("contextmenu",[{data:e.data,rowindex:e.data.__index,row:e.row},a])}else if(e.hcell){if(!c.allowHideColumn)return!0;c=b(e.hcell).attr("columnindex");if(void 0==c)return!0;a=a.pageX-this.body.offset().left+parseInt(this.body[0].scrollLeft);c==this.columns.length-1&&(a-=50);this.popup.css({left:a,top:this.gridheader.height()+1});this.popup.toggle();return!1}},_onDblClick:function(a){a=this._getSrcElementByEvent(a);a.row&&this.trigger("dblClickRow",[a.data,a.data.__id,a.row])},_onClick:function(a){var c=this,e=this.options;a=c._getSrcElementByEvent(a);if(a.out)c.editor.editing&&!b.ligerui.win.masking&&c.endEdit(),e.allowHideColumn&&c.popup.hide();else if(!a.indetail&&!a.editing)if(c.editor.editing&&c.endEdit(),e.allowHideColumn&&(a.popup||c.popup.hide()),a.checkboxall){var f=b(a.hrow),h=f.hasClass("l-checked");if(!1==c.trigger("beforeCheckAllRow",[!h,c.element]))return!1;h?f.removeClass("l-checked"):f.addClass("l-checked");c.selected=[];for(var k in c.records)h?c.unselect(c.records[k]):c.select(c.records[k]);c.trigger("checkAllRow",[!h,c.element])}else if(a.hcelltext){if(f=b(a.hcelltext).parent().parent(),e.enabledSort&&a.column&&!1!=a.column.isSort&&(!e.url||"local"==e.dataAction||!c.isDataChanged||confirm(e.isContinueByDataChanged))&&(e=b(".l-grid-hd-cell-sort:first",f),k=a.column.name))0<e.length?e.hasClass("l-grid-hd-cell-sort-asc")?(e.removeClass("l-grid-hd-cell-sort-asc").addClass("l-grid-hd-cell-sort-desc"),f.removeClass("l-grid-hd-cell-asc").addClass("l-grid-hd-cell-desc"),c.trigger("ChangeSort",[k,"desc"]),c.changeSort(k,"desc")):e.hasClass("l-grid-hd-cell-sort-desc")&&(e.removeClass("l-grid-hd-cell-sort-desc").addClass("l-grid-hd-cell-sort-asc"),f.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc"),c.trigger("ChangeSort",[k,"asc"]),c.changeSort(k,"asc")):(f.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc"),b(a.hcelltext).after("\x3cspan class\x3d'l-grid-hd-cell-sort l-grid-hd-cell-sort-asc'\x3e\x26nbsp;\x26nbsp;\x3c/span\x3e"),c.trigger("ChangeSort",[k,"asc"]),c.changeSort(k,"asc")),b(".l-grid-hd-cell-sort",c.gridheader).add(b(".l-grid-hd-cell-sort",c.f.gridheader)).not(b(".l-grid-hd-cell-sort:first",f)).remove()}else if(a.detailbtn&&e.detail)if(h=a.data,f=b([c.getRowObj(h,!1)]),c.enabledFrozen()&&(f=f.add(c.getRowObj(h,!0))),k=h.__id,b(a.detailbtn).hasClass("l-open")){if(e.detail.onCollapse)e.detail.onCollapse(h,b(".l-grid-detailpanel-inner:first",m)[0]);f.next("tr.l-grid-detailpanel").hide();b(a.detailbtn).removeClass("l-open")}else{var m=f.next("tr.l-grid-detailpanel");if(0<m.length){m.show();if(e.detail.onExtend)e.detail.onExtend(h,b(".l-grid-detailpanel-inner:first",m)[0]);b(a.detailbtn).addClass("l-open")}else{b(a.detailbtn).addClass("l-open");for(m=a=0;m<c.columns.length;m++)c.columns[m].frozen&&a++;var m=b("\x3ctr class\x3d'l-grid-detailpanel'\x3e\x3ctd\x3e\x3cdiv class\x3d'l-grid-detailpanel-inner' style\x3d'display:none'\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e"),n=b("\x3ctr class\x3d'l-grid-detailpanel'\x3e\x3ctd\x3e\x3cdiv class\x3d'l-grid-detailpanel-inner' style\x3d'display:none'\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e");m.find("div:first").width(c.gridheader.find("div:first").width()-50);m.attr("id",c.id+"|detail|"+k);c.detailrows=c.detailrows||[];c.detailrows.push(m[0]);c.detailrows.push(n[0]);k=b("div:first",m);k.parent().attr("colSpan",c.columns.length-a);f.eq(0).after(m);0<a&&(n.find("td:first").attr("colSpan",a),f.eq(1).after(n));e.detail.onShowDetail?(e.detail.onShowDetail(h,k[0],function(){c.trigger("SysGridHeightChanged")}),b("div:first",n).add(k).show().height(e.detail.height||e.detailHeight)):e.detail.render&&(k.append(e.detail.render()),k.show())}c.trigger("SysGridHeightChanged")}else if(a.groupbtn){f=b(a.grouprow);e=!0;b(a.groupbtn).hasClass("l-grid-group-togglebtn-close")?(b(a.groupbtn).removeClass("l-grid-group-togglebtn-close"),f.hasClass("l-grid-grouprow-last")&&b("td:first",f).width("auto")):(e=!1,b(a.groupbtn).addClass("l-grid-group-togglebtn-close"),f.hasClass("l-grid-grouprow-last")&&b("td:first",f).width(c.gridtablewidth));for(a=f.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");0!=a.length;)e?(a.show(),a.hasClass("l-grid-detailpanel")&&!a.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")&&a.hide()):a.hide(),a=a.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");c.trigger(e?"groupExtend":"groupCollapse");c.trigger("SysGridHeightChanged")}else if(a.treelink)c.toggle(a.data);else if(a.row&&c.enabledCheckbox()){f=e.selectRowButtonOnly?!0:!1;e.enabledEdit&&(f=!0);if(a.checkbox||!f){f=b(a.row);h=f.hasClass("l-selected");if(!1==c.trigger("beforeCheckRow",[!h,a.data,a.data.__id,a.row]))return!1;f=h?"unselect":"select";c[f](a.data);if(e.tree&&e.autoCheckChildren)for(k=c.getChildren(a.data,!0),m=0,n=k.length;m<n;m++)c[f](k[m]);c.trigger("checkRow",[!h,a.data,a.data.__id,a.row])}!a.checkbox&&a.cell&&e.enabledEdit&&e.clickToEdit&&c._applyEditor(a.cell)}else if(a.row&&!c.enabledCheckbox())a.cell&&e.enabledEdit&&e.clickToEdit&&c._applyEditor(a.cell),b(a.row).hasClass("l-selected")?e.allowUnSelectRow?c.unselect(a.data):b(a.row).addClass("l-selected-again"):c.select(a.data);else if(a.toolbar)if(a.first){if(!1==c.trigger("toFirst",[c.element]))return!1;c.changePage("first")}else if(a.prev){if(!1==c.trigger("toPrev",[c.element]))return!1;c.changePage("prev")}else if(a.next){if(!1==c.trigger("toNext",[c.element]))return!1;c.changePage("next")}else if(a.last){if(!1==c.trigger("toLast",[c.element]))return!1;c.changePage("last")}else if(a.load){if(b("span",a.load).hasClass("l-disabled")||!1==c.trigger("reload",[c.element])||e.url&&c.isDataChanged&&!confirm(e.isContinueByDataChanged))return!1;c.loadData(e.where)}},select:function(a){a=this.getRow(a);var c=a.__id,e=this.getRowObj(c),f=this.getRowObj(c,!0);if(!this.enabledCheckbox()&&!this.ctrlKey){for(var h in this.selected){var k=this.selected[h];k.__id in this.records&&(b(this.getRowObj(k)).removeClass("l-selected l-selected-again"),this.enabledFrozen()&&b(this.getRowObj(k,!0)).removeClass("l-selected l-selected-again"))}this.selected=[]}e&&b(e).addClass("l-selected");f&&b(f).addClass("l-selected");this.selected[this.selected.length]=a;this.trigger("selectRow",[a,c,e])},unselect:function(a){a=this.getRow(a);var c=a.__id,e=this.getRowObj(c),f=this.getRowObj(c,!0);b(e).removeClass("l-selected l-selected-again");this.enabledFrozen()&&b(f).removeClass("l-selected l-selected-again");this._removeSelected(a);this.trigger("unSelectRow",[a,c,e])},isSelected:function(a){a=this.getRow(a);for(var b in this.selected)if(this.selected[b]==a)return!0;return!1},arrayToTree:function(a,b,c){function f(a){"string"==typeof a&&(a=a.replace(/[.]/g,"").toLowerCase());return a}var h=this.options,k="children";h.tree&&(k=h.tree.childrenName);if(!a||!a.length)return[];for(var h=[],m={},n=a.length,q=0;q<n;q++){var r=a[q],s=f(r[b]);m[s]=r}for(q=0;q<n;q++)b=a[q],s=f(b[c]),(s=m[s])?(s[k]=s[k]||[],s[k].push(b)):h.push(b);return h},_onResize:function(){var a=this.options;if(a.height&&"auto"!=a.height){var c=b(window).height(),e=0,e=null;if("string"==typeof a.height&&0<a.height.indexOf("%")){var f=this.grid.parent();a.inWindow?(e=c-parseInt(b("body").css("paddingTop")),e-=parseInt(b("body").css("paddingBottom"))):e=f.height();e=0.01*e*parseInt(a.height);if(a.inWindow||"body"==f[0].tagName.toLowerCase())e-=this.grid.offset().top-parseInt(b("body").css("paddingTop"))}else e=parseInt(a.height);e+=a.heightDiff;this.windowHeight=c;this._setHeight(e)}else this._updateHorizontalScrollStatus.ligerDefer(this,10);this.enabledFrozen()&&(a=this.gridview1.width(),c=this.gridview.width(),this.gridview2.css({width:c-a}));this.trigger("SysGridHeightChanged")}});b.ligerui.controls.Grid.prototype.enabledTotal=b.ligerui.controls.Grid.prototype.isTotalSummary;b.ligerui.controls.Grid.prototype.add=b.ligerui.controls.Grid.prototype.addRow;b.ligerui.controls.Grid.prototype.update=b.ligerui.controls.Grid.prototype.updateRow;b.ligerui.controls.Grid.prototype.append=b.ligerui.controls.Grid.prototype.appendRow;b.ligerui.controls.Grid.prototype.getSelected=b.ligerui.controls.Grid.prototype.getSelectedRow;b.ligerui.controls.Grid.prototype.getSelecteds=b.ligerui.controls.Grid.prototype.getSelectedRows;b.ligerui.controls.Grid.prototype.getCheckedRows=b.ligerui.controls.Grid.prototype.getSelectedRows;b.ligerui.controls.Grid.prototype.getCheckedRowObjs=b.ligerui.controls.Grid.prototype.getSelectedRowObjs;b.ligerui.controls.Grid.prototype.setOptions=b.ligerui.controls.Grid.prototype.set;b.ligerui.controls.Grid.prototype.reload=b.ligerui.controls.Grid.prototype.loadData;b.ligerui.controls.Grid.prototype.refreshSize=b.ligerui.controls.Grid.prototype._onResize})(jQuery);(function(b){b.fn.ligerLayout=function(a){return b.ligerui.run.call(this,"ligerLayout",arguments)};b.fn.ligerGetLayoutManager=function(){return b.ligerui.run.call(this,"ligerGetLayoutManager",arguments)};b.ligerDefaults.Layout={topHeight:50,bottomHeight:50,leftWidth:110,centerWidth:300,rightWidth:170,InWindow:!0,heightDiff:0,height:"100%",onHeightChanged:null,isLeftCollapse:!1,isRightCollapse:!1,allowLeftCollapse:!0,allowRightCollapse:!0,allowLeftResize:!0,allowRightResize:!0,allowTopResize:!0,allowBottomResize:!0,space:3,onEndResize:null,minLeftWidth:80,minRightWidth:80};b.ligerMethos.Layout={};b.ligerui.controls.Layout=function(a,c){b.ligerui.controls.Layout.base.constructor.call(this,a,c)};b.ligerui.controls.Layout.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Layout"},__idPrev:function(){return"Layout"},_extendMethods:function(){return b.ligerMethos.Layout},_render:function(){var a=this,c=this.options;a.layout=b(this.element);a.layout.addClass("l-layout");a.width=a.layout.width();0<b("\x3e div[position\x3dtop]",a.layout).length&&(a.top=b("\x3e div[position\x3dtop]",a.layout).wrap('\x3cdiv class\x3d"l-layout-top" style\x3d"top:0px;"\x3e\x3c/div\x3e').parent(),a.top.content=b("\x3e div[position\x3dtop]",a.top),a.top.content.hasClass("l-layout-content")||a.top.content.addClass("l-layout-content"),a.topHeight=c.topHeight,a.topHeight&&a.top.height(a.topHeight));if(0<b("\x3e div[position\x3dbottom]",a.layout).length){a.bottom=b("\x3e div[position\x3dbottom]",a.layout).wrap('\x3cdiv class\x3d"l-layout-bottom"\x3e\x3c/div\x3e').parent();a.bottom.content=b("\x3e div[position\x3dbottom]",a.bottom);a.bottom.content.hasClass("l-layout-content")||a.bottom.content.addClass("l-layout-content");a.bottomHeight=c.bottomHeight;a.bottomHeight&&a.bottom.height(a.bottomHeight);var d=a.bottom.content.attr("title");d&&(a.bottom.header=b('\x3cdiv class\x3d"l-layout-header"\x3e\x3c/div\x3e'),a.bottom.prepend(a.bottom.header),a.bottom.header.html(d),a.bottom.content.attr("title",""))}if(0<b("\x3e div[position\x3dleft]",a.layout).length){a.left=b("\x3e div[position\x3dleft]",a.layout).wrap('\x3cdiv class\x3d"l-layout-left" style\x3d"left:0px;"\x3e\x3c/div\x3e').parent();a.left.header=b('\x3cdiv class\x3d"l-layout-header"\x3e\x3cdiv class\x3d"l-layout-header-toggle"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-layout-header-inner"\x3e\x3c/div\x3e\x3c/div\x3e');a.left.prepend(a.left.header);a.left.header.toggle=b(".l-layout-header-toggle",a.left.header);a.left.content=b("\x3e div[position\x3dleft]",a.left);a.left.content.hasClass("l-layout-content")||a.left.content.addClass("l-layout-content");c.allowLeftCollapse||b(".l-layout-header-toggle",a.left.header).remove();if(d=a.left.content.attr("title"))a.left.content.attr("title",""),b(".l-layout-header-inner",a.left.header).html(d);a.leftWidth=c.leftWidth;a.leftWidth&&a.left.width(a.leftWidth)}if(0<b("\x3e div[position\x3dcenter]",a.layout).length){a.center=b("\x3e div[position\x3dcenter]",a.layout).wrap('\x3cdiv class\x3d"l-layout-center" \x3e\x3c/div\x3e').parent();a.center.content=b("\x3e div[position\x3dcenter]",a.center);a.center.content.addClass("l-layout-content");if(d=a.center.content.attr("title"))a.center.content.attr("title",""),a.center.header=b('\x3cdiv class\x3d"l-layout-header"\x3e\x3c/div\x3e'),a.center.prepend(a.center.header),a.center.header.html(d);a.centerWidth=c.centerWidth;a.centerWidth&&a.center.width(a.centerWidth)}if(0<b("\x3e div[position\x3dright]",a.layout).length){a.right=b("\x3e div[position\x3dright]",a.layout).wrap('\x3cdiv class\x3d"l-layout-right"\x3e\x3c/div\x3e').parent();a.right.header=b('\x3cdiv class\x3d"l-layout-header"\x3e\x3cdiv class\x3d"l-layout-header-toggle"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-layout-header-inner"\x3e\x3c/div\x3e\x3c/div\x3e');a.right.prepend(a.right.header);a.right.header.toggle=b(".l-layout-header-toggle",a.right.header);c.allowRightCollapse||b(".l-layout-header-toggle",a.right.header).remove();a.right.content=b("\x3e div[position\x3dright]",a.right);a.right.content.hasClass("l-layout-content")||a.right.content.addClass("l-layout-content");if(d=a.right.content.attr("title"))a.right.content.attr("title",""),b(".l-layout-header-inner",a.right.header).html(d);a.rightWidth=c.rightWidth;a.rightWidth&&a.right.width(a.rightWidth)}a.layout.lock=b("\x3cdiv class\x3d'l-layout-lock'\x3e\x3c/div\x3e");a.layout.append(a.layout.lock);a._addDropHandle();a.isLeftCollapse=c.isLeftCollapse;a.isRightCollapse=c.isRightCollapse;a.leftCollapse=b('\x3cdiv class\x3d"l-layout-collapse-left" style\x3d"display: none; "\x3e\x3cdiv class\x3d"l-layout-collapse-left-toggle"\x3e\x3c/div\x3e\x3c/div\x3e');a.rightCollapse=b('\x3cdiv class\x3d"l-layout-collapse-right" style\x3d"display: none; "\x3e\x3cdiv class\x3d"l-layout-collapse-right-toggle"\x3e\x3c/div\x3e\x3c/div\x3e');a.layout.append(a.leftCollapse).append(a.rightCollapse);a.leftCollapse.toggle=b("\x3e .l-layout-collapse-left-toggle",a.leftCollapse);a.rightCollapse.toggle=b("\x3e .l-layout-collapse-right-toggle",a.rightCollapse);a._setCollapse();a._bulid();b(window).resize(function(){a._onResize()});a.set(c);a.mask.height(a.layout.height())},setLeftCollapse:function(a){if(!this.left)return!1;(this.isLeftCollapse=a)?(this.leftCollapse.show(),this.leftDropHandle&&this.leftDropHandle.hide(),this.left.hide()):(this.leftCollapse.hide(),this.leftDropHandle&&this.leftDropHandle.show(),this.left.show());this._onResize()},setRightCollapse:function(a){if(!this.right)return!1;this.isRightCollapse=a;this._onResize();this.isRightCollapse?(this.rightCollapse.show(),this.rightDropHandle&&this.rightDropHandle.hide(),this.right.hide()):(this.rightCollapse.hide(),this.rightDropHandle&&this.rightDropHandle.show(),this.right.show());this._onResize()},_bulid:function(){var a=this,c=this.options;b("\x3e .l-layout-left .l-layout-header,\x3e .l-layout-right .l-layout-header",a.layout).hover(function(){b(this).addClass("l-layout-header-over")},function(){b(this).removeClass("l-layout-header-over")});b(".l-layout-header-toggle",a.layout).hover(function(){b(this).addClass("l-layout-header-toggle-over")},function(){b(this).removeClass("l-layout-header-toggle-over")});b(".l-layout-header-toggle",a.left).click(function(){a.setLeftCollapse(!0)});b(".l-layout-header-toggle",a.right).click(function(){a.setRightCollapse(!0)});a.middleTop=0;a.top&&(a.middleTop+=a.top.height(),a.middleTop+=parseInt(a.top.css("borderTopWidth")),a.middleTop+=parseInt(a.top.css("borderBottomWidth")),a.middleTop+=c.space);a.left&&(a.left.css({top:a.middleTop}),a.leftCollapse.css({top:a.middleTop}));a.center&&a.center.css({top:a.middleTop});a.right&&(a.right.css({top:a.middleTop}),a.rightCollapse.css({top:a.middleTop}));a.left&&a.left.css({left:0});a._onResize();a._onResize()},_setCollapse:function(){var a=this;a.leftCollapse.hover(function(){b(this).addClass("l-layout-collapse-left-over")},function(){b(this).removeClass("l-layout-collapse-left-over")});a.leftCollapse.toggle.hover(function(){b(this).addClass("l-layout-collapse-left-toggle-over")},function(){b(this).removeClass("l-layout-collapse-left-toggle-over")});a.rightCollapse.hover(function(){b(this).addClass("l-layout-collapse-right-over")},function(){b(this).removeClass("l-layout-collapse-right-over")});a.rightCollapse.toggle.hover(function(){b(this).addClass("l-layout-collapse-right-toggle-over")},function(){b(this).removeClass("l-layout-collapse-right-toggle-over")});a.leftCollapse.toggle.click(function(){a.setLeftCollapse(!1)});a.rightCollapse.toggle.click(function(){a.setRightCollapse(!1)});a.left&&a.isLeftCollapse&&(a.leftCollapse.show(),a.leftDropHandle&&a.leftDropHandle.hide(),a.left.hide());a.right&&a.isRightCollapse&&(a.rightCollapse.show(),a.rightDropHandle&&a.rightDropHandle.hide(),a.right.hide())},_addDropHandle:function(){var a=this,c=this.options;a.left&&c.allowLeftResize&&(a.leftDropHandle=b("\x3cdiv class\x3d'l-layout-drophandle-left'\x3e\x3c/div\x3e"),a.layout.append(a.leftDropHandle),a.leftDropHandle&&a.leftDropHandle.show(),a.leftDropHandle.mousedown(function(b){a._start("leftresize",b)}));a.right&&c.allowRightResize&&(a.rightDropHandle=b("\x3cdiv class\x3d'l-layout-drophandle-right'\x3e\x3c/div\x3e"),a.layout.append(a.rightDropHandle),a.rightDropHandle&&a.rightDropHandle.show(),a.rightDropHandle.mousedown(function(b){a._start("rightresize",b)}));a.top&&c.allowTopResize&&(a.topDropHandle=b("\x3cdiv class\x3d'l-layout-drophandle-top'\x3e\x3c/div\x3e"),a.layout.append(a.topDropHandle),a.topDropHandle.show(),a.topDropHandle.mousedown(function(b){a._start("topresize",b)}));a.bottom&&c.allowBottomResize&&(a.bottomDropHandle=b("\x3cdiv class\x3d'l-layout-drophandle-bottom'\x3e\x3c/div\x3e"),a.layout.append(a.bottomDropHandle),a.bottomDropHandle.show(),a.bottomDropHandle.mousedown(function(b){a._start("bottomresize",b)}));a.draggingxline=b("\x3cdiv class\x3d'l-layout-dragging-xline'\x3e\x3c/div\x3e");a.draggingyline=b("\x3cdiv class\x3d'l-layout-dragging-yline'\x3e\x3c/div\x3e");a.mask=b("\x3cdiv class\x3d'l-dragging-mask'\x3e\x3c/div\x3e");a.layout.append(a.draggingxline).append(a.draggingyline).append(a.mask)},_setDropHandlePosition:function(){var a=this.options;this.leftDropHandle&&this.leftDropHandle.css({left:this.left.width()+parseInt(this.left.css("left")),height:this.middleHeight,top:this.middleTop});this.rightDropHandle&&this.rightDropHandle.css({left:parseInt(this.right.css("left"))-a.space,height:this.middleHeight,top:this.middleTop});this.topDropHandle&&this.topDropHandle.css({top:this.top.height()+parseInt(this.top.css("top")),width:this.top.width()});this.bottomDropHandle&&this.bottomDropHandle.css({top:parseInt(this.bottom.css("top"))-a.space,width:this.bottom.width()})},_onResize:function(){var a=this.options,c=this.layout.height(),d=0,d=b(window).height(),g=null;if("string"==typeof a.height&&0<a.height.indexOf("%")){var e=this.layout.parent();a.InWindow||"body"==e[0].tagName.toLowerCase()?(g=d-parseInt(b("body").css("paddingTop")),g-=parseInt(b("body").css("paddingBottom"))):g=e.height();d=0.01*g*parseFloat(a.height);if(a.InWindow||"body"==e[0].tagName.toLowerCase())d-=this.layout.offset().top-parseInt(b("body").css("paddingTop"))}else d=parseInt(a.height);d+=a.heightDiff;this.layout.height(d);this.layoutHeight=this.layout.height();this.middleWidth=this.layout.width();this.middleHeight=this.layout.height();this.top&&(this.middleHeight-=this.top.height(),this.middleHeight-=parseInt(this.top.css("borderTopWidth")),this.middleHeight-=parseInt(this.top.css("borderBottomWidth")),this.middleHeight-=a.space);this.bottom&&(this.middleHeight-=this.bottom.height(),this.middleHeight-=parseInt(this.bottom.css("borderTopWidth")),this.middleHeight-=parseInt(this.bottom.css("borderBottomWidth")),this.middleHeight-=a.space);this.middleHeight-=2;this.hasBind("heightChanged")&&this.layoutHeight!=c&&this.trigger("heightChanged",[{layoutHeight:this.layoutHeight,diff:this.layoutHeight-c,middleHeight:this.middleHeight}]);this.center&&(this.centerWidth=this.middleWidth,this.left&&(this.isLeftCollapse?(this.centerWidth-=this.leftCollapse.width(),this.centerWidth-=parseInt(this.leftCollapse.css("borderLeftWidth")),this.centerWidth-=parseInt(this.leftCollapse.css("borderRightWidth")),this.centerWidth-=parseInt(this.leftCollapse.css("left"))):(this.centerWidth-=this.leftWidth,this.centerWidth-=parseInt(this.left.css("borderLeftWidth")),this.centerWidth-=parseInt(this.left.css("borderRightWidth")),this.centerWidth-=parseInt(this.left.css("left"))),this.centerWidth-=a.space),this.right&&(this.isRightCollapse?(this.centerWidth-=this.rightCollapse.width(),this.centerWidth-=parseInt(this.rightCollapse.css("borderLeftWidth")),this.centerWidth-=parseInt(this.rightCollapse.css("borderRightWidth")),this.centerWidth-=parseInt(this.rightCollapse.css("right"))):(this.centerWidth-=this.rightWidth,this.centerWidth-=parseInt(this.right.css("borderLeftWidth")),this.centerWidth-=parseInt(this.right.css("borderRightWidth"))),this.centerWidth-=a.space),this.centerLeft=0,this.left&&(this.isLeftCollapse?(this.centerLeft+=this.leftCollapse.width(),this.centerLeft+=parseInt(this.leftCollapse.css("borderLeftWidth")),this.centerLeft+=parseInt(this.leftCollapse.css("borderRightWidth")),this.centerLeft+=parseInt(this.leftCollapse.css("left"))):(this.centerLeft+=this.left.width(),this.centerLeft+=parseInt(this.left.css("borderLeftWidth")),this.centerLeft+=parseInt(this.left.css("borderRightWidth"))),this.centerLeft+=a.space),this.center.css({left:this.centerLeft}),this.center.width(this.centerWidth),this.center.height(this.middleHeight),c=this.middleHeight,this.center.header&&(c-=this.center.header.height()),this.center.content.height(c));this.left&&(this.leftCollapse.height(this.middleHeight),this.left.height(this.middleHeight));this.right&&(this.rightCollapse.height(this.middleHeight),this.right.height(this.middleHeight),this.rightLeft=0,this.left&&(this.isLeftCollapse?(this.rightLeft+=this.leftCollapse.width(),this.rightLeft+=parseInt(this.leftCollapse.css("borderLeftWidth")),this.rightLeft+=parseInt(this.leftCollapse.css("borderRightWidth"))):(this.rightLeft+=this.left.width(),this.rightLeft+=parseInt(this.left.css("borderLeftWidth")),this.rightLeft+=parseInt(this.left.css("borderRightWidth")),this.rightLeft+=parseInt(this.left.css("left"))),this.rightLeft+=a.space),this.center&&(this.rightLeft+=this.center.width(),this.rightLeft+=parseInt(this.center.css("borderLeftWidth")),this.rightLeft+=parseInt(this.center.css("borderRightWidth")),this.rightLeft+=a.space),this.right.css({left:this.rightLeft}));this.bottom&&(this.bottomTop=this.layoutHeight-this.bottom.height()-2,this.bottom.css({top:this.bottomTop}));this._setDropHandlePosition()},_start:function(a,c){var d=this;d.dragtype=a;if("leftresize"==a||"rightresize"==a)d.xresize={startX:c.pageX},d.draggingyline.css({left:c.pageX-d.layout.offset().left,height:d.middleHeight,top:d.middleTop}).show(),b("body").css("cursor","col-resize"),d.mask.height(d.layout.height()).removeClass("l-layout-ymask").addClass("l-layout-xmask").show();else if("topresize"==a||"bottomresize"==a)d.yresize={startY:c.pageY},d.draggingxline.css({top:c.pageY-d.layout.offset().top,width:d.layout.width()}).show(),b("body").css("cursor","row-resize"),d.mask.height(d.layout.height()).removeClass("l-layout-xmask").addClass("l-layout-ymask").show();else return;d.layout.lock.width(d.layout.width());d.layout.lock.height(d.layout.height());d.layout.lock.show();(b.browser.msie||b.browser.safari)&&b("body").bind("selectstart",function(){return!1});b(document).bind("mouseup",function(){d._stop.apply(d,arguments)});b(document).bind("mousemove",function(){d._drag.apply(d,arguments)})},_drag:function(a){this.xresize?(this.xresize.diff=a.pageX-this.xresize.startX,this.draggingyline.css({left:a.pageX-this.layout.offset().left}),b("body").css("cursor","col-resize")):this.yresize&&(this.yresize.diff=a.pageY-this.yresize.startY,this.draggingxline.css({top:a.pageY-this.layout.offset().top}),b("body").css("cursor","row-resize"))},_stop:function(a){var c=this.options,d;if(this.xresize&&void 0!=this.xresize.diff)if(d=this.xresize.diff,"leftresize"==this.dragtype){if(c.minLeftWidth&&this.leftWidth+this.xresize.diff<c.minLeftWidth)return;this.leftWidth+=this.xresize.diff;this.left.width(this.leftWidth);this.center?this.center.width(this.center.width()-this.xresize.diff).css({left:parseInt(this.center.css("left"))+this.xresize.diff}):this.right&&this.right.width(this.left.width()-this.xresize.diff).css({left:parseInt(this.right.css("left"))+this.xresize.diff})}else{if("rightresize"==this.dragtype){if(c.minRightWidth&&this.rightWidth-this.xresize.diff<c.minRightWidth)return;this.rightWidth-=this.xresize.diff;this.right.width(this.rightWidth).css({left:parseInt(this.right.css("left"))+this.xresize.diff});this.center?this.center.width(this.center.width()+this.xresize.diff):this.left&&this.left.width(this.left.width()+this.xresize.diff)}}else this.yresize&&void 0!=this.yresize.diff&&(d=this.yresize.diff,"topresize"==this.dragtype?(this.top.height(this.top.height()+this.yresize.diff),this.middleTop+=this.yresize.diff,this.middleHeight-=this.yresize.diff,this.left&&(this.left.css({top:this.middleTop}).height(this.middleHeight),this.leftCollapse.css({top:this.middleTop}).height(this.middleHeight)),this.center&&this.center.css({top:this.middleTop}).height(this.middleHeight),this.right&&(this.right.css({top:this.middleTop}).height(this.middleHeight),this.rightCollapse.css({top:this.middleTop}).height(this.middleHeight))):"bottomresize"==this.dragtype&&(this.bottom.height(this.bottom.height()-this.yresize.diff),this.middleHeight+=this.yresize.diff,this.bottomTop+=this.yresize.diff,this.bottom.css({top:this.bottomTop}),this.left&&(this.left.height(this.middleHeight),this.leftCollapse.height(this.middleHeight)),this.center&&this.center.height(this.middleHeight),this.right&&(this.right.height(this.middleHeight),this.rightCollapse.height(this.middleHeight))));this.trigger("endResize",[{direction:this.dragtype?this.dragtype.replace(/resize/,""):"",diff:d},a]);this._setDropHandlePosition();this.draggingxline.hide();this.draggingyline.hide();this.mask.hide();this.xresize=this.yresize=this.dragtype=!1;this.layout.lock.hide();(b.browser.msie||b.browser.safari)&&b("body").unbind("selectstart");b(document).unbind("mousemove",this._drag);b(document).unbind("mouseup",this._stop);b("body").css("cursor","")}})})(jQuery);(function(b){b.fn.ligerListBox=function(a){return b.ligerui.run.call(this,"ligerListBox",arguments)};b.ligerDefaults.ListBox={isMultiSelect:!1,isShowCheckBox:!1,columns:null,width:150,height:100,onSelect:!1,onSelected:null,valueField:"id",textField:"text",valueFieldID:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,render:null,css:null,value:null,valueFieldCssClass:null};b.ligerMethos.ListBox=b.ligerMethos.ListBox||{};b.ligerui.controls.ListBox=function(a,c){b.ligerui.controls.ListBox.base.constructor.call(this,a,c)};b.ligerui.controls.ListBox.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"ListBox"},_extendMethods:function(){return b.ligerMethos.ListBox},_init:function(){b.ligerui.controls.ListBox.base._init.call(this)},_render:function(){var a=this.options;this.data=a.data;this.valueField=null;a.valueFieldID?(this.valueField=b("#"+a.valueFieldID+":input,[name\x3d"+a.valueFieldID+"]:input"),0==this.valueField.length&&(this.valueField=b('\x3cinput type\x3d"hidden"/\x3e')),this.valueField[0].id=this.valueField[0].name=a.valueFieldID):(this.valueField=b('\x3cinput type\x3d"hidden"/\x3e'),this.valueField[0].id=this.valueField[0].name=this.id+"_val");null==this.valueField[0].name&&(this.valueField[0].name=this.valueField[0].id);a.valueFieldCssClass&&this.valueField.addClass(a.valueFieldCssClass);this.valueField.attr("data-ligerid",this.id);this.selectBox=b(this.element);this.selectBox.html('\x3cdiv class\x3d"l-listbox-inner"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" border\x3d"0" class\x3d"l-listbox-table"\x3e\x3c/table\x3e\x3c/div\x3e').addClass("l-listbox").append(this.valueField);this.selectBox.table=b("table:first",this.selectBox);this.set(a);this._addClickEven()},destroy:function(){this.selectBox&&this.selectBox.remove();this.options=null;b.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setIsShowCheckBox:function(a){a?b("table",this.selectBox).addClass("l-table-checkbox"):b("table",this.selectBox).addClass("l-table-nocheckbox")},_setCss:function(a){a&&this.selectBox.addClass(a)},_setDisabled:function(a){a?this.selectBox.addClass("l-text-disabled"):this.selectBox.removeClass("l-text-disabled")},_setWidth:function(a){this.selectBox.width(a)},_setHeight:function(a){this.selectBox.height(a)},findTextByValue:function(a){var c=this.options;if(null==a)return"";var d="";b(this.data).each(function(b,e){var f=e[c.textField],h;a:{h=e[c.valueField];for(var k=a.toString().split(c.split),m=0;m<k.length;m++)if(k[m]==h){h=!0;break a}h=!1}h&&(d+=f+c.split)});0<d.length&&(d=d.substr(0,d.length-1));return d},getDataByValue:function(a){for(var b=this.options,d=0,g=this.data.length;d<g;d++)if(this.data[d][b.valueField]==a)return this.data[d];return null},indexOf:function(a){var b=this.options;if(!this.data)return-1;for(var d="object"==typeof a,g=0,e=this.data.length;g<e;g++)if(d){if(this.data[g]==a)return g}else if(this.data[g][b.valueField]&&this.data[g][b.valueField].toString()==a.toString())return g;return-1},removeItems:function(a){var c=this;c.data&&(b(a).each(function(a,b){var e=c.indexOf(b);-1!=e&&c.data.splice(e,1)}),c.refresh())},removeItem:function(a){this.data&&(a=this.indexOf(a),-1!=a&&(this.data.splice(a,1),this.refresh()))},insertItem:function(a,b){this.data||(this.data=[]);this.data.splice(b,0,a);this.refresh()},addItems:function(a){var c=this;c.data||(c.data=[]);b(a).each(function(a,b){c.data.push(b)});c.refresh()},addItem:function(a){this.data||(this.data=[]);this.data.push(a);this.refresh()},getSelectedItems:function(){var a=this,c=this.options;if(!a.data)return null;var d=a.getValue();if(!d)return null;var g=[];b(d.split(c.split)).each(function(){var b=a.indexOf(this.toString());-1!=b&&g.push(a.data[b])});return g},_setValue:function(a){this.options.value=a;this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(a){if(a){var c=this;b.ajax({type:"post",url:a,data:this.options.parms,cache:!1,dataType:"json",success:function(a){c.setData(a);c.trigger("success",[a])},error:function(a,b){c.trigger("error",[a,b])}})}},setUrl:function(a){return this._setUrl(a)},setParm:function(a,b){if(a){var d=this.get("parms");d||(d={});d[a]=b;this.set("parms",d)}},clearContent:function(){b("table",this.selectBox).html("")},_setColumns:function(a){this.options.columns=a;this.refresh()},_setData:function(a){this.setData(a)},setData:function(a){a&&a.length&&(this.data=a,this.refresh(),this.updateStyle())},refresh:function(){var a=this.options,c=this.data;this.clearContent();if(c){if(a.columns){this.selectBox.table.headrow=b("\x3ctr class\x3d'l-table-headerow'\x3e\x3ctd width\x3d'18px' class\x3d'l-checkboxrow'\x3e\x3c/td\x3e\x3c/tr\x3e");this.selectBox.table.append(this.selectBox.table.headrow);this.selectBox.table.addClass("l-listbox-grid");for(var d=0;d<a.columns.length;d++){var g=b("\x3ctd columnindex\x3d'"+d+"' columnname\x3d'"+a.columns[d].name+"'\x3e"+a.columns[d].header+"\x3c/td\x3e");a.columns[d].width&&g.width(a.columns[d].width);this.selectBox.table.headrow.append(g)}}for(var g=[],e=0;e<c.length;e++){var d=c[e][a.valueField],f=c[e][a.textField],h=" value\x3d'"+d+"' index\x3d'"+e+"'";if(a.columns){g.push("\x3ctr "+h+"\x3e\x3ctd style\x3d'width:18px;' class\x3d'l-checkboxrow'\x3e\x3cinput type\x3d'checkbox' "+h+"/\x3e\x3c/td\x3e");for(d=0;d<a.columns.length;d++)g.push("\x3ctd\x3e"+c[e][a.columns[d].name]+"\x3c/td\x3e");g.push("\x3c/tr\x3e")}else g.push("\x3ctr "+h+"\x3e"),g.push("\x3ctd style\x3d'width:18px;' class\x3d'l-checkboxrow'\x3e\x3cinput type\x3d'checkbox'"+h+"/\x3e\x3c/td\x3e"),h=f,a.render&&(h=a.render({data:c[e],value:d,text:f})),g.push("\x3ctd align\x3d'left'\x3e"+h+"\x3c/td\x3e\x3c/tr\x3e")}this.selectBox.table.append(g.join(""))}},_getValue:function(){return b(this.valueField).val()},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},selectAll:function(){var a=this.options,c=[];b("tr",this.selectBox).each(function(){var a=b(this);c.push(a.attr("value"))});b("tr",this.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=!0});this.valueField.val(c.join(a.split))},_dataInit:function(){var a=this,c=this.options,d=c.value;null!=d?a._changeValue(d):""!=a.valueField.val()&&(c.value=a.valueField.val());c=(d||"").toString().split(c.split);b("tr.l-selected",a.selectBox).removeClass("l-selected").find(":checkbox").each(function(){this.checked=!1});b(c).each(function(c,d){b("tr[value\x3d'"+d+"']",a.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=!0})})},_changeValue:function(a){this.valueField.val(a);this.selectedValue=a},_updateValue:function(){var a=this.options,c=[];b("tr",this.selectBox).each(function(){var a=b(this);a.hasClass("l-selected")&&c.push(a.attr("value"))});this._changeValue(c.join(a.split))},_addClickEven:function(){var a=this,c=this.options;a.selectBox.click(function(d){var g=b(d.target||d.srcElement).parents("tr:first");if(g.length){d=g.attr("value");var e=a.findTextByValue(d),f=a.getDataByValue(d);if(a.hasBind("select")&&!1==a.trigger("select",[d,e,f]))return!1;c.isMultiSelect||b("tr.l-selected",a.selectBox).not(g).removeClass("l-selected").find(":checkbox").each(function(){this.checked=!1});g.hasClass("l-selected")?g.removeClass("l-selected"):g.addClass("l-selected");g.find(":checkbox").each(function(){this.checked=g.hasClass("l-selected")});a._updateValue();a.trigger("selected",[d,e,f])}})}})})(jQuery);(function(b){b.ligerMenu=function(a){return b.ligerui.run.call(null,"ligerMenu",arguments)};b.ligerDefaults.Menu={width:120,top:0,left:0,items:null,shadow:!0};b.ligerMethos.Menu={};b.ligerui.controls.Menu=function(a){b.ligerui.controls.Menu.base.constructor.call(this,null,a)};b.ligerui.controls.Menu.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Menu"},__idPrev:function(){return"Menu"},_extendMethods:function(){return b.ligerMethos.Menu},_render:function(){var a=this,c=this.options;a.menuItemCount=0;a.menus={};a.menu=a.createMenu();a.element=a.menu[0];a.menu.css({top:c.top,left:c.left,width:c.width});c.items&&b(c.items).each(function(b,c){a.addItem(c)});b(document).bind("click.menu",function(){for(var b in a.menus){var c=a.menus[b];if(!c)break;c.hide();c.shadow&&c.shadow.hide()}});a.set(c)},show:function(a,b){void 0==b&&(b=this.menu);a&&void 0!=a.left&&b.css({left:a.left});a&&void 0!=a.top&&b.css({top:a.top});b.show();this.updateShadow(b)},updateShadow:function(a){this.options.shadow&&(a.shadow.css({left:a.css("left"),top:a.css("top"),width:a.outerWidth(),height:a.outerHeight()}),a.is(":visible")?a.shadow.show():a.shadow.hide())},hide:function(a){void 0==a&&(a=this.menu);this.hideAllSubMenu(a);a.hide();this.updateShadow(a)},toggle:function(){this.menu.toggle();this.updateShadow(this.menu)},removeItem:function(a){b("\x3e .l-menu-item[menuitemid\x3d"+a+"]",this.menu.items).remove()},setEnabled:function(a){b("\x3e .l-menu-item[menuitemid\x3d"+a+"]",this.menu.items).removeClass("l-menu-item-disable")},setDisabled:function(a){b("\x3e .l-menu-item[menuitemid\x3d"+a+"]",this.menu.items).addClass("l-menu-item-disable")},isEnable:function(a){return!b("\x3e .l-menu-item[menuitemid\x3d"+a+"]",this.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){return b("\x3e .l-menu-item",this.menu.items).length},addItem:function(a,c){var d=this,g=this.options;if(a)if(void 0==c&&(c=d.menu),a.line)c.items.append('\x3cdiv class\x3d"l-menu-item-line"\x3e\x3c/div\x3e');else{var e=b('\x3cdiv class\x3d"l-menu-item"\x3e\x3cdiv class\x3d"l-menu-item-text"\x3e\x3c/div\x3e \x3c/div\x3e'),f=b("\x3e .l-menu-item",c.items).length;c.items.append(e);e.attr("ligeruimenutemid",++d.menuItemCount);a.id&&e.attr("menuitemid",a.id);a.text&&b("\x3e.l-menu-item-text:first",e).html(a.text);a.icon&&e.prepend('\x3cdiv class\x3d"l-menu-item-icon l-icon-'+a.icon+'"\x3e\x3c/div\x3e');a.img&&e.prepend('\x3cdiv class\x3d"l-menu-item-icon"\x3e\x3cimg style\x3d"width:16px;height:16px;margin:2px;" src\x3d"'+a.img+'" /\x3e\x3c/div\x3e');(a.disable||a.disabled)&&e.addClass("l-menu-item-disable");if(a.children){e.append('\x3cdiv class\x3d"l-menu-item-arrow"\x3e\x3c/div\x3e');var h=d.createMenu(e.attr("ligeruimenutemid"));d.menus[e.attr("ligeruimenutemid")]=h;h.width(g.width);h.hover(null,function(){h.showedSubMenu||d.hide(h)});b(a.children).each(function(){d.addItem(this,h)})}a.click&&e.click(function(){b(this).hasClass("l-menu-item-disable")||a.click(a,f)});a.dblclick&&e.dblclick(function(){b(this).hasClass("l-menu-item-disable")||a.dblclick(a,f)});var k=b("\x3e .l-menu-over:first",c);e.hover(function(){if(!b(this).hasClass("l-menu-item-disable")){var e=b(this).offset().top,f=e-c.offset().top;k.css({top:f});d.hideAllSubMenu(c);a.children&&(f=b(this).attr("ligeruimenutemid"))&&d.menus[f]&&(d.show({top:e,left:b(this).offset().left+b(this).width()-5},d.menus[f]),c.showedSubMenu=!0)}},function(){b(this).hasClass("l-menu-item-disable")||(b(this).attr("ligeruimenutemid"),a.children&&b(this).attr("ligeruimenutemid"))})}},hideAllSubMenu:function(a){var c=this;void 0==a&&(a=c.menu);b("\x3e .l-menu-item",a.items).each(function(){if(0<b("\x3e .l-menu-item-arrow",this).length){var a=b(this).attr("ligeruimenutemid");a&&c.menus[a]&&c.hide(c.menus[a])}});a.showedSubMenu=!1},createMenu:function(a){var c=this.options,d=b('\x3cdiv class\x3d"l-menu" style\x3d"display:none"\x3e\x3cdiv class\x3d"l-menu-yline"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-menu-over"\x3e\x3cdiv class\x3d"l-menu-over-l"\x3e\x3c/div\x3e \x3cdiv class\x3d"l-menu-over-r"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"l-menu-inner"\x3e\x3c/div\x3e\x3c/div\x3e');a&&d.attr("ligeruiparentmenuitemid",a);d.items=b("\x3e .l-menu-inner:first",d);d.appendTo("body");c.shadow&&(d.shadow=b('\x3cdiv class\x3d"l-menu-shadow"\x3e\x3c/div\x3e').insertAfter(d),this.updateShadow(d));d.hover(null,function(){d.showedSubMenu||b("\x3e .l-menu-over:first",d).css({top:-24})});a?this.menus[a]=d:this.menus[0]=d;return d}});b.ligerui.controls.Menu.prototype.setEnable=b.ligerui.controls.Menu.prototype.setEnabled;b.ligerui.controls.Menu.prototype.setDisable=b.ligerui.controls.Menu.prototype.setDisabled})(jQuery);(function(b){b.fn.ligerMenuBar=function(a){return b.ligerui.run.call(this,"ligerMenuBar",arguments)};b.fn.ligerGetMenuBarManager=function(){return b.ligerui.run.call(this,"ligerGetMenuBarManager",arguments)};b.ligerDefaults.MenuBar={};b.ligerMethos.MenuBar={};b.ligerui.controls.MenuBar=function(a,c){b.ligerui.controls.MenuBar.base.constructor.call(this,a,c)};b.ligerui.controls.MenuBar.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"MenuBar"},__idPrev:function(){return"MenuBar"},_extendMethods:function(){return b.ligerMethos.MenuBar},_render:function(){var a=this,c=this.options;a.menubar=b(this.element);a.menubar.hasClass("l-menubar")||a.menubar.addClass("l-menubar");c&&c.items&&b(c.items).each(function(b,c){a.addItem(c)});b(document).click(function(){b(".l-panel-btn-selected",a.menubar).removeClass("l-panel-btn-selected")});a.set(c)},addItem:function(a){var c=this,d=b('\x3cdiv class\x3d"l-menubar-item l-panel-btn"\x3e\x3cspan\x3e\x3c/span\x3e\x3cdiv class\x3d"l-panel-btn-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-panel-btn-r"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-menubar-item-down"\x3e\x3c/div\x3e\x3c/div\x3e');c.menubar.append(d);a.id&&d.attr("menubarid",a.id);a.text&&b("span:first",d).html(a.text);a.disable&&d.addClass("l-menubar-item-disable");a.click&&d.click(function(){a.click(a)});if(a.menu){var g=b.ligerMenu(a.menu);d.hover(function(){c.actionMenu&&c.actionMenu.hide();var a=b(this).offset().left,d=b(this).offset().top+b(this).height();g.show({top:d,left:a});c.actionMenu=g;b(this).addClass("l-panel-btn-over l-panel-btn-selected").siblings(".l-menubar-item").removeClass("l-panel-btn-selected")},function(){b(this).removeClass("l-panel-btn-over")})}else d.hover(function(){b(this).addClass("l-panel-btn-over")},function(){b(this).removeClass("l-panel-btn-over")}),b(".l-menubar-item-down",d).remove()}})})(jQuery);(function(b){b.ligerMessageBox=function(a){return b.ligerui.run.call(null,"ligerMessageBox",arguments,{isStatic:!0})};b.ligerDefaults.MessageBox={isDrag:!0};b.ligerMethos.MessageBox={};b.ligerui.controls.MessageBox=function(a){b.ligerui.controls.MessageBox.base.constructor.call(this,null,a)};b.ligerui.controls.MessageBox.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"MessageBox"},__idPrev:function(){return"MessageBox"},_extendMethods:function(){return b.ligerMethos.MessageBox},_render:function(){var a=this,c=this.options,d;d='\x3cdiv class\x3d"l-messagebox"\x3e        \x3cdiv class\x3d"l-messagebox-lt"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-messagebox-rt"\x3e\x3c/div\x3e';d+='        \x3cdiv class\x3d"l-messagebox-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-messagebox-r"\x3e\x3c/div\x3e ';d+='        \x3cdiv class\x3d"l-messagebox-image"\x3e\x3c/div\x3e';d+='        \x3cdiv class\x3d"l-messagebox-title"\x3e';d+='            \x3cdiv class\x3d"l-messagebox-title-inner"\x3e\x3c/div\x3e';d+='            \x3cdiv class\x3d"l-messagebox-close"\x3e\x3c/div\x3e';d+="        \x3c/div\x3e";d+='        \x3cdiv class\x3d"l-messagebox-content"\x3e';d+="        \x3c/div\x3e";d+='        \x3cdiv class\x3d"l-messagebox-buttons"\x3e\x3cdiv class\x3d"l-messagebox-buttons-inner"\x3e';d+="        \x3c/div\x3e\x3c/div\x3e";d+="    \x3c/div\x3e";a.messageBox=b(d);b("body").append(a.messageBox);a.messageBox.close=function(){a._removeWindowMask();a.messageBox.remove()};c.width&&a.messageBox.width(c.width);c.title&&b(".l-messagebox-title-inner",a.messageBox).html(c.title);c.content&&b(".l-messagebox-content",a.messageBox).html(c.content);c.buttons&&(b(c.buttons).each(function(c,d){var e=b('\x3cdiv class\x3d"l-messagebox-btn"\x3e\x3cdiv class\x3d"l-messagebox-btn-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-messagebox-btn-r"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-messagebox-btn-inner"\x3e\x3c/div\x3e\x3c/div\x3e');b(".l-messagebox-btn-inner",e).html(d.text);b(".l-messagebox-buttons-inner",a.messageBox).append(e);d.width&&e.width(d.width);d.onclick&&e.click(function(){d.onclick(d,c,a.messageBox)})}),b(".l-messagebox-buttons-inner",a.messageBox).append("\x3cdiv class\x3d'l-clear'\x3e\x3c/div\x3e"));d=a.messageBox.width();var g=0;b(".l-messagebox-buttons-inner .l-messagebox-btn",a.messageBox).each(function(){g+=b(this).width()});b(".l-messagebox-buttons-inner",a.messageBox).css({marginLeft:parseInt(0.5*(d-g))});a._applyWindowMask();a._applyDrag();a._setImage();var e=d=0,f=c.width||a.messageBox.width();null!=c.left?d=c.left:c.left=d=0.5*(b(window).width()-f);null!=c.top?e=c.top:c.top=e=0.5*(b(window).height()-a.messageBox.height())+b(window).scrollTop()-10;0>d&&(c.left=d=0);0>e&&(c.top=e=0);a.messageBox.css({left:d,top:e});b(".l-messagebox-btn",a.messageBox).hover(function(){b(this).addClass("l-messagebox-btn-over")},function(){b(this).removeClass("l-messagebox-btn-over")});b(".l-messagebox-close",a.messageBox).hover(function(){b(this).addClass("l-messagebox-close-over")},function(){b(this).removeClass("l-messagebox-close-over")}).click(function(){a.messageBox.close()});a.set(c)},close:function(){this.g._removeWindowMask();this.messageBox.remove()},_applyWindowMask:function(){b(".l-window-mask").remove();b("\x3cdiv class\x3d'l-window-mask' style\x3d'display: block;'\x3e\x3c/div\x3e").appendTo(b("body"))},_removeWindowMask:function(){b(".l-window-mask").remove()},_applyDrag:function(){this.options.isDrag&&b.fn.ligerDrag&&this.messageBox.ligerDrag({handler:".l-messagebox-title-inner",animate:!1})},_setImage:function(){var a=this.options;a.type&&("success"==a.type||"donne"==a.type?(b(".l-messagebox-image",this.messageBox).addClass("l-messagebox-image-donne").show(),b(".l-messagebox-content",this.messageBox).css({paddingLeft:64,paddingBottom:30})):"error"==a.type?(b(".l-messagebox-image",this.messageBox).addClass("l-messagebox-image-error").show(),b(".l-messagebox-content",this.messageBox).css({paddingLeft:64,paddingBottom:30})):"warn"==a.type?(b(".l-messagebox-image",this.messageBox).addClass("l-messagebox-image-warn").show(),b(".l-messagebox-content",this.messageBox).css({paddingLeft:64,paddingBottom:30})):"question"==a.type&&(b(".l-messagebox-image",this.messageBox).addClass("l-messagebox-image-question").show(),b(".l-messagebox-content",this.messageBox).css({paddingLeft:64,paddingBottom:40})))}});b.ligerMessageBox.show=function(a){return b.ligerMessageBox(a)};b.ligerMessageBox.alert=function(a,c,d,g){a=a||"";p={title:a,content:c||a,buttons:[{text:"\u786e\u5b9a",onclick:function(a,b,c){c.close();g&&g(a,b,c)}}]};d&&(p.type=d);return b.ligerMessageBox(p)};b.ligerMessageBox.confirm=function(a,c,d){var g=function(a,b,c){c.close();d&&d(0==b)};p={type:"question",title:a,content:c,buttons:[{text:"\u662f",onclick:g},{text:"\u5426",onclick:g}]};return b.ligerMessageBox(p)};b.ligerMessageBox.success=function(a,c,d){return b.ligerMessageBox.alert(a,c,"success",d)};b.ligerMessageBox.error=function(a,c,d){return b.ligerMessageBox.alert(a,c,"error",d)};b.ligerMessageBox.warn=function(a,c,d){return b.ligerMessageBox.alert(a,c,"warn",d)};b.ligerMessageBox.question=function(a,c){return b.ligerMessageBox.alert(a,c,"question")}})(jQuery);(function(b){b.fn.ligerPanel=function(a){return b.ligerui.run.call(this,"ligerPanel",arguments)};b.ligerDefaults.Panel={width:400,height:300,title:"Panel",content:null,url:null,frameName:null,data:null,showClose:!1,showToggle:!0,icon:null,onClose:null,onClosed:null,onLoaded:null};b.ligerMethos.Panel={};b.ligerui.controls.Panel=function(a,c){b.ligerui.controls.Panel.base.constructor.call(this,a,c)};b.ligerui.controls.Panel.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Panel"},__idPrev:function(){return"Panel"},_extendMethods:function(){return b.ligerMethos.Panel},_init:function(){var a=this.options;b.ligerui.controls.Panel.base._init.call(this);a.content=a.content||b(this.element).html()},_render:function(){var a=this,c=this.options;a.panel=b(a.element).addClass("l-panel").html("");a.panel.append('\x3cdiv class\x3d"l-panel-header"\x3e\x3cspan\x3e\x3c/span\x3e\x3cdiv class\x3d"icons"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"l-panel-content"\x3e\x3c/div\x3e');a.set(c);a.panel.bind("click.panel",function(c){c=b(c.target||c.srcElement);c.hasClass("l-panel-header-toggle")?a.toggle():c.hasClass("l-panel-header-close")&&a.close()})},collapse:function(){this.panel.find(".l-panel-header .l-panel-header-toggle:first").hasClass("l-panel-header-toggle-hide")||this.toggle()},expand:function(){this.panel.find(".l-panel-header .l-panel-header-toggle:first").hasClass("l-panel-header-toggle-hide")&&this.toggle()},toggle:function(){var a=this.panel.find(".l-panel-header .l-panel-header-toggle:first");a.hasClass("l-panel-header-toggle-hide")?a.removeClass("l-panel-header-toggle-hide"):a.addClass("l-panel-header-toggle-hide");this.panel.find(".l-panel-content:first").toggle("normal")},_setShowToggle:function(a){var c=this.panel.find(".l-panel-header:first");a?b("\x3cdiv class\x3d'l-panel-header-toggle'\x3e\x3c/div\x3e").appendTo(c.find(".icons")):c.find(".l-panel-header-toggle").remove()},_setContent:function(a){var b=this.panel.find(".l-panel-content:first");a&&b.html(a)},_setUrl:function(a){var c=this,d=this.options,g=c.panel.find(".l-panel-content:first");a&&(c.jiframe=b("\x3ciframe frameborder\x3d'0'\x3e\x3c/iframe\x3e"),a=d.frameName?d.frameName:"ligerpanel"+(new Date).getTime(),c.jiframe.attr("name",a),c.jiframe.attr("id",a),g.prepend(c.jiframe),setTimeout(function(){0==g.find(".l-panel-loading:first").length&&g.append("\x3cdiv class\x3d'l-panel-loading' style\x3d'display:block;'\x3e\x3c/div\x3e");var a=b(".l-panel-loading:first",g);c.jiframe[0].panel=c;c.jiframe.attr("src",d.url).bind("load.panel",function(){a.hide();c.trigger("loaded")});c.frame=window.frames[c.jiframe.attr("name")]},0))},_setShowClose:function(a){var c=this.panel.find(".l-panel-header:first");a?b("\x3cdiv class\x3d'l-panel-header-close'\x3e\x3c/div\x3e").appendTo(c.find(".icons")):c.find(".l-panel-header-close").remove()},close:function(){!1!=this.trigger("close")&&(this.panel.remove(),this.trigger("closed"))},show:function(){this.panel.show()},_setIcon:function(a){a?(this.panel.addClass("l-panel-hasicon"),this.panel.append('\x3cimg src\x3d"'+a+'" /\x3e')):(this.panel.removeClass("l-panel-hasicon"),this.panel.find("img").remove())},_setWidth:function(a){a&&this.panel.width(a)},_setHeight:function(a){var b=this.panel.find(".l-panel-header:first");this.panel.find(".l-panel-content:first").height(a-b.height())},_setTitle:function(a){this.panel.find(".l-panel-header span:first").text(a)}})})(jQuery);(function(b){b.fn.ligerPopupEdit=function(a){return b.ligerui.run.call(this,"ligerPopupEdit",arguments)};b.fn.ligerGetPopupEditManager=function(){return b.ligerui.run.call(this,"ligerGetPopupEditManager",arguments)};b.ligerDefaults.PopupEdit={valueFieldID:null,css:null,onButtonClick:null,nullText:null,disabled:!1,cancelable:!0,width:200,heigth:null,render:null,split:";",grid:null,condition:null,valueField:"id",textField:"text",parms:null,onSelect:null,onSelected:null,valueFieldCssClass:null};b.ligerMethos.PopupEdit=b.ligerMethos.PopupEdit||{};b.ligerui.controls.PopupEdit=function(a,c){b.ligerui.controls.PopupEdit.base.constructor.call(this,a,c)};b.ligerui.controls.PopupEdit.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"PopupEdit"},_extendMethods:function(){return b.ligerMethos.PopupEdit},_init:function(){b.ligerui.controls.PopupEdit.base._init.call(this)},_render:function(){var a=this,c=this.options;a.inputText=null;"input"==this.element.tagName.toLowerCase()&&(this.element.readOnly=!0,a.inputText=b(this.element),a.textFieldID=this.element.id);void 0==a.inputText[0].name&&(a.inputText[0].name=a.textFieldID);a.valueField=null;c.valueFieldID?(a.valueField=b("#"+c.valueFieldID+":input"),0==a.valueField.length&&(a.valueField=b('\x3cinput type\x3d"hidden"/\x3e')),a.valueField[0].id=a.valueField[0].name=c.valueFieldID):(a.valueField=b('\x3cinput type\x3d"hidden"/\x3e'),a.valueField[0].id=a.valueField[0].name=a.textFieldID+"_val");void 0==a.valueField[0].name&&(a.valueField[0].name=a.valueField[0].id);c.valueFieldCssClass&&a.valueField.addClass(c.valueFieldCssClass);a.link=b('\x3cdiv class\x3d"l-trigger"\x3e\x3cdiv class\x3d"l-trigger-icon"\x3e\x3c/div\x3e\x3c/div\x3e');a.wrapper=a.inputText.wrap('\x3cdiv class\x3d"l-text l-text-popup"\x3e\x3c/div\x3e').parent();a.wrapper.append('\x3cdiv class\x3d"l-text-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-text-r"\x3e\x3c/div\x3e');a.wrapper.append(a.link);a.wrapper.append(a.valueField);a.inputText.addClass("l-text-field");a.link.hover(function(){c.disabled||(this.className="l-trigger-hover")},function(){c.disabled||(this.className="l-trigger")}).mousedown(function(){c.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){c.disabled||(this.className="l-trigger-hover")}).click(function(){if(!c.disabled&&!1==a.trigger("buttonClick"))return!1});a.inputText.click(function(){}).blur(function(){c.disabled||a.wrapper.removeClass("l-text-focus")}).focus(function(){c.disabled||a.wrapper.addClass("l-text-focus")});a.wrapper.hover(function(){c.disabled||a.wrapper.addClass("l-text-over")},function(){c.disabled||a.wrapper.removeClass("l-text-over")});a.set(c)},destroy:function(){this.wrapper&&this.wrapper.remove();this.options=null;b.ligerui.remove(this)},clear:function(){this.inputText.val("");this.valueField.val("")},_setCss:function(a){a&&this.wrapper.addClass(a)},_setCancelable:function(a){var c=this,d=this.options;!a&&c.unselect&&(c.unselect.remove(),c.unselect=null);if(a||c.unselect)c.unselect=b('\x3cdiv class\x3d"l-trigger l-trigger-cancel"\x3e\x3cdiv class\x3d"l-trigger-icon"\x3e\x3c/div\x3e\x3c/div\x3e').hide(),c.wrapper.hover(function(){c.unselect.show()},function(){c.unselect.hide()}),!d.disabled&&d.cancelable&&c.wrapper.append(c.unselect),c.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){c.clear()})},_setDisabled:function(a){a?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_setWidth:function(a){20<a&&(this.wrapper.css({width:a}),this.inputText.css({width:a-20}))},_setHeight:function(a){10<a&&(this.wrapper.height(a),this.inputText.height(a-2))},getData:function(){var a=this.options,c=[],d=b(this.valueField).val(),g=b(this.inputText).val(),e=d?d.split(a.split):null,f=g?g.split(a.split):null;b(e).each(function(b){var d={};d[a.textField]=f[b];d[a.valueField]=e[b];c.push(d)});return c},_getText:function(){return b(this.inputText).val()},_getValue:function(){return b(this.valueField).val()},getValue:function(){return this._getValue()},getText:function(){return this._getText()},setValue:function(a,b){2<=arguments.length?(this.setValue(a),this.setText(b)):this.valueField.val(a)},setText:function(a){var b=this.options;b.render?this.inputText.val(b.render(a)):this.inputText.val(a)},addValue:function(a,c){var d=this.options;if(a){var g=this.getValue(),e=this.getText();if(g){var f=[],h=[],k=g.split(d.split);a=a.split(d.split);c=c.split(d.split);for(var m=0,n=a.length;m<n;m++)-1==b.inArray(a[m],k)&&(f.push(a[m]),h.push(c[m]));f.length&&(this.setValue(g+d.split+f.join(d.split)),this.setText(e+d.split+h.join(d.split)))}else this.setValue(a),this.setText(c)}},removeValue:function(a,c){var d=this.options;if(a){var g=this.getValue(),e=this.getText();if(g){g=g.split(d.split);e=e.split(d.split);a=a.split(d.split);for(var f=0,h=-1,k=a.length;f<k;f++)-1!=(h=b.inArray(a[f],g))&&(g.splice(h,1),e.splice(h,1));this.setValue(g.join(d.split));this.setText(e.join(d.split))}}},_setGrid:function(a){if(a){var c=this,d=this.options,g=b.extend({parms:d.parms},d.grid);this.bind("buttonClick",function(){if(!c.popupFn){var a={grid:g,condition:d.condition,valueField:d.valueField,textField:d.textField,split:d.split,lastSelected:c.getData(),onSelect:function(a){!1!=c.trigger("select",a)&&(d.grid.checkbox?(c.addValue(a.value,a.text),c.removeValue(a.remvoeValue,a.remvoeText)):(c.setValue(a.value),c.setText(a.text)),c.trigger("selected",a))},selectInit:function(a){var e=c.getValue();return e&&d.valueField&&a[d.valueField]?-1!=b.inArray(a[d.valueField].toString(),e.split(d.split)):!1}};c.popupFn=b.ligerui.getPopupFn(a)}c.popupFn()})}}});b.ligerui.getPopupFn=function(a){function c(){function c(b){b=b||a.height;return b-=n.height()}if(e)f._showData(),e.show(),f.refreshSize(),h=f.selected.concat();else{var d=b("\x3cdiv\x3e\x3c/div\x3e"),n=b("\x3cdiv\x3e\x3c/div\x3e"),q=b("\x3cdiv\x3e\x3c/div\x3e");d.append(n).append(q);if(a.condition){var r=b.extend({labelWidth:60,space:20},a.condition);n.ligerForm(r)}else n.remove();r=b.extend({columnWidth:120,alternatingRow:!1,frozen:!0,rownumbers:!0},a.grid,{width:"100%",height:c(),isChecked:a.selectInit,isSelected:a.selectInit,inWindow:!1});f=q.ligerGrid(r);a.condition&&(q=b('\x3cli style\x3d"margin-right:9px"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/li\x3e'),b("ul:first",n).append(q).after('\x3cdiv class\x3d"l-clear"\x3e\x3c/div\x3e'),b("div",q).ligerButton({text:"\u641c\u7d22",click:function(){var a=b.ligerui.getConditions(n);f.setParm("condition",b.ligerui.toJSON(a));f.reload()}}));e=b.ligerDialog.open({title:a.title,width:a.width,height:"auto",top:a.top,left:a.left,target:d,isResize:!0,cls:"l-selectorwin",onContentHeightChange:function(a){f.set("height",c(a));return!1},onStopResize:function(){f.refreshSize()},buttons:[{text:"\u9009\u62e9",onclick:function(a,b){g();b.hide()}},{text:"\u53d6\u6d88",onclick:function(a,b){b.hide()}}]});f.refreshSize()}}function d(b,c){for(var d=0;c&&c[d];d++)if(c[d][a.valueField]==b)return!0;return!1}function g(){var c=f.selected||[],e=[],g=[],q=[];b(c).each(function(c,d){a.valueField&&e.push(d[a.valueField]);a.textField&&g.push(d[a.textField]);var h=b.extend(!0,{},this);f.formatRecord(h,!0);q.push(h)});var r=[];b(h).each(function(b,e){!d(e[a.valueField],c)&&d(e[a.valueField],f.rows)&&r.push(e)});var s=[],t=[],u=[];b(r).each(function(c,d){a.valueField&&s.push(d[a.valueField]);a.textField&&t.push(d[a.textField]);var e=b.extend(!0,{},this);f.formatRecord(e,!0);u.push(e)});a.onSelect({value:e.join(a.split),text:g.join(a.split),data:q,remvoeValue:s.join(a.split),remvoeText:t.join(a.split),removeData:u})}a=b.extend({title:"\u9009\u62e9\u6570\u636e",width:700,height:320,top:null,left:null,split:";",valueField:null,textField:null,grid:null,condition:null,onSelect:function(a){},selectInit:function(a){return!1}},a);if(a.grid){var e,f,h=a.lastSelected||[];return function(){c();return!1}}}})(jQuery);(function(b){b.fn.ligerPortal=function(a){return b.ligerui.run.call(this,"ligerPortal",arguments)};b.ligerDefaults.Portal={width:null,rows:null,columns:null,url:null,method:"get",parms:null,draggable:!1,onLoaded:null};b.ligerDefaults.Portal_rows={width:null,height:null};b.ligerDefaults.Portal_columns={width:null,height:null};b.ligerMethos.Portal={};b.ligerui.controls.Portal=function(a,c){b.ligerui.controls.Portal.base.constructor.call(this,a,c)};b.ligerui.controls.Portal.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Portal"},__idPrev:function(){return"Portal"},_extendMethods:function(){return b.ligerMethos.Portal},_init:function(){var a=this.options;b.ligerui.controls.Portal.base._init.call(this);b("\x3ediv",this.element).length&&(a.columns=[],b("\x3ediv",this.element).each(function(b,d){a.columns[b]={panels:[]}}),this.tempInitPanels=b("\x3cdiv\x3e\x3c/div\x3e"),b("\x3ediv",this.element).appendTo(this.tempInitPanels));!a.rows&&a.columns&&(a.rows=[{columns:a.columns}])},_render:function(){var a=this.options;this.portal=b(this.element).addClass("l-portal").html("");this.set(a)},_setRows:function(a){this.rows=[];if(a&&a.length)for(var c=0;c<a.length;c++){var d=a[c],g=b('\x3cdiv class\x3d"l-row"\x3e\x3c/div\x3e').appendTo(this.portal);this.rows[c]=this._renderRow({row:d,rowIndex:c,jrow:g});g.append('\x3cdiv class\x3d"l-clear"\x3e\x3c/div\x3e')}},_renderRow:function(a){var c=a.row,d=a.rowIndex;a=a.jrow;var g={element:a[0]};c.width&&a.width(c.width);c.height&&a.height(c.height);c.columns&&(g.columns=[]);if(c.columns&&c.columns.length)for(var e=0;e<c.columns.length;e++){var f=c.columns[e],h=b('\x3cdiv class\x3d"l-column"\x3e\x3c/div\x3e').appendTo(a);g.columns[e]=this._renderColumn({column:f,columnIndex:e,jcolumn:h,rowIndex:d})}return g},remove:function(a){var b=a.rowIndex,d=a.columnIndex;a=a.index;null==a&&(a=-1);0<=a&&this.rows[b]&&this.rows[b].columns&&this.rows[b].columns[d]&&this.rows[b].columns[d].panels&&((b=this.rows[b].columns[d].panels[a])&&b.close(),this._updatePortal())},add:function(a){var c=this.options,d=a.rowIndex,g=a.columnIndex,e=a.index;a=a.panel;null==e&&(e=-1);if(this.rows[d]&&this.rows[d].columns&&this.rows[d].columns[g]){var f=this.rows[d].columns[g],c=c.rows[d].columns[g],h;b(f.element);c.panels=c.panels||[];f.panels=f.panels||[];c.panels.splice(e,0,a);0>e?(h=b("\x3cdiv\x3e\x3c/div\x3e").insertBefore(f.jplace),h=h.ligerPanel(a)):f.panels[e]&&(h=b("\x3cdiv\x3e\x3c/div\x3e").insertBefore(f.panels[e].panel),h=h.ligerPanel(a));h&&(h.bind("closed",this._createPanelClosed()),this.setPanelEvent({panel:h}),f.panels.splice(e,0,h));this._updatePortal()}},_createPanelClosed:function(){var a=this,c=this.options;return function(){var d=this,g=a.getPanels(),e,f,h;b(g).each(function(){this.panel==d&&(e=this.rowIndex,f=this.columnIndex,h=this.index)});c.rows[e].columns[f].panels.splice(h,1);a.rows[e].columns[f].panels.splice(h,1)}},_renderColumn:function(a){var c=a.column,d=a.columnIndex;a=a.jcolumn;var g={element:a[0]};c.width&&a.width(c.width);c.height&&a.height(c.height);c.panels&&(g.panels=[]);if(c.panels&&c.panels.length)for(d=0;d<c.panels.length;d++){var e=c.panels[d],f=b("\x3cdiv\x3e\x3c/div\x3e").appendTo(a);g.panels[d]=f.ligerPanel(e);g.panels[d].bind("closed",this._createPanelClosed());this.setPanelEvent({panel:g.panels[d]})}else this.tempInitPanels&&(d=this.tempInitPanels.find("\x3ediv:eq("+d+")"),d.length&&(g.panels=[],c={},d=d.clone(),liger.inject&&liger.inject.getOptions&&(c=liger.inject.getOptions({jelement:d,defaults:b.ligerDefaults.Panel,config:liger.inject.config.Panel})),g.panels[0]=d.appendTo(a).ligerPanel(c),g.panels[0].bind("closed",this._createPanelClosed()),this.setPanelEvent({panel:g.panels[0]})));g.jplace=b('\x3cdiv class\x3d"l-column-place"\x3e\x3c/div\x3e').appendTo(a);return g},setPanelEvent:function(a){var c=a.panel,d=c.panel,g=this,e=this.options;b.fn.ligerDrag&&e.draggable&&d.addClass("l-panel-draggable").ligerDrag({proxy:!1,revert:!0,handler:".l-panel-header span:first",onRendered:function(){},onStartDrag:function(a,c){g.portal.find("\x3e.l-row").addClass("l-row-dragging");this.jplace=b('\x3cdiv class\x3d"l-panel-place"\x3e\x3c/div\x3e');this.jplace.height(d.height());d.width(d.width());d.addClass("l-panel-dragging");d.css("position","absolute");d.after(this.jplace);g._updatePortal()},onDrag:function(a,b){function e(a,b,c,d){var f=a?a.jpanel:b.jplace;if(!f)return null;var g=f.height(),h=f.width(),k=f.offset().left,f=f.offset().top;if(c>k-3&&c<k+h+3){if(d>f-3&&d<f+g/2+3)return{panel:a,column:b,position:"top"};if(d>f+g/2-3&&d<f+g+3)return{panel:a,column:b,position:a?"bottom":"top"}}return null}d.height();var m=d.width(),n=d.offset(),m=n.left+m/2,n=n.top+10,q=g.getPanels(),r=g.getEmptyColumns();(m=function(a,b,d,f){i=0;for(l=a.length;i<l;i++){var g=a[i];if(g.panel!=c&&(g=e(g,null,d,f)))return g}i=0;for(l=b.length;i<l;i++)if(g=e(null,b[i],d,f))return g;return null}(q,r,m,n))?this.placeStatus&&(this.placeStatus.panel&&m.panel&&this.placeStatus.panel.rowIndex==m.panel.rowIndex&&this.placeStatus.panel.columnIndex==m.panel.columnIndex&&this.placeStatus.panel.index==m.panel.index&&this.placeStatus.position==m.position||this.placeStatus.column&&m.column&&this.placeStatus.column.rowIndex==m.column.rowIndex&&this.placeStatus.column.columnIndex==m.column.columnIndex&&this.placeStatus.position==m.position)||("top"==m.position?(this.jplace.insertBefore(m.panel?m.panel.jpanel:m.column.jplace),this.savedPosition=m.panel?m.panel:m.column,this.savedPosition.inTop=!0):"bottom"==m.position&&(this.jplace.insertAfter(m.panel.jpanel),this.savedPosition=m.panel,this.savedPosition.inTop=!1),this.placeStatus=m):this.placeStatus=null},onStopDrag:function(a,h){g.portal.find("\x3e.l-row").removeClass("l-row-dragging");c.set("width",c.get("width"));d.removeClass("l-panel-dragging");if(this.jplace&&(d.css({position:"relative",left:null,top:null}),d.insertAfter(this.jplace),g.portal.find("\x3e.l-row \x3e .l-column \x3e.l-panel-place").remove(),this.savedPosition)){var k=g.getPanels(),m,n,q;b(k).each(function(){this.panel==c&&(m=this.rowIndex,n=this.columnIndex,q=this.index)});var k=e.rows[m].columns[n].panels[q],r=g.rows[m].columns[n].panels[q];e.rows[m].columns[n].panels.splice(q,1);g.rows[m].columns[n].panels.splice(q,1);this.savedPosition.panel?(e.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels.splice(this.savedPosition.index+this.savedPosition.inTop?-1:0,0,k),g.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels.splice(this.savedPosition.index+this.savedPosition.inTop?-1:0,0,r)):(e.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels=[k],g.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels=[r])}g._updatePortal();return!1}})},_updatePortal:function(){b(this.rows).each(function(a){b(this.columns).each(function(a){this.panels&&this.panels.length?b(this.element).removeClass("l-column-empty"):b(this.element).addClass("l-column-empty")})})},getPanels:function(){var a=[];b(this.rows).each(function(c){b(this.columns).each(function(d){b(this.panels).each(function(b){a.push({rowIndex:c,columnIndex:d,index:b,panel:this,jpanel:this.panel})})})});return a},getPanel:function(a){a=b.extend({rowIndex:0,columnIndex:0,index:0},a);var c=null;b(this.rows).each(function(d){b(this.columns).each(function(g){b(this.panels).each(function(b){c||d==a.rowIndex&&g==a.columnIndex&&b==a.index&&(c=this)})})});return c},getEmptyColumns:function(){var a=[];b(this.rows).each(function(c){b(this.columns).each(function(b){this.panels&&this.panels.length||a.push({rowIndex:c,columnIndex:b,jplace:this.jplace})})});return a},_setUrl:function(a){var c=this,d=this.options;a&&b.ajax({url:a,data:d.parms,type:d.method,dataType:"json",success:function(a){c.set("rows",a)}})},_setWidth:function(a){a&&this.portal.width(a)},collapseAll:function(){var a=this.getPanels();b(a).each(function(a,b){b.panel.collapse()})},expandAll:function(){var a=this.getPanels();b(a).each(function(a,b){b.panel.expand()})}})})(jQuery);(function(b){b.fn.ligerRadio=function(){return b.ligerui.run.call(this,"ligerRadio",arguments)};b.fn.ligerGetRadioManager=function(){return b.ligerui.run.call(this,"ligerGetRadioManager",arguments)};b.ligerDefaults.Radio={disabled:!1};b.ligerMethos.Radio={};b.ligerui.controls.Radio=function(a,c){b.ligerui.controls.Radio.base.constructor.call(this,a,c)};b.ligerui.controls.Radio.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"Radio"},__idPrev:function(){return"Radio"},_extendMethods:function(){return b.ligerMethos.Radio},_render:function(){var a=this,c=this.options;a.input=b(this.element);a.link=b('\x3ca href\x3d"javascript:void(0)" class\x3d"l-radio"\x3e\x3c/a\x3e');a.wrapper=a.input.addClass("l-hidden").wrap('\x3cdiv class\x3d"l-radio-wrapper"\x3e\x3c/div\x3e').parent();a.wrapper.prepend(a.link);a.input.change(function(){this.checked?a.link.addClass("l-radio-checked"):a.link.removeClass("l-radio-checked");return!0});a.link.click(function(){a._doclick()});a.wrapper.hover(function(){c.disabled||b(this).addClass("l-over")},function(){b(this).removeClass("l-over")});this.element.checked&&a.link.addClass("l-radio-checked");this.element.id&&b("label[for\x3d"+this.element.id+"]").click(function(){a._doclick()});a.set(c)},setValue:function(a){a?(this.input[0].checked=!0,this.link.addClass("l-radio-checked")):(this.input[0].checked=!1,this.link.removeClass("l-radio-checked"))},getValue:function(){return this.input[0].checked},setEnabled:function(){this.input.attr("disabled",!1);this.wrapper.removeClass("l-disabled");this.options.disabled=!1},setDisabled:function(){this.input.attr("disabled",!0);this.wrapper.addClass("l-disabled");this.options.disabled=!0},updateStyle:function(){this.input.attr("disabled")&&(this.wrapper.addClass("l-disabled"),this.options.disabled=!0);this.input[0].checked?this.link.addClass("l-checkbox-checked"):this.link.removeClass("l-checkbox-checked")},_doclick:function(){if(this.input.attr("disabled"))return!1;this.input.trigger("click").trigger("change");b("input:radio[name\x3d"+this.input[0].name+"]",this.input[0].form?this.input[0].form:document).not(this.input).trigger("change");return!1}})})(jQuery);(function(b){b.fn.ligerRadioList=function(a){return b.ligerui.run.call(this,"ligerRadioList",arguments)};b.ligerDefaults.RadioList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,data:null,parms:null,url:null,onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null};b.ligerMethos.RadioList=b.ligerMethos.RadioList||{};b.ligerui.controls.RadioList=function(a,c){b.ligerui.controls.RadioList.base.constructor.call(this,a,c)};b.ligerui.controls.RadioList.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"RadioList"},_extendMethods:function(){return b.ligerMethos.RadioList},_init:function(){b.ligerui.controls.RadioList.base._init.call(this)},_render:function(){var a=this.options;this.data=a.data;this.valueField=null;a.valueFieldID?(this.valueField=b("#"+a.valueFieldID+":input,[name\x3d"+a.valueFieldID+"]:input"),0==this.valueField.length&&(this.valueField=b('\x3cinput type\x3d"hidden"/\x3e')),this.valueField[0].id=this.valueField[0].name=a.valueFieldID):(this.valueField=b('\x3cinput type\x3d"hidden"/\x3e'),this.valueField[0].id=this.valueField[0].name=this.id+"_val");null==this.valueField[0].name&&(this.valueField[0].name=this.valueField[0].id);a.valueFieldCssClass&&this.valueField.addClass(a.valueFieldCssClass);this.valueField.attr("data-ligerid",this.id);this.radioList=b(this.element);this.radioList.html('\x3cdiv class\x3d"l-radiolist-inner"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" border\x3d"0" class\x3d"l-radiolist-table"\x3e\x3c/table\x3e\x3c/div\x3e').addClass("l-radiolist").append(this.valueField);this.radioList.table=b("table:first",this.radioList);a.value=this.valueField.val()||a.value;this.set(a);this._addClickEven()},destroy:function(){this.radioList&&this.radioList.remove();this.options=null;b.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setCss:function(a){a&&this.radioList.addClass(a)},_setDisabled:function(a){a?(this.radioList.addClass("l-radiolist-disabled"),b("input:radio",this.radioList).attr("disabled",!0)):(this.radioList.removeClass("l-radiolist-disabled"),b("input:radio",this.radioList).removeAttr("disabled"))},_setWidth:function(a){this.radioList.width(a)},_setHeight:function(a){this.radioList.height(a)},indexOf:function(a){var b=this.options;if(!this.data)return-1;for(var d=0,g=this.data.length;d<g;d++)if("object"==typeof a){if(this.data[d]==a)return d}else if(this.data[d][b.valueField].toString()==a.toString())return d;return-1},removeItems:function(a){var c=this;c.data&&(b(a).each(function(a,b){var e=c.indexOf(b);-1!=e&&c.data.splice(e,1)}),c.refresh())},removeItem:function(a){this.data&&(a=this.indexOf(a),-1!=a&&(this.data.splice(a,1),this.refresh()))},insertItem:function(a,b){this.data||(this.data=[]);this.data.splice(b,0,a);this.refresh()},addItems:function(a){var c=this;c.data||(c.data=[]);b(a).each(function(a,b){c.data.push(b)});c.refresh()},addItem:function(a){this.data||(this.data=[]);this.data.push(a);this.refresh()},_setValue:function(a){this.options.value=a;this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(a){if(a){var c=this;b.ajax({type:"post",url:a,data:this.options.parms,cache:!1,dataType:"json",success:function(a){c.setData(a);c.trigger("success",[a])},error:function(a,b){c.trigger("error",[a,b])}})}},setUrl:function(a){return this._setUrl(a)},setParm:function(a,b){if(a){var d=this.get("parms");d||(d={});d[a]=b;this.set("parms",d)}},clearContent:function(){b("table",this.radioList).html("")},_setData:function(a){this.setData(a)},setData:function(a){a&&a.length&&(this.data=a,this.refresh(),this.updateStyle())},refresh:function(){var a=this.options,b=this.data;this.clearContent();if(b){for(var d=[],g=a.rowSize,e=!1,f=a.name||this.id,h=0;h<b.length;h++){var k=b[h][a.valueField],m=b[h][a.textField],n=this.id+"-"+h;0==h%g&&(e&&d.push("\x3c/tr\x3e"),d.push("\x3ctr\x3e"),e=!0);d.push("\x3ctd\x3e\x3cinput type\x3d'radio' name\x3d'"+f+"' value\x3d'"+k+"' id\x3d'"+n+"'/\x3e\x3clabel for\x3d'"+n+"'\x3e"+m+"\x3c/label\x3e\x3c/td\x3e")}e&&d.push("\x3c/tr\x3e");this.radioList.table.append(d.join(""))}},_getValue:function(){return b('input:radio[name\x3d"'+(this.options.name||this.id)+'"]:checked').val()},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},_dataInit:function(){var a=this.options,a=this.valueField.val()||this._getValue()||a.value;this._changeValue(a)},_changeValue:function(a){b("input:radio[name\x3d'"+(this.options.name||this.id)+"']",this.radioList).each(function(){this.checked=this.value==a});this.valueField.val(a);this.selectedValue=a},_addClickEven:function(){var a=this;a.radioList.click(function(b){(b=a.getValue())&&a.valueField.val(b)})}})})(jQuery);(function(b){b.fn.ligerResizable=function(a){return b.ligerui.run.call(this,"ligerResizable",arguments,{idAttrName:"ligeruiresizableid",hasElement:!1,propertyToElemnt:"target"})};b.fn.ligerGetResizableManager=function(){return b.ligerui.run.call(this,"ligerGetResizableManager",arguments,{idAttrName:"ligeruiresizableid",hasElement:!1,propertyToElemnt:"target"})};b.ligerDefaults.Resizable={handles:"n, e, s, w, ne, se, sw, nw",maxWidth:2E3,maxHeight:2E3,minWidth:20,minHeight:20,scope:3,animate:!1,onStartResize:function(a){},onResize:function(a){},onStopResize:function(a){},onEndResize:null};b.ligerui.controls.Resizable=function(a){b.ligerui.controls.Resizable.base.constructor.call(this,null,a)};b.ligerui.controls.Resizable.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Resizable"},__idPrev:function(){return"Resizable"},_render:function(){var a=this,c=this.options;a.target=b(c.target);a.set(c);a.target.mousemove(function(d){c.disabled||(a.dir=a._getDir(d),a.dir?a.target.css("cursor",a.dir+"-resize"):0<a.target.css("cursor").indexOf("-resize")&&a.target.css("cursor","default"),c.target.ligeruidragid&&((d=b.ligerui.get(c.target.ligeruidragid))&&a.dir?d.set("disabled",!0):d&&d.set("disabled",!1)))}).mousedown(function(b){c.disabled||a.dir&&a._start(b)})},_rendered:function(){this.options.target.ligeruiresizableid=this.id},_getDir:function(a){var c=this.options,d="",g=this.target.offset(),e=this.target.width(),f=this.target.height(),h=c.scope,k=a.pageX||a.screenX;a=a.pageY||a.screenY;a>=g.top&&a<g.top+h?d+="n":a<=g.top+f&&a>g.top+f-h&&(d+="s");k>=g.left&&k<g.left+h?d+="w":k<=g.left+e&&k>g.left+e-h&&(d+="e");return"all"==c.handles||""==d||-1!=b.inArray(d,this.handles)?d:""},_setHandles:function(a){a&&(this.handles=a.replace(/(\s*)/g,"").split(","))},_createProxy:function(){this.proxy=b('\x3cdiv class\x3d"l-resizable"\x3e\x3c/div\x3e');this.proxy.width(this.target.width()).height(this.target.height());this.proxy.attr("resizableid",this.id).appendTo("body")},_removeProxy:function(){this.proxy&&(this.proxy.remove(),this.proxy=null)},_start:function(a){var c=this;c._createProxy();c.proxy.css({left:c.target.offset().left,top:c.target.offset().top,position:"absolute"});c.current={dir:c.dir,left:c.target.offset().left,top:c.target.offset().top,startX:a.pageX||a.screenX,startY:a.pageY||a.clientY,width:c.target.width(),height:c.target.height()};b(document).bind("selectstart.resizable",function(){return!1});b(document).bind("mouseup.resizable",function(){c._stop.apply(c,arguments)});b(document).bind("mousemove.resizable",function(){c._drag.apply(c,arguments)});c.proxy.show();c.trigger("startResize",[c.current,a])},changeBy:{t:["n","ne","nw"],l:["w","sw","nw"],w:"w sw nw e ne se".split(" "),h:"n ne nw s se sw".split(" ")},_drag:function(a){if(this.current&&this.proxy){this.proxy.css("cursor",""==this.current.dir?"default":this.current.dir+"-resize");var b=a.pageY||a.screenY;this.current.diffX=(a.pageX||a.screenX)-this.current.startX;this.current.diffY=b-this.current.startY;this._applyResize(this.proxy);this.trigger("resize",[this.current,a])}},_stop:function(a){this.hasBind("stopResize")?!1!=this.trigger("stopResize",[this.current,a])&&this._applyResize():this._applyResize();this._removeProxy();this.trigger("endResize",[this.current,a]);b(document).unbind("selectstart.resizable");b(document).unbind("mousemove.resizable");b(document).unbind("mouseup.resizable")},_applyResize:function(a){var c=this.options,d={left:this.current.left,top:this.current.top,width:this.current.width,height:this.current.height},g=!1;a||(a=this.target,g=!0,isNaN(parseInt(this.target.css("top")))?d.top=0:d.top=parseInt(this.target.css("top")),isNaN(parseInt(this.target.css("left")))?d.left=0:d.left=parseInt(this.target.css("left")));-1<b.inArray(this.current.dir,this.changeBy.l)?(d.left+=this.current.diffX,this.current.diffLeft=this.current.diffX):g&&delete d.left;-1<b.inArray(this.current.dir,this.changeBy.t)?(d.top+=this.current.diffY,this.current.diffTop=this.current.diffY):g&&delete d.top;-1<b.inArray(this.current.dir,this.changeBy.w)?(d.width+=(-1==this.current.dir.indexOf("w")?1:-1)*this.current.diffX,this.current.newWidth=d.width):g&&delete d.width;-1<b.inArray(this.current.dir,this.changeBy.h)?(d.height+=(-1==this.current.dir.indexOf("n")?1:-1)*this.current.diffY,this.current.newHeight=d.height):g&&delete d.height;g&&c.animate?a.animate(d):a.css(d)}})})(jQuery);(function(b){b.fn.ligerSpinner=function(){return b.ligerui.run.call(this,"ligerSpinner",arguments)};b.fn.ligerGetSpinnerManager=function(){return b.ligerui.run.call(this,"ligerGetSpinnerManager",arguments)};b.ligerDefaults.Spinner={type:"float",isNegative:!0,decimalplace:2,step:0.1,interval:50,onChangeValue:!1,minValue:null,maxValue:null,disabled:!1,readonly:!1};b.ligerMethos.Spinner={};b.ligerui.controls.Spinner=function(a,c){b.ligerui.controls.Spinner.base.constructor.call(this,a,c)};b.ligerui.controls.Spinner.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"Spinner"},__idPrev:function(){return"Spinner"},_extendMethods:function(){return b.ligerMethos.Spinner},_init:function(){b.ligerui.controls.Spinner.base._init.call(this);var a=this.options;"float"==a.type?(a.step=0.1,a.interval=50):("int"!=a.type&&"time"!=a.type&&(a.type="int"),a.step=1,a.interval=100)},_render:function(){var a=this,c=this.options;a.interval=null;a.inputText=null;a.value=null;a.textFieldID="";"input"==this.element.tagName.toLowerCase()&&this.element.type&&"text"==this.element.type?(a.inputText=b(this.element),this.element.id&&(a.textFieldID=this.element.id)):(a.inputText=b('\x3cinput type\x3d"text"/\x3e'),a.inputText.appendTo(b(this.element)));""==a.textFieldID&&c.textFieldID&&(a.textFieldID=c.textFieldID);a.link=b('\x3cdiv class\x3d"l-trigger"\x3e\x3cdiv class\x3d"l-spinner-up"\x3e\x3cdiv class\x3d"l-spinner-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"l-spinner-split"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-spinner-down"\x3e\x3cdiv class\x3d"l-spinner-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e');a.wrapper=a.inputText.wrap('\x3cdiv class\x3d"l-text"\x3e\x3c/div\x3e').parent();a.wrapper.append('\x3cdiv class\x3d"l-text-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-text-r"\x3e\x3c/div\x3e');a.wrapper.append(a.link).after(a.selectBox).after(a.valueField);a.link.up=b(".l-spinner-up",a.link);a.link.down=b(".l-spinner-down",a.link);a.inputText.addClass("l-text-field");c.disabled&&a.wrapper.addClass("l-text-disabled");a._isVerify(a.inputText.val())||(a.value=a._getDefaultValue(),a._showValue(a.value));a.link.up.hover(function(){c.disabled||b(this).addClass("l-spinner-up-over")},function(){clearInterval(a.interval);b(document).unbind("selectstart.spinner");b(this).removeClass("l-spinner-up-over")}).mousedown(function(){c.disabled||(a._uping.call(a),a.interval=setInterval(function(){a._uping.call(a)},c.interval),b(document).bind("selectstart.spinner",function(){return!1}))}).mouseup(function(){clearInterval(a.interval);a.inputText.trigger("change").focus();b(document).unbind("selectstart.spinner")});a.link.down.hover(function(){c.disabled||b(this).addClass("l-spinner-down-over")},function(){clearInterval(a.interval);b(document).unbind("selectstart.spinner");b(this).removeClass("l-spinner-down-over")}).mousedown(function(){c.disabled||(a.interval=setInterval(function(){a._downing.call(a)},c.interval),b(document).bind("selectstart.spinner",function(){return!1}))}).mouseup(function(){clearInterval(a.interval);a.inputText.trigger("change").focus();b(document).unbind("selectstart.spinner")});a.inputText.change(function(){var b=a.inputText.val();a.value=a._getVerifyValue(b);a.trigger("changeValue",[a.value]);a._showValue(a.value)}).blur(function(){a.wrapper.removeClass("l-text-focus")}).focus(function(){a.wrapper.addClass("l-text-focus")});a.wrapper.hover(function(){c.disabled||a.wrapper.addClass("l-text-over")},function(){a.wrapper.removeClass("l-text-over")});a.set(c)},_setWidth:function(a){20<a&&(this.wrapper.css({width:a}),this.inputText.css({width:a-20}))},_setHeight:function(a){10<a&&(this.wrapper.height(a),this.inputText.height(a-2),this.link.height(a-4))},_setDisabled:function(a){a?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_showValue:function(a){var b=this.options;a&&"NaN"!=a||(a=0);"float"==b.type&&(a=parseFloat(a).toFixed(b.decimalplace));this.inputText.val(a)},_setValue:function(a){this._showValue(a)},setValue:function(a){this._showValue(a)},getValue:function(){return this.inputText.val()},_round:function(a,b){for(var d=1;0<b;d*=10,b--);for(;0>b;d/=10,b++);return Math.round(a*d)/d},_isInt:function(a){return(this.options.isNegative?/^-?\d+$/:/^\d+$/).test(a)&&parseFloat(a)==a?!0:!1},_isFloat:function(a){return(this.options.isNegative?/^-?\d+(\.\d+)?$/:/^\d+(\.\d+)?$/).test(a)&&parseFloat(a)==a?!0:!1},_isTime:function(a){a=a.match(/^(\d{1,2}):(\d{1,2})$/);return null==a||24<a[1]||60<a[2]?!1:!0},_isVerify:function(a){var b=this.options;if("float"==b.type){if(!this._isFloat(a))return!1;a=parseFloat(a);return void 0!=b.minValue&&b.minValue>a||void 0!=b.maxValue&&b.maxValue<a?!1:!0}if("int"==b.type){if(!this._isInt(a))return!1;a=parseInt(a);return void 0!=b.minValue&&b.minValue>a||void 0!=b.maxValue&&b.maxValue<a?!1:!0}return"time"==b.type?this._isTime(a):!1},_getVerifyValue:function(a){var b=this.options,d=null;"float"==b.type?d=this._round(a,b.decimalplace):"int"==b.type?d=parseInt(a):"time"==b.type&&(d=a);return this._isVerify(d)?d:this.value},_isOverValue:function(a){var b=this.options;return null!=b.minValue&&b.minValue>a||null!=b.maxValue&&b.maxValue<a?!0:!1},_getDefaultValue:function(){var a=this.options;if("float"==a.type||"int"==a.type)return 0;if("time"==a.type)return"00:00"},_addValue:function(a){var b=this.inputText.val(),b=parseFloat(b)+a;this._isOverValue(b)||(this._showValue(b),this.inputText.trigger("change"))},_addTime:function(a){var b=this.inputText.val(),b=b.match(/^(\d{1,2}):(\d{1,2})$/);newminute=parseInt(b[2])+a;10>newminute&&(newminute="0"+newminute);b=b[1]+":"+newminute;this._isOverValue(b)||(this._showValue(b),this.inputText.trigger("change"))},_uping:function(){var a=this.options;"float"==a.type||"int"==a.type?this._addValue(a.step):"time"==a.type&&this._addTime(a.step)},_downing:function(){var a=this.options;"float"==a.type||"int"==a.type?this._addValue(-1*a.step):"time"==a.type&&this._addTime(-1*a.step)},_isDateTime:function(a){a=a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(null==a)return!1;var b=new Date(a[1],a[3]-1,a[4]);return"NaN"==b?!1:b.getFullYear()==a[1]&&b.getMonth()+1==a[3]&&b.getDate()==a[4]},_isLongDateTime:function(a){a=a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/);if(null==a)return!1;var b=new Date(a[1],a[3]-1,a[4],a[5],a[6]);return"NaN"==b?!1:b.getFullYear()==a[1]&&b.getMonth()+1==a[3]&&b.getDate()==a[4]&&b.getHours()==a[5]&&b.getMinutes()==a[6]}})})(jQuery);(function(b){b.fn.ligerTab=function(a){return b.ligerui.run.call(this,"ligerTab",arguments)};b.fn.ligerGetTabManager=function(){return b.ligerui.run.call(this,"ligerGetTabManager",arguments)};b.ligerDefaults.Tab={height:null,heightDiff:0,changeHeightOnResize:!1,contextmenu:!0,dblClickToClose:!1,dragToMove:!1,showSwitch:!1,showSwitchInTab:!1,onBeforeOverrideTabItem:null,onAfterOverrideTabItem:null,onBeforeRemoveTabItem:null,onAfterRemoveTabItem:null,onBeforeAddTabItem:null,onAfterAddTabItem:null,onBeforeSelectTabItem:null,onAfterSelectTabItem:null,onCloseOther:null,onCloseAll:null,onClose:null,onReload:null};b.ligerDefaults.TabString={closeMessage:"\u5173\u95ed\u5f53\u524d\u9875",closeOtherMessage:"\u5173\u95ed\u5176\u4ed6",closeAllMessage:"\u5173\u95ed\u6240\u6709",reloadMessage:"\u5237\u65b0"};b.ligerMethos.Tab={};b.ligerui.controls.Tab=function(a,c){b.ligerui.controls.Tab.base.constructor.call(this,a,c)};b.ligerui.controls.Tab.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Tab"},__idPrev:function(){return"Tab"},_extendMethods:function(){return b.ligerMethos.Tab},_render:function(){var a=this,c=this.options;c.height&&(a.makeFullHeight=!0);a.tab=b(this.element);a.tab.addClass("l-tab");c.contextmenu&&b.ligerMenu&&(a.tab.menu=b.ligerMenu({width:100,items:[{text:c.closeMessage,id:"close",click:function(){a._menuItemClick.apply(a,arguments)}},{text:c.closeOtherMessage,id:"closeother",click:function(){a._menuItemClick.apply(a,arguments)}},{text:c.closeAllMessage,id:"closeall",click:function(){a._menuItemClick.apply(a,arguments)}},{text:c.reloadMessage,id:"reload",click:function(){a._menuItemClick.apply(a,arguments)}}]}));a.tab.content=b('\x3cdiv class\x3d"l-tab-content"\x3e\x3c/div\x3e');b("\x3e div",a.tab).appendTo(a.tab.content);a.tab.content.appendTo(a.tab);a.tab.links=b('\x3cdiv class\x3d"l-tab-links"\x3e\x3cul style\x3d"left: 0px; "\x3e\x3c/ul\x3e\x3cdiv class\x3d"l-tab-switch"\x3e\x3c/div\x3e\x3c/div\x3e');a.tab.links.prependTo(a.tab);a.tab.links.ul=b("ul",a.tab.links);var d=b("\x3e div[lselected\x3dtrue]",a.tab.content),g=0<d.length;a.selectedTabId=d.attr("tabid");b("\x3e div",a.tab.content).each(function(c,d){var h=b('\x3cli class\x3d""\x3e\x3ca\x3e\x3c/a\x3e\x3cdiv class\x3d"l-tab-links-item-left"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-tab-links-item-right"\x3e\x3c/div\x3e\x3c/li\x3e'),k=b(this);k.attr("title")&&(b("\x3e a",h).html(k.attr("title")),k.attr("title",""));var m=k.attr("tabid");void 0==m&&(m=a.getNewTabid(),k.attr("tabid",m),k.attr("lselected")&&(a.selectedTabId=m));h.attr("tabid",m);g||0!=c||(a.selectedTabId=m);k.attr("showClose")&&h.append("\x3cdiv class\x3d'l-tab-links-item-close'\x3e\x3c/div\x3e");b("\x3e ul",a.tab.links).append(h);k.hasClass("l-tab-content-item")||k.addClass("l-tab-content-item");if(0<k.find("iframe").length&&(h=b("iframe:first",k),"complete"!=h[0].readyState)){0==k.find(".l-tab-loading:first").length&&k.prepend("\x3cdiv class\x3d'l-tab-loading' style\x3d'display:block;'\x3e\x3c/div\x3e");var n=b(".l-tab-loading:first",k);h.bind("load.tab",function(){n.hide()})}});a.selectTabItem(a.selectedTabId);c.height&&("string"==typeof c.height&&0<c.height.indexOf("%")?(a.onResize(),c.changeHeightOnResize&&b(window).resize(function(){a.onResize.call(a)})):a.setHeight(c.height));a.makeFullHeight&&a.setContentHeight();b("li",a.tab.links).each(function(){a._addTabItemEvent(b(this))});a.tab.bind("dblclick.tab",function(d){if(c.dblClickToClose){a.dblclicking=!0;d=d.target||d.srcElement;if("a"==d.tagName.toLowerCase()){var f=b(d).parent().attr("tabid");b(d).parent().find("div.l-tab-links-item-close").length&&a.removeTabItem(f)}a.dblclicking=!1}});a.set(c)},_setShowSwitch:function(a){var c=this;a?(b(".l-tab-switch",c.tab.links).length||b("\x3cdiv class\x3d'l-tab-switch'\x3e\x3c/div\x3e").appendTo(c.tab.links),b(c.tab).addClass("l-tab-switchable"),b(".l-tab-switch",c.tab).click(function(){c.toggleSwitch(this)})):(b(c.tab).removeClass("l-tab-switchable"),b("body \x3e .l-tab-windowsswitch").remove())},_setShowSwitchInTab:function(a){var c=this;this.options.showSwitch&&a?(b(c.tab).removeClass("l-tab-switchable"),b(".l-tab-switch",c.tab).remove(),a=b("\x3cli class\x3d'l-tab-itemswitch'\x3e\x3ca\x3e\x3c/a\x3e\x3cdiv class\x3d'l-tab-links-item-left'\x3e\x3c/div\x3e\x3cdiv class\x3d'l-tab-links-item-right'\x3e\x3c/div\x3e\x3c/li\x3e"),a.appendTo(c.tab.links.ul),a.click(function(){c.toggleSwitch(this)})):b(".l-tab-itemswitch",c.tab.ul).remove()},toggleSwitch:function(a){var c=this;if(b("body \x3e .l-tab-windowsswitch").length)b("body \x3e .l-tab-windowsswitch").remove();else if(null!=a){var d=b("\x3cdiv class\x3d'l-tab-windowsswitch'\x3e\x3c/div\x3e").appendTo("body"),g=c.tab.links.ul.find("\x3eli"),e=c.getSelectedTabItemID();g.each(function(a,c){var g=b("\x3ca href\x3d'javascript:void(0)'\x3e\x3c/a\x3e");g.text(b(c).find("a").text());var m=b(c).attr("tabid");null!=m&&(m==e&&g.addClass("selected"),g.attr("tabid",m),d.append(g))});d.css({top:b(a).offset().top+b(a).height(),left:b(a).offset().left-d.width()});d.bind("click",function(a){a=a.target||a.srcElement;"a"==a.tagName.toLowerCase()&&(a=b(a).attr("tabid"),c.selectTabItem(a),c.moveToTabItem(a),b("body \x3e .l-tab-windowsswitch").remove())})}},_applyDrag:function(a){var c=this;c.droptip=c.droptip||b("\x3cdiv class\x3d'l-tab-drag-droptip' style\x3d'display:none'\x3e\x3cdiv class\x3d'l-drop-move-up'\x3e\x3c/div\x3e\x3cdiv class\x3d'l-drop-move-down'\x3e\x3c/div\x3e\x3c/div\x3e").appendTo("body");return b(a).ligerDrag({revert:!0,animate:!1,proxy:function(){var a=b(this).find("a").html();c.dragproxy=b("\x3cdiv class\x3d'l-tab-drag-proxy' style\x3d'display:none'\x3e\x3cdiv class\x3d'l-drop-icon l-drop-no'\x3e\x3c/div\x3e\x3c/div\x3e").appendTo("body");c.dragproxy.append(a);return c.dragproxy},onRendered:function(){this.set("cursor","pointer")},onStartDrag:function(c,g){if(!b(a).hasClass("l-selected")||2==g.button||b(g.srcElement||g.target).hasClass("l-tab-links-item-close"))return!1},onDrag:function(a,g){null==c.dropIn&&(c.dropIn=-1);var e=c.tab.links.ul.find("\x3eli"),f=e.index(a.target);e.each(function(a,d){if(f!=a){var e=a>f;if(-1==c.dropIn||c.dropIn==a){var n=b(this).offset(),q=n.top,r=n.top+b(this).height(),s=n.left-10,n=n.left+10;e&&(s+=b(this).width(),n+=b(this).width());var e=g.pageX||g.screenX,t=g.pageY||g.screenY;e>s&&e<n&&t>q&&t<r?(c.droptip.css({left:s+5,top:q-9}).show(),c.dropIn=a,c.dragproxy.find(".l-drop-icon").removeClass("l-drop-no").addClass("l-drop-yes")):(c.dropIn=-1,c.droptip.hide(),c.dragproxy.find(".l-drop-icon").removeClass("l-drop-yes").addClass("l-drop-no"))}}})},onStopDrag:function(a,g){if(-1<c.dropIn){var e=c.tab.links.ul.find("\x3eli:eq("+c.dropIn+")").attr("tabid"),f=b(a.target).attr("tabid");setTimeout(function(){c.moveTabItem(f,e)},0);c.dropIn=-1;c.dragproxy.remove()}c.droptip.hide();this.set("cursor","default")}})},_setDragToMove:function(a){if(b.fn.ligerDrag){var c=this;a&&!c.drags&&(c.drags=c.drags||[],c.tab.links.ul.find("\x3eli").each(function(){c.drags.push(c._applyDrag(this))}))}},moveTabItem:function(a,b){var d=this.tab.links.ul.find("\x3eli[tabid\x3d"+a+"]"),g=this.tab.links.ul.find("\x3eli[tabid\x3d"+b+"]"),e=this.tab.links.ul.find("\x3eli").index(d),f=this.tab.links.ul.find("\x3eli").index(g);e<f?g.after(d):g.before(d)},setTabButton:function(){var a=0;b("li",this.tab.links.ul).each(function(){a+=b(this).width()+2});var c=this.tab.width();if(a>c)return b(".l-tab-links-left",this.tab).length||(this.tab.links.append('\x3cdiv class\x3d"l-tab-links-left"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"l-tab-links-right"\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e'),this.setTabButtonEven()),!0;this.tab.links.ul.animate({left:0});b(".l-tab-links-left,.l-tab-links-right",this.tab.links).remove();return!1},setTabButtonEven:function(){var a=this;b(".l-tab-links-left",a.tab.links).hover(function(){b(this).addClass("l-tab-links-left-over")},function(){b(this).removeClass("l-tab-links-left-over")}).click(function(){a.moveToPrevTabItem()});b(".l-tab-links-right",a.tab.links).hover(function(){b(this).addClass("l-tab-links-right-over")},function(){b(this).removeClass("l-tab-links-right-over")}).click(function(){a.moveToNextTabItem()})},moveToPrevTabItem:function(a){var c=b("\x3e li",this.tab.links.ul),d=b(".l-tab-links-right",this.tab),g=b(".l-tab-links-left",this.tab);if(!d.length||!g.length)return!1;d.offset();for(var d=null,e=0,f=g.offset().left+g.outerWidth(),h=0,k=c.length;h<k;h++){var m=b(c[h]),n=m.offset(),q=n.left,n=n.left+m.outerWidth();if(null!=a){if(q<f&&m.attr("tabid")==a){d=m;break}}else if(q<f&&n>=f){d=m;break}e+=m.outerWidth()+parseInt(m.css("marginLeft"))+parseInt(m.css("marginRight"))}if(null==d)return!1;a=e-g.outerWidth();this.tab.links.ul.animate({left:-1*a});return!0},moveToNextTabItem:function(a){var c=b("\x3e li",this.tab.links.ul),d=b(".l-tab-links-right",this.tab),g=b(".l-tab-links-left",this.tab);if(!d.length||!g.length)return!1;for(var d=d.offset(),g=g.offset(),e=null,f=0,h=0,k=c.length;h<k;h++){var m=b(c[h]),f=f+(m.outerWidth()+parseInt(m.css("marginLeft"))+parseInt(m.css("marginRight"))),n=m.offset(),q=n.left,n=n.left+m.outerWidth();if(null!=a){if(n>d.left&&m.attr("tabid")==a){e=m;break}}else if(q<=d.left&&n>d.left){e=m;break}}if(null==e)return!1;a=f-(d.left-g.left)+parseInt(e.css("marginLeft"))+parseInt(e.css("marginRight"));this.tab.links.ul.animate({left:-1*a});return!0},moveToTabItem:function(a){this.moveToPrevTabItem(a)||this.moveToNextTabItem(a)},getTabItemCount:function(){return b("li",this.tab.links.ul).length},getSelectedTabItemID:function(){return b("li.l-selected",this.tab.links.ul).attr("tabid")},removeSelectedTabItem:function(){this.removeTabItem(this.getSelectedTabItemID())},overrideSelectedTabItem:function(a){this.overrideTabItem(this.getSelectedTabItemID(),a)},overrideTabItem:function(a,c){if(!1==this.trigger("beforeOverrideTabItem",[a]))return!1;var d=c.tabid;void 0==d&&(d=this.getNewTabid());var g=c.url,e=c.content,f=c.text,h=c.showClose,k=c.height;if(!this.isTabItemExist(d)){var m=b("li[tabid\x3d"+a+"]",this.tab.links.ul),n=b(".l-tab-content-item[tabid\x3d"+a+"]",this.tab.content);m&&n&&(m.attr("tabid",d),n.attr("tabid",d),0==b("iframe",n).length&&g?n.html("\x3ciframe frameborder\x3d'0'\x3e\x3c/iframe\x3e"):e&&n.html(e),b("iframe",n).attr("name",d),void 0==h&&(h=!0),!1==h?b(".l-tab-links-item-close",m).remove():0==b(".l-tab-links-item-close",m).length&&m.append("\x3cdiv class\x3d'l-tab-links-item-close'\x3e\x3c/div\x3e"),void 0==f&&(f=d),k&&n.height(k),b("a",m).text(f),b("iframe",n).attr("src",g),this.trigger("afterOverrideTabItem",[a]))}},setHeader:function(a,c){b("li[tabid\x3d"+a+"] a",this.tab.links.ul).text(c)},selectTabItem:function(a){if(!1==this.trigger("beforeSelectTabItem",[a]))return!1;this.selectedTabId=a;b("\x3e .l-tab-content-item[tabid\x3d"+a+"]",this.tab.content).show().siblings().hide();b("li[tabid\x3d"+a+"]",this.tab.links.ul).addClass("l-selected").siblings().removeClass("l-selected");this.trigger("afterSelectTabItem",[a])},moveToLastTabItem:function(){var a=0;b("li",this.tab.links.ul).each(function(){a+=b(this).width()+2});var c=this.tab.width();if(a>c){var d=b(".l-tab-links-right",this.tab.links).width();this.tab.links.ul.animate({left:-1*(a-c+d+2)})}},isTabItemExist:function(a){return 0<b("li[tabid\x3d"+a+"]",this.tab.links.ul).length},addTabItem:function(a){var c=this,d=this.options;if(!1==c.trigger("beforeAddTabItem",[a]))return!1;var g=a.tabid;void 0==g&&(g=c.getNewTabid());var e=a.url,f=a.content,h=a.text,k=a.showClose,m=a.height;if(c.isTabItemExist(g))c.selectTabItem(g);else{var n=b("\x3cli\x3e\x3ca\x3e\x3c/a\x3e\x3cdiv class\x3d'l-tab-links-item-left'\x3e\x3c/div\x3e\x3cdiv class\x3d'l-tab-links-item-right'\x3e\x3c/div\x3e\x3cdiv class\x3d'l-tab-links-item-close'\x3e\x3c/div\x3e\x3c/li\x3e"),q=b("\x3cdiv class\x3d'l-tab-content-item'\x3e\x3cdiv class\x3d'l-tab-loading' style\x3d'display:block;'\x3e\x3c/div\x3e\x3ciframe frameborder\x3d'0'\x3e\x3c/iframe\x3e\x3c/div\x3e"),r=b("div:first",q),s=b("iframe:first",q);if(c.makeFullHeight){var t=c.tab.height()-c.tab.links.height();q.height(t)}n.attr("tabid",g);q.attr("tabid",g);e?s.attr("name",g).attr("id",g).attr("src",e).bind("load.tab",function(){r.hide();a.callback&&a.callback()}):(s.remove(),r.remove());f?q.html(f):a.target&&q.append(a.target);void 0==k&&(k=!0);!1==k&&b(".l-tab-links-item-close",n).remove();void 0==h&&(h=g);m&&q.height(m);b("a",n).text(h);b(".l-tab-itemswitch",c.tab.links.ul).length?n.insertBefore(b(".l-tab-itemswitch",c.tab.links.ul)):c.tab.links.ul.append(n);c.tab.content.append(q);c.selectTabItem(g);c.setTabButton()&&c.moveToTabItem(g);c._addTabItemEvent(n);d.dragToMove&&b.fn.ligerDrag&&(c.drags=c.drags||[],n.each(function(){c.drags.push(c._applyDrag(this))}));c.toggleSwitch();c.trigger("afterAddTabItem",[a])}},_addTabItemEvent:function(a){var c=this;a.click(function(){var a=b(this).attr("tabid");c.selectTabItem(a)});c.tab.menu&&c._addTabItemContextMenuEven(a);b(".l-tab-links-item-close",a).hover(function(){b(this).addClass("l-tab-links-item-close-over")},function(){b(this).removeClass("l-tab-links-item-close-over")}).click(function(){var a=b(this).parent().attr("tabid");c.removeTabItem(a)})},removeTabItem:function(a){if(!1==this.trigger("beforeRemoveTabItem",[a]))return!1;b("li[tabid\x3d"+a+"]",this.tab.links.ul).hasClass("l-selected")&&(b(".l-tab-content-item[tabid\x3d"+a+"]",this.tab.content).prev().show(),b("li[tabid\x3d"+a+"]",this.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected"));var c=b(".l-tab-content-item[tabid\x3d"+a+"]",this.tab.content),d=b("iframe",c);if(d.length){var g=d[0];g.src="about:blank";g.contentWindow.document.write("");b.browser.msie&&CollectGarbage();d.remove()}c.remove();b("li[tabid\x3d"+a+"]",this.tab.links.ul).remove();this.setTabButton();this.trigger("afterRemoveTabItem",[a])},addHeight:function(a){a=this.tab.height()+a;this.setHeight(a)},setHeight:function(a){this.tab.height(a);this.setContentHeight()},setContentHeight:function(){var a=this.tab.height()-this.tab.links.height();this.tab.content.height(a);b("\x3e .l-tab-content-item",this.tab.content).height(a)},getNewTabid:function(){this.getnewidcount=this.getnewidcount||0;return"tabitem"+ ++this.getnewidcount},getTabidList:function(a,c){var d=[];b("\x3e li",this.tab.links.ul).each(function(){b(this).attr("tabid")&&b(this).attr("tabid")!=a&&(!c||0<b(".l-tab-links-item-close",this).length)&&d.push(b(this).attr("tabid"))});return d},removeOther:function(a,c){var d=this,g=d.getTabidList(a,!0);b(g).each(function(){d.removeTabItem(this)})},reload:function(a){a=b(".l-tab-content-item[tabid\x3d"+a+"]");var c=b(".l-tab-loading:first",a);a=b("iframe:first",a);var d=b(a).attr("src");c.show();a.attr("src",d).unbind("load.tab").bind("load.tab",function(){c.hide()})},removeAll:function(a){var c=this;a=c.getTabidList(null,!0);b(a).each(function(){c.removeTabItem(this)})},onResize:function(){var a=this.options;if(!a.height||"string"!=typeof a.height||-1==a.height.indexOf("%"))return!1;if("body"==this.tab.parent()[0].tagName.toLowerCase()){var c=b(window).height(),c=c-parseInt(this.tab.parent().css("paddingTop")),c=c-parseInt(this.tab.parent().css("paddingBottom"));this.height=a.heightDiff+0.01*c*parseFloat(this.height)}else this.height=a.heightDiff+0.01*this.tab.parent().height()*parseFloat(a.height);this.tab.height(this.height);this.setContentHeight()},_menuItemClick:function(a){if(a.id&&this.actionTabid)switch(a.id){case "close":if(!1==this.trigger("close"))break;this.removeTabItem(this.actionTabid);this.actionTabid=null;break;case "closeother":if(!1==this.trigger("closeother"))break;this.removeOther(this.actionTabid);break;case "closeall":if(!1==this.trigger("closeall"))break;this.removeAll();this.actionTabid=null;break;case "reload":if(!1==this.trigger("reload",[{tabid:this.actionTabid}]))break;this.selectTabItem(this.actionTabid);this.reload(this.actionTabid)}},_addTabItemContextMenuEven:function(a){var c=this;a.bind("contextmenu",function(d){if(c.tab.menu)return c.actionTabid=a.attr("tabid"),c.tab.menu.show({top:d.pageY,left:d.pageX}),0==b(".l-tab-links-item-close",this).length?c.tab.menu.setDisabled("close"):c.tab.menu.setEnabled("close"),!1})}})})(jQuery);(function(b){function a(a){if(!a)return"0.00";a=a.toString().replace(/\$|\,/g,"");isNaN(a)&&(a="0.00");sign=a==(a=Math.abs(a));a=Math.floor(100*a+0.50000000001);cents=a%100;a=Math.floor(a/100).toString();10>cents&&(cents="0"+cents);for(var b=0;b<Math.floor((a.length-(1+b))/3);b++)a=a.substring(0,a.length-(4*b+3))+","+a.substring(a.length-(4*b+3));return""+((sign?"":"-")+""+a+"."+cents)}b.fn.ligerTextBox=function(){return b.ligerui.run.call(this,"ligerTextBox",arguments)};b.fn.ligerGetTextBoxManager=function(){return b.ligerui.run.call(this,"ligerGetTextBoxManager",arguments)};b.ligerDefaults.TextBox={onChangeValue:null,onMouseOver:null,onMouseOut:null,onBlur:null,onFocus:null,width:null,disabled:!1,value:null,nullText:null,digits:!1,number:!1,currency:!1,readonly:!1};b.ligerui.controls.TextBox=function(a,d){b.ligerui.controls.TextBox.base.constructor.call(this,a,d)};b.ligerui.controls.TextBox.ligerExtend(b.ligerui.controls.Input,{__getType:function(){return"TextBox"},__idPrev:function(){return"TextBox"},_init:function(){b.ligerui.controls.TextBox.base._init.call(this);var a=this.options;a.width||(a.width=b(this.element).width());b(this.element).attr("readonly")?a.readonly=!0:a.readonly&&b(this.element).attr("readonly",!0)},_render:function(){var a=this.options;this.inputText=b(this.element);this.wrapper=this.inputText.wrap('\x3cdiv class\x3d"l-text"\x3e\x3c/div\x3e').parent();this.wrapper.append('\x3cdiv class\x3d"l-text-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-text-r"\x3e\x3c/div\x3e');this.inputText.hasClass("l-text-field")||this.inputText.addClass("l-text-field");this._setEvent();(a.digits||a.number||a.currency)&&this.inputText.addClass("l-text-field-number");this.set(a);this.checkValue()},destroy:function(){this.wrapper&&this.wrapper.remove();this.options=null;liger.remove(this)},_getValue:function(){return this.inputText.val()},_setNullText:function(){this.checkNotNull()},checkValue:function(){var b=this.options,d=this.inputText.val()||"";b.currency&&(d=d.replace(/\$|\,/g,""));var g=b.number||b.currency,e=b.digits;""!=d&&g&&!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(d)||e&&!/^\d+$/.test(d)?null!=this.value?this.inputText.val(this.value):this.inputText.val(""):this.value=d;b.currency&&this.inputText.val(a(this.value))},checkNotNull:function(){var a=this.options;a.nullText&&!a.disabled&&(this.inputText.val()||this.inputText.addClass("l-text-field-null").val(a.nullText))},_setEvent:function(){var a=this,d=this.options;a.inputText.bind("blur.textBox",function(){a.trigger("blur");a.checkNotNull();a.checkValue();a.wrapper.removeClass("l-text-focus")}).bind("focus.textBox",function(){a.trigger("focus");d.nullText&&b(this).hasClass("l-text-field-null")&&b(this).removeClass("l-text-field-null").val("");a.wrapper.addClass("l-text-focus")}).change(function(){a.trigger("changeValue",[this.value])});a.wrapper.hover(function(){a.trigger("mouseOver");a.wrapper.addClass("l-text-over")},function(){a.trigger("mouseOut");a.wrapper.removeClass("l-text-over")})},_setDisabled:function(a){var b=this.options;a?(this.inputText.attr("readonly","readonly"),this.wrapper.addClass("l-text-disabled")):b.readonly||(this.inputText.removeAttr("readonly"),this.wrapper.removeClass("l-text-disabled"))},_setWidth:function(a){20<a&&(this.wrapper.css({width:a}),this.inputText.css({width:a-4}))},_setHeight:function(a){10<a&&(this.wrapper.height(a),this.inputText.height(a-2))},_setValue:function(a){null!=a&&this.inputText.val(a)},_setLabel:function(a){var d=this.options;this.labelwrapper?this.labelwrapper.find(".l-text-label").html(a+":\x26nbsp"):(this.labelwrapper=this.wrapper.wrap('\x3cdiv class\x3d"l-labeltext"\x3e\x3c/div\x3e').parent(),a=b('\x3cdiv class\x3d"l-text-label" style\x3d"float:left;"\x3e'+a+":\x26nbsp\x3c/div\x3e"),this.labelwrapper.prepend(a),this.wrapper.css("float","left"),d.labelWidth?this._setLabelWidth(d.labelWidth):d.labelWidth=a.width(),a.height(this.wrapper.height()),d.labelAlign&&this._setLabelAlign(d.labelAlign),this.labelwrapper.append('\x3cbr style\x3d"clear:both;" /\x3e'),this.labelwrapper.width(d.labelWidth+d.width+2))},_setLabelWidth:function(a){this.labelwrapper&&this.labelwrapper.find(".l-text-label").width(a)},_setLabelAlign:function(a){this.labelwrapper&&this.labelwrapper.find(".l-text-label").css("text-align",a)},updateStyle:function(){var a=this.options;this.inputText.attr("readonly")?(this.wrapper.addClass("l-text-readonly"),a.disabled=!0):(this.wrapper.removeClass("l-text-readonly"),a.disabled=!1);this.inputText.attr("disabled")?(this.wrapper.addClass("l-text-disabled"),a.disabled=!0):(this.wrapper.removeClass("l-text-disabled"),a.disabled=!1);this.inputText.hasClass("l-text-field-null")&&this.inputText.val()!=a.nullText&&this.inputText.removeClass("l-text-field-null");this.checkValue()}})})(jQuery);(function(b){b.ligerTip=function(a){return b.ligerui.run.call(null,"ligerTip",arguments)};b.fn.ligerTip=function(a){this.each(function(){var c=b.extend({},b.ligerDefaults.ElementTip,a||{});c.target=c.target||this;c.auto||void 0==a?(c.content||(c.content=this.title,c.removeTitle&&b(this).removeAttr("title")),c.content=c.content||this.title,b(this).bind("mouseover.tip",function(){c.x=b(this).offset().left+b(this).width()+(c.distanceX||0);c.y=b(this).offset().top+(c.distanceY||0);b.ligerTip(c)}).bind("mouseout.tip",function(){var a=b.ligerui.managers[this.ligeruitipid];a&&a.remove()})):c.target.ligeruitipid||(c.x=b(this).offset().left+b(this).width()+(c.distanceX||0),c.y=b(this).offset().top+(c.distanceY||0),c.x=c.x||0,c.y=c.y||0,b.ligerTip(c))});return b.ligerui.get(this,"ligeruitipid")};b.fn.ligerHideTip=function(a){return this.each(function(){var c=a||{};void 0==c.isLabel&&(c.isLabel="label"==this.tagName.toLowerCase()&&null!=b(this).attr("for"));var d=this;if(c.isLabel){c=b("#"+b(this).attr("for"));if(0==c.length)return;d=c[0]}(c=b.ligerui.managers[d.ligeruitipid])&&c.remove()}).unbind("mouseover.tip").unbind("mouseout.tip")};b.fn.ligerGetTipManager=function(){return b.ligerui.get(this)};b.ligerDefaults=b.ligerDefaults||{};b.ligerDefaults.HideTip={};b.ligerDefaults.Tip={content:null,callback:null,width:150,height:null,x:0,y:0,appendIdTo:null,target:null,auto:null,removeTitle:!0};b.ligerDefaults.ElementTip={distanceX:1,distanceY:-3,auto:null,removeTitle:!0};b.ligerMethos.Tip={};b.ligerui.controls.Tip=function(a){b.ligerui.controls.Tip.base.constructor.call(this,null,a)};b.ligerui.controls.Tip.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"Tip"},__idPrev:function(){return"Tip"},_extendMethods:function(){return b.ligerMethos.Tip},_render:function(){var a=this.options,c=b('\x3cdiv class\x3d"l-verify-tip"\x3e\x3cdiv class\x3d"l-verify-tip-corner"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-verify-tip-content"\x3e\x3c/div\x3e\x3c/div\x3e');this.tip=c;this.tip.attr("id",this.id);a.content&&(b("\x3e .l-verify-tip-content:first",c).html(a.content),c.appendTo("body"),c.css({left:a.x,top:a.y}).show(),a.width&&b("\x3e .l-verify-tip-content:first",c).width(a.width-8),a.height&&b("\x3e .l-verify-tip-content:first",c).width(a.height),(eee=a.appendIdTo)&&a.appendIdTo.attr("ligerTipId",this.id),a.target&&(b(a.target).attr("ligerTipId",this.id),a.target.ligeruitipid=this.id),a.callback&&a.callback(c),this.set(a))},_setContent:function(a){b("\x3e .l-verify-tip-content:first",this.tip).html(a)},remove:function(){this.options.appendIdTo&&this.options.appendIdTo.removeAttr("ligerTipId");this.options.target&&(b(this.options.target).removeAttr("ligerTipId"),this.options.target.ligeruitipid=null);this.tip.remove()}})})(jQuery);(function(b){b.fn.ligerToolBar=function(a){return b.ligerui.run.call(this,"ligerToolBar",arguments)};b.fn.ligerGetToolBarManager=function(){return b.ligerui.run.call(this,"ligerGetToolBarManager",arguments)};b.ligerDefaults.ToolBar={};b.ligerMethos.ToolBar={};b.ligerui.controls.ToolBar=function(a,c){b.ligerui.controls.ToolBar.base.constructor.call(this,a,c)};b.ligerui.controls.ToolBar.ligerExtend(b.ligerui.core.UIComponent,{__getType:function(){return"ToolBar"},__idPrev:function(){return"ToolBar"},_extendMethods:function(){return b.ligerMethos.ToolBar},_render:function(){var a=this.options;this.toolbarItemCount=0;this.toolBar=b(this.element);this.toolBar.addClass("l-toolbar");this.set(a)},_setItems:function(a){var c=this;c.toolBar.html("");b(a).each(function(a,b){c.addItem(b)})},removeItem:function(a){b("\x3e .l-toolbar-item[toolbarid\x3d"+a+"]",this.toolBar).remove()},setEnabled:function(a){b("\x3e .l-toolbar-item[toolbarid\x3d"+a+"]",this.toolBar).removeClass("l-toolbar-item-disable")},setDisabled:function(a){b("\x3e .l-toolbar-item[toolbarid\x3d"+a+"]",this.toolBar).addClass("l-toolbar-item-disable")},isEnable:function(a){return!b("\x3e .l-toolbar-item[toolbarid\x3d"+a+"]",this.toolBar).hasClass("l-toolbar-item-disable")},addItem:function(a){var c=this;if(a.line)c.toolBar.append('\x3cdiv class\x3d"l-bar-separator"\x3e\x3c/div\x3e');else{var d=b('\x3cdiv class\x3d"l-toolbar-item l-panel-btn"\x3e\x3cspan\x3e\x3c/span\x3e\x3cdiv class\x3d"l-panel-btn-l"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-panel-btn-r"\x3e\x3c/div\x3e\x3c/div\x3e');c.toolBar.append(d);a.id||(a.id="item-"+ ++c.toolbarItemCount);d.attr("toolbarid",a.id);a.img?(d.append("\x3cimg src\x3d'"+a.img+"' /\x3e"),d.addClass("l-toolbar-item-hasicon")):a.icon?(d.append("\x3cdiv class\x3d'l-icon l-icon-"+a.icon+"'\x3e\x3c/div\x3e"),d.addClass("l-toolbar-item-hasicon")):a.color&&(d.append("\x3cdiv class\x3d'l-toolbar-item-color' style\x3d'background:"+a.color+"'\x3e\x3c/div\x3e"),d.addClass("l-toolbar-item-hasicon"));a.text&&b("span:first",d).html(a.text);a.disable&&d.addClass("l-toolbar-item-disable");a.click&&d.click(function(){b(this).hasClass("l-toolbar-item-disable")||a.click(a)});a.menu?(a.menu=b.ligerMenu(a.menu),d.hover(function(){if(!b(this).hasClass("l-toolbar-item-disable")){c.actionMenu&&c.actionMenu.hide();var d=b(this).offset().left,e=b(this).offset().top+b(this).height();a.menu.show({top:e,left:d});c.actionMenu=a.menu;b(this).addClass("l-panel-btn-over")}},function(){b(this).hasClass("l-toolbar-item-disable")||b(this).removeClass("l-panel-btn-over")})):d.hover(function(){b(this).hasClass("l-toolbar-item-disable")||b(this).addClass("l-panel-btn-over")},function(){b(this).hasClass("l-toolbar-item-disable")||b(this).removeClass("l-panel-btn-over")})}}});b.ligerui.controls.ToolBar.prototype.setEnable=b.ligerui.controls.ToolBar.prototype.setEnabled;b.ligerui.controls.ToolBar.prototype.setDisable=b.ligerui.controls.ToolBar.prototype.setDisabled})(jQuery);(function(b){b.fn.ligerTree=function(a){return b.ligerui.run.call(this,"ligerTree",arguments)};b.fn.ligerGetTreeManager=function(){return b.ligerui.run.call(this,"ligerGetTreeManager",arguments)};b.ligerDefaults.Tree={url:null,data:null,checkbox:!0,autoCheckboxEven:!0,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url"],treeLine:!0,nodeWidth:90,statusName:"__status",isLeaf:null,single:!1,needCancel:!0,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:!0,iconFieldName:"icon",nodeDraggable:!1,nodeDraggingRender:null,btnClickToToggleOnly:!0,ajaxType:"post",render:null,selectable:null,isExpand:null,delay:null};b.ligerui.controls.Tree=function(a,c){b.ligerui.controls.Tree.base.constructor.call(this,a,c)};b.ligerui.controls.Tree.ligerExtend(b.ligerui.core.UIComponent,{_init:function(){b.ligerui.controls.Tree.base._init.call(this);var a=this.options;a.single&&(a.autoCheckboxEven=!1)},_render:function(){var a=this.options;this.set(a,!0);this.tree=b(this.element);this.tree.addClass("l-tree");this.toggleNodeCallbacks=[];this.sysAttribute=["isexpand","ischecked","href","style","delay"];this.loading=b("\x3cdiv class\x3d'l-tree-loading'\x3e\x3c/div\x3e");this.tree.after(this.loading);this.data=[];this.maxOutlineLevel=1;this.treedataindex=0;this._applyTree();this._setTreeEven();this.set(a,!1)},_setTreeLine:function(a){a?this.tree.removeClass("l-tree-noline"):this.tree.addClass("l-tree-noline")},_setParms:function(){var a=this.options;b.isFunction(a.parms)&&(a.parms=a.parms())},_setUrl:function(a){a&&(this.clear(),this.loadData(null,a))},_setData:function(a){a&&(this.clear(),this.append(null,a))},setData:function(a){this.set("data",a)},getData:function(){return this.data},hasChildren:function(a){return this.options.isLeaf?!this.options.isLeaf(a):a.children?!0:!1},getParent:function(a,c){a=this.getNodeDom(a);var d=this.getParentTreeItem(a,c);if(!d)return null;d=b(d).attr("treedataindex");return this._getDataNodeByTreeDataIndex(d)},getParentTreeItem:function(a,c){a=this.getNodeDom(a);var d=b(a);if(d.parent().hasClass("l-tree"))return null;if(void 0==c)return 0==d.parent().parent("li").length?null:d.parent().parent("li")[0];for(var g=parseInt(d.attr("outlinelevel")),g=g-1;g>=c;g--)d=d.parent().parent("li");return d[0]},getChecked:function(){var a=this;if(!this.options.checkbox)return null;var c=[];b(".l-checkbox-checked",a.tree).parent().parent("li").each(function(){var d=parseInt(b(this).attr("treedataindex"));c.push({target:this,data:a._getDataNodeByTreeDataIndex(a.data,d)})});return c},refreshTree:function(){var a=this;b.each(this.getChecked(),function(c,d){a._setParentCheckboxStatus(b(d.target))})},getSelected:function(){var a={};a.target=b(".l-selected",this.tree).parent("li")[0];if(a.target){var c=parseInt(b(a.target).attr("treedataindex"));a.data=this._getDataNodeByTreeDataIndex(this.data,c);return a}return null},upgrade:function(a){var c=this;b(".l-note",a).each(function(){b(this).removeClass("l-note").addClass("l-expandable-open")});b(".l-note-last",a).each(function(){b(this).removeClass("l-note-last").addClass("l-expandable-open")});b("."+c._getChildNodeClassName(),a).each(function(){b(this).removeClass(c._getChildNodeClassName()).addClass(c._getParentNodeClassName(!0))})},demotion:function(a){var c=this;if(a||"li"==a[0].tagName.toLowerCase()){var d=b(a).hasClass("l-last");b(".l-expandable-open",a).each(function(){b(this).removeClass("l-expandable-open").addClass(d?"l-note-last":"l-note")});b(".l-expandable-close",a).each(function(){b(this).removeClass("l-expandable-close").addClass(d?"l-note-last":"l-note")});b("."+c._getParentNodeClassName(!0),a).each(function(){b(this).removeClass(c._getParentNodeClassName(!0)).addClass(c._getChildNodeClassName())})}},collapseAll:function(){b(".l-expandable-open",this.tree).click()},expandAll:function(){b(".l-expandable-close",this.tree).click()},loadData:function(a,c,d,g){var e=this,f=this.options;g=b.extend({showLoading:function(){e.loading.show()},hideLoading:function(){e.loading.hide()}},g||{});f=f.ajaxType;d=d||[];b.ajax({type:f,url:c,data:d,dataType:"json",beforeSend:function(){g.showLoading()},success:function(b){b&&(g.hideLoading(),e.append(a,b),e.trigger("success",[b]))},error:function(a,b,c){try{g.hideLoading(),e.trigger("error",[a,b,c])}catch(d){}}})},clear:function(){this.toggleNodeCallbacks=[];this.data=null;this.data=[];this.nodes=null;this.tree.html("")},getNodeDom:function(a){return null==a?a:"string"==typeof a||"number"==typeof a?b("li[treedataindex\x3d"+a+"]",this.tree).get(0):"object"==typeof a&&"treedataindex"in a?this.getNodeDom(a.treedataindex):a},hide:function(a){(a=this.getNodeDom(a))&&b(a).hide()},show:function(a){(a=this.getNodeDom(a))&&b(a).show()},remove:function(a){var c=this.options;a=this.getNodeDom(a);var d=parseInt(b(a).attr("treedataindex"));(d=this._getDataNodeByTreeDataIndex(this.data,d))&&this._setTreeDataStatus([d],"delete");d=this.getParentTreeItem(a);c.checkbox&&this._setParentCheckboxStatus(b(a));b(a).remove();this._updateStyle(d?b("ul:first",d):this.tree)},_updateStyle:function(a){var c=this;a=b(" \x3e li",a);var d=a.length;d&&a.each(function(a,e){0!=a||b(this).hasClass("l-first")||b(this).addClass("l-first");a!=d-1||b(this).hasClass("l-last")||b(this).addClass("l-last");0==a&&a==d-1&&b(this).addClass("l-onlychild");b("\x3e div .l-note,\x3e div .l-note-last",this).removeClass("l-note l-note-last").addClass(a==d-1?"l-note-last":"l-note");c._setTreeItem(this,{isLast:a==d-1})})},update:function(a,c){var d=this.options;a=this.getNodeDom(a);var g=parseInt(b(a).attr("treedataindex"));nodedata=this._getDataNodeByTreeDataIndex(this.data,g);for(var e in c)nodedata[e]=c[e],e==d.textFieldName&&b("\x3e .l-body \x3e span",a).text(c[e])},append:function(a,c,d,g){var e=this.options;a=this.getNodeDom(a);if(!1==this.trigger("beforeAppend",[a,c])||!c||!c.length)return!1;e.idFieldName&&e.parentIDFieldName&&(c=this.arrayToTree(c,e.idFieldName,e.parentIDFieldName));this._addTreeDataIndexToData(c);this._setTreeDataStatus(c,"add");null!=d&&(d=this.getNodeDom(d));this.trigger("append",[a,c]);this._appendData(a,c);if(null==a){var f=this._getTreeHTMLByData(c,1,[],!0);f[f.length-1]=f[0]="";null!=d?(b(d)[g?"after":"before"](f.join("")),this._updateStyle(a?b("ul:first",a):this.tree)):(0<b("\x3e li:last",this.tree).length&&this._setTreeItem(b("\x3e li:last",this.tree)[0],{isLast:!1}),this.tree.append(f.join("")));b(".l-body",this.tree).hover(function(){b(this).addClass("l-over")},function(){b(this).removeClass("l-over")});this._upadteTreeWidth()}else{e=b(a);f=parseInt(e.attr("outlinelevel"));0<b("\x3e ul",e).length||(e.append("\x3cul class\x3d'l-children'\x3e\x3c/ul\x3e"),this.upgrade(a));for(var h=[],k=1;k<=f-1;k++){var m=b(this.getParentTreeItem(a,k));h.push(m.hasClass("l-last"))}h.push(e.hasClass("l-last"));f=this._getTreeHTMLByData(c,f+1,h,!0);f[f.length-1]=f[0]="";null!=d?(b(d)[g?"after":"before"](f.join("")),this._updateStyle(a?b("ul:first",a):this.tree)):(0<b("\x3e .l-children \x3e li:last",e).length&&this._setTreeItem(b("\x3e .l-children \x3e li:last",e)[0],{isLast:!1}),b("\x3e.l-children",a).append(f.join("")));this._upadteTreeWidth();b("\x3e.l-children .l-body",a).hover(function(){b(this).addClass("l-over")},function(){b(this).removeClass("l-over")})}this.trigger("afterAppend",[a,c])},cancelSelect:function(a){var c=this.options;a=this.getNodeDom(a);a=b(a);var d=parseInt(a.attr("treedataindex")),d=this._getDataNodeByTreeDataIndex(this.data,d),g=b("\x3ediv:first",a);c.checkbox?b(".l-checkbox",g).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"):g.removeClass("l-selected");this.trigger("cancelSelect",[{data:d,target:a[0]}])},selectNode:function(a){var c=this,d=this.options,g=null;if("function"==typeof a)g=a;else{if("object"==typeof a){var e=b(a),f=parseInt(e.attr("treedataindex")),f=c._getDataNodeByTreeDataIndex(c.data,f),h=b("\x3ediv:first",e);d.checkbox?b(".l-checkbox",h).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"):h.addClass("l-selected");c.trigger("select",[{data:f,target:e[0]}]);return}g=function(b){return b[d.idFieldName]?b[d.idFieldName].toString()==a.toString():!1}}b("li",c.tree).each(function(){var a=b(this),a=parseInt(a.attr("treedataindex")),d=c._getDataNodeByTreeDataIndex(c.data,a);g(d,a)?c.selectNode(this):c.cancelSelect(this)})},getTextByID:function(a){var b=this.options;return(a=this.getDataByID(a))?a[b.textFieldName]:null},getDataByID:function(a){var c=this,d=this.options,g=null;b("li",c.tree).each(function(){if(!g){var e=b(this),e=parseInt(e.attr("treedataindex")),e=c._getDataNodeByTreeDataIndex(c.data,e);e[d.idFieldName].toString()==a.toString()&&(g=e)}});return g},arrayToTree:function(a,b,d){if(!a||!a.length)return[];for(var g=[],e={},f=a.length,h=0;h<f;h++){var k=a[h];e[k[b]]=k}for(h=0;h<f;h++)b=a[h],(k=e[b[d]])?(k.children=k.children||[],k.children.push(b)):g.push(b);return g},_getDataNodeByTreeDataIndex:function(a,b){for(var d=0;d<a.length;d++){if(a[d].treedataindex==b)return a[d];if(a[d].children){var g=this._getDataNodeByTreeDataIndex(a[d].children,b);if(g)return g}}return null},_setTreeDataStatus:function(a,c){var d=this,g=this.options;b(a).each(function(){this[g.statusName]=c;this.children&&d._setTreeDataStatus(this.children,c)})},_addTreeDataIndexToData:function(a){var c=this;b(a).each(function(){void 0==this.treedataindex&&(this.treedataindex=c.treedataindex++,this.children&&c._addTreeDataIndexToData(this.children))})},_addToNodes:function(a){var c=this;c.nodes=c.nodes||[];c.nodes.push(a);a.children&&b(a.children).each(function(a,b){c._addToNodes(b)})},_appendData:function(a,c){var d=this,g=parseInt(b(a).attr("treedataindex")),e=d._getDataNodeByTreeDataIndex(d.data,g);void 0==d.treedataindex&&(d.treedataindex=0);e&&void 0==e.children&&(e.children=[]);b(c).each(function(a,b){e?e.children[e.children.length]=b:d.data[d.data.length]=b;d._addToNodes(b)})},_setTreeItem:function(a,c){if(c){a=this.getNodeDom(a);var d=b(a),g=parseInt(d.attr("outlinelevel"));void 0!=c.isLast&&(!0==c.isLast?(d.removeClass("l-last").addClass("l-last"),b("\x3e div .l-note",d).removeClass("l-note").addClass("l-note-last"),b(".l-children li",d).find(".l-box:eq("+(g-1)+")").removeClass("l-line")):!1==c.isLast&&(d.removeClass("l-last"),b("\x3e div .l-note-last",d).removeClass("l-note-last").addClass("l-note"),b(".l-children li",d).find(".l-box:eq("+(g-1)+")").removeClass("l-line").addClass("l-line")))}},_upadteTreeWidth:function(){var a=this.options,b=22*this.maxOutlineLevel;a.checkbox&&(b+=22);if(a.parentIcon||a.childIcon)b+=22;b+=a.nodeWidth;this.tree.width(b)},_getChildNodeClassName:function(){return"l-tree-icon-"+this.options.childIcon},_getParentNodeClassName:function(a){var b="l-tree-icon-"+this.options.parentIcon;a&&(b+="-open");return b},_isExpand:function(a,b){var d=this.options,g=null!=a.isExpand?a.isExpand:null!=a.isexpand?a.isexpand:d.isExpand;if(null==g)return!0;"function"==typeof g&&(g=d.isExpand({data:a,level:b}));return"boolean"==typeof g?g:"string"==typeof g?"true"==g:"number"==typeof g?g>b:!0},_getDelay:function(a,c){var d=this.options,d=null!=a.delay?a.delay:d.delay;if(null==d)return!1;"function"==typeof d&&(d=d({data:a,level:c}));if("boolean"==typeof d)return d;if("string"==typeof d)return{url:d};"number"==typeof d&&(d=[d]);return b.isArray(d)?-1!=b.inArray(c,d):"object"==typeof d&&d.url?d:!1},_getTreeHTMLByData:function(a,c,d,g){var e=this,f=this.options;e.maxOutlineLevel<c&&(e.maxOutlineLevel=c);d=d||[];c=c||1;var h=[];g?h.push("\x3cul class\x3d'l-children'\x3e"):h.push('\x3cul class\x3d"l-children" style\x3d"display:none"\x3e');for(g=0;g<a.length;g++){var k=a[g],m=0==g,n=g==a.length-1,q=e._getDelay(k,c),r=q?!1:e._isExpand(k,c);h.push("\x3cli ");void 0!=k.treedataindex&&h.push('treedataindex\x3d"'+k.treedataindex+'" ');r&&h.push("isexpand\x3d"+k.isexpand+" ");h.push("outlinelevel\x3d"+c+" ");for(var s=0;s<e.sysAttribute.length;s++)b(this).attr(e.sysAttribute[s])&&(a[dataindex][e.sysAttribute[s]]=b(this).attr(e.sysAttribute[s]));for(s=0;s<f.attribute.length;s++)k[f.attribute[s]]&&h.push(f.attribute[s]+'\x3d"'+k[f.attribute[s]]+'" ');h.push('class\x3d"');m&&h.push("l-first ");n&&h.push("l-last ");m&&n&&h.push("l-onlychild ");h.push('"');h.push("\x3e");h.push('\x3cdiv class\x3d"l-body');f.selectable&&!1==f.selectable(k)&&h.push(" l-unselectable");h.push('"\x3e');for(m=0;m<=c-2;m++)d[m]?h.push('\x3cdiv class\x3d"l-box"\x3e\x3c/div\x3e'):h.push('\x3cdiv class\x3d"l-box l-line"\x3e\x3c/div\x3e');e.hasChildren(k)?(r?h.push('\x3cdiv class\x3d"l-box l-expandable-open"\x3e\x3c/div\x3e'):h.push('\x3cdiv class\x3d"l-box l-expandable-close"\x3e\x3c/div\x3e'),f.checkbox&&(k.ischecked?h.push('\x3cdiv class\x3d"l-box l-checkbox l-checkbox-checked"\x3e\x3c/div\x3e'):h.push('\x3cdiv class\x3d"l-box l-checkbox l-checkbox-unchecked"\x3e\x3c/div\x3e')),f.parentIcon&&(h.push('\x3cdiv class\x3d"l-box l-tree-icon '),h.push(e._getParentNodeClassName(r?!0:!1)+" "),f.iconFieldName&&k[f.iconFieldName]&&h.push("l-tree-icon-none"),h.push('"\x3e'),f.iconFieldName&&k[f.iconFieldName]&&h.push('\x3cimg src\x3d"'+k[f.iconFieldName]+'" /\x3e'),h.push("\x3c/div\x3e"))):(n?h.push('\x3cdiv class\x3d"l-box l-note-last"\x3e\x3c/div\x3e'):h.push('\x3cdiv class\x3d"l-box l-note"\x3e\x3c/div\x3e'),f.checkbox&&(k.ischecked?h.push('\x3cdiv class\x3d"l-box l-checkbox l-checkbox-checked"\x3e\x3c/div\x3e'):h.push('\x3cdiv class\x3d"l-box l-checkbox l-checkbox-unchecked"\x3e\x3c/div\x3e')),f.childIcon&&(h.push('\x3cdiv class\x3d"l-box l-tree-icon '),h.push(e._getChildNodeClassName()+" "),f.iconFieldName&&k[f.iconFieldName]&&h.push("l-tree-icon-none"),h.push('"\x3e'),f.iconFieldName&&k[f.iconFieldName]&&h.push('\x3cimg src\x3d"'+k[f.iconFieldName]+'" /\x3e'),h.push("\x3c/div\x3e")));f.render?h.push("\x3cspan\x3e"+f.render(k,k[f.textFieldName])+"\x3c/span\x3e"):h.push("\x3cspan\x3e"+k[f.textFieldName]+"\x3c/span\x3e");h.push("\x3c/div\x3e");if(e.hasChildren(k)){for(var t=[],m=0;m<d.length;m++)t.push(d[m]);t.push(n);q?!0==q?e.toggleNodeCallbacks.push({data:k,callback:function(a,d){var f=e._getTreeHTMLByData(d.children,c+1,t,r).join("");b(a).append(f);b("\x3e.l-children .l-body",a).hover(function(){b(this).addClass("l-over")},function(){b(this).removeClass("l-over")});e._removeToggleNodeCallback(d)}}):q.url&&function(a,c,d){e.toggleNodeCallbacks.push({data:a,callback:function(a,f){e.loadData(a,c,d,{showLoading:function(){b("div.l-expandable-close:first",a).addClass("l-box-loading")},hideLoading:function(){b("div.l-box-loading:first",a).removeClass("l-box-loading")}});e._removeToggleNodeCallback(f)}})}(k,q.url,q.parms):h.push(e._getTreeHTMLByData(k.children,c+1,t,r).join(""))}h.push("\x3c/li\x3e")}h.push("\x3c/ul\x3e");return h},_removeToggleNodeCallback:function(a){for(var b=0;b<=this.toggleNodeCallbacks.length;b++)if(this.toggleNodeCallbacks[b]&&this.toggleNodeCallbacks[b].data==a){this.toggleNodeCallbacks.splice(b,1);break}},_getDataByTreeHTML:function(a){var c=this,d=this.options,g=[];b("\x3e li",a).each(function(a,f){var h=g.length;g[h]={treedataindex:c.treedataindex++};g[h][d.textFieldName]=b("\x3e span,\x3e a",this).html();for(var k=0;k<c.sysAttribute.length;k++)b(this).attr(c.sysAttribute[k])&&(g[h][c.sysAttribute[k]]=b(this).attr(c.sysAttribute[k]));for(k=0;k<d.attribute.length;k++)b(this).attr(d.attribute[k])&&(g[h][d.attribute[k]]=b(this).attr(d.attribute[k]));0<b("\x3e ul",this).length&&(g[h].children=c._getDataByTreeHTML(b("\x3e ul",this)))});return g},_applyTree:function(){this.data=this._getDataByTreeHTML(this.tree);var a=this._getTreeHTMLByData(this.data,1,[],!0);a[a.length-1]=a[0]="";this.tree.html(a.join(""));this._upadteTreeWidth();b(".l-body",this.tree).hover(function(){b(this).addClass("l-over")},function(){b(this).removeClass("l-over")})},_getSrcElementByEvent:function(a){var c=a.target||a.srcElement;a=c.tagName.toLowerCase();var d=b(c).parents().add(c),c=function(a){for(var c=d.length-1;0<=c;c--)if(b(d[c]).hasClass(a))return d[c];return null};if(-1==d.index(this.element))return{out:!0};a={tree:c("l-tree"),node:c("l-body"),checkbox:c("l-checkbox"),icon:c("l-tree-icon"),text:"span"==a};a.node&&(c=parseInt(b(a.node).parent().attr("treedataindex")),a.data=this._getDataNodeByTreeDataIndex(this.data,c));return a},_setTreeEven:function(){var a=this,c=this.options;a.hasBind("contextmenu")&&a.tree.bind("contextmenu",function(c){var g=c.target||c.srcElement,e=null;"a"==g.tagName.toLowerCase()||"span"==g.tagName.toLowerCase()||b(g).hasClass("l-box")?e=b(g).parent().parent():b(g).hasClass("l-body")?e=b(g).parent():"li"==g.tagName.toLowerCase()&&(e=b(g));if(e)return g=parseInt(e.attr("treedataindex")),g=a._getDataNodeByTreeDataIndex(a.data,g),a.trigger("contextmenu",[{data:g,target:e[0]},c])});a.tree.click(function(d){d=d.target||d.srcElement;var g=null;if(g="a"==d.tagName.toLowerCase()||"span"==d.tagName.toLowerCase()||b(d).hasClass("l-box")?b(d).parent().parent():b(d).hasClass("l-body")?b(d).parent():b(d)){var e=parseInt(g.attr("treedataindex")),f=a._getDataNodeByTreeDataIndex(a.data,e),e=b("div.l-body:first",g).find("div.l-expandable-open:first,div.l-expandable-close:first"),h=b(d).hasClass("l-expandable-open")||b(d).hasClass("l-expandable-close");if(!b(d).hasClass("l-checkbox")&&!h&&!g.hasClass("l-unselectable"))if(b("\x3ediv:first",g).hasClass("l-selected")&&c.needCancel){if(!1==a.trigger("beforeCancelSelect",[{data:f,target:g[0]}]))return!1;b("\x3ediv:first",g).removeClass("l-selected");a.trigger("cancelSelect",[{data:f,target:g[0]}])}else{if(!1==a.trigger("beforeSelect",[{data:f,target:g[0]}]))return!1;b(".l-body",a.tree).removeClass("l-selected");b("\x3ediv:first",g).addClass("l-selected");a.trigger("select",[{data:f,target:g[0]}])}if(b(d).hasClass("l-checkbox"))c.autoCheckboxEven?(b(d).hasClass("l-checkbox-unchecked")?(b(d).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),b(".l-children .l-checkbox",g).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),a.trigger("check",[{data:f,target:g[0]},!0])):b(d).hasClass("l-checkbox-checked")?(b(d).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),b(".l-children .l-checkbox",g).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked"),a.trigger("check",[{data:f,target:g[0]},!1])):b(d).hasClass("l-checkbox-incomplete")&&(b(d).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked"),b(".l-children .l-checkbox",g).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),a.trigger("check",[{data:f,target:g[0]},!0])),a._setParentCheckboxStatus(g)):b(d).hasClass("l-checkbox-unchecked")?(b(d).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),c.single&&b(".l-checkbox",a.tree).not(d).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),a.trigger("check",[{data:f,target:g[0]},!0])):b(d).hasClass("l-checkbox-checked")&&(b(d).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),a.trigger("check",[{data:f,target:g[0]},!1]));else if(e.hasClass("l-expandable-open")&&(!c.btnClickToToggleOnly||h)){if(!1==a.trigger("beforeCollapse",[{data:f,target:g[0]}]))return!1;e.removeClass("l-expandable-open").addClass("l-expandable-close");c.slide?b("\x3e .l-children",g).slideToggle("fast"):b("\x3e .l-children",g).hide();b("\x3e div ."+a._getParentNodeClassName(!0),g).removeClass(a._getParentNodeClassName(!0)).addClass(a._getParentNodeClassName());a.trigger("collapse",[{data:f,target:g[0]}])}else if(e.hasClass("l-expandable-close")&&(!c.btnClickToToggleOnly||h)){if(!1==a.trigger("beforeExpand",[{data:f,target:g[0]}]))return!1;b(a.toggleNodeCallbacks).each(function(){this.data==f&&this.callback(g[0],f)});e.removeClass("l-expandable-close").addClass("l-expandable-open");d=function(){a.trigger("expand",[{data:f,target:g[0]}])};c.slide?b("\x3e .l-children",g).slideToggle("fast",d):(b("\x3e .l-children",g).show(),d());b("\x3e div ."+a._getParentNodeClassName(),g).removeClass(a._getParentNodeClassName()).addClass(a._getParentNodeClassName(!0))}a.trigger("click",[{data:f,target:g[0]}])}});b.fn.ligerDrag&&c.nodeDraggable&&(a.nodeDroptip=b("\x3cdiv class\x3d'l-drag-nodedroptip' style\x3d'display:none'\x3e\x3c/div\x3e").appendTo("body"),a.tree.ligerDrag({revert:!0,animate:!1,proxyX:20,proxyY:20,proxy:function(d,g){if(a._getSrcElementByEvent(g).node){var e="dragging";if(c.nodeDraggingRender)e=c.nodeDraggingRender(d.draggingNodes,d,a);else{var e="",f=!1,h;for(h in d.draggingNodes){var k=d.draggingNodes[h];f&&(e+=",");e+=k.text;f=!0}}return b("\x3cdiv class\x3d'l-drag-proxy' style\x3d'display:none'\x3e\x3cdiv class\x3d'l-drop-icon l-drop-no'\x3e\x3c/div\x3e"+e+"\x3c/div\x3e").appendTo("body")}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default");a.children[this.id]=this},onStartDrag:function(b,g){if(2==g.button)return!1;this.set("cursor","default");var e=a._getSrcElementByEvent(g);if(e.checkbox)return!1;if(c.checkbox){var f=a.getChecked();this.draggingNodes=[];for(var h in f)this.draggingNodes.push(f[h].data);if(!this.draggingNodes||!this.draggingNodes.length)return!1}else this.draggingNodes=[e.data];this.draggingNode=e.data;this.set("cursor","move");a.nodedragging=!0;this.validRange={top:a.tree.offset().top,bottom:a.tree.offset().top+a.tree.height(),left:a.tree.offset().left,right:a.tree.offset().left+a.tree.width()}},onDrag:function(c,g){var e=this.draggingNode;if(!e)return!1;var f=this.draggingNodes?this.draggingNodes:[e];null==a.nodeDropIn&&(a.nodeDropIn=-1);var h=g.pageX,k=g.pageY,m=!1,n=this.validRange;if(h<n.left||h>n.right||k>n.bottom||k<n.top)a.nodeDropIn=-1,a.nodeDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");else for(var q=0,r=a.nodes.length;q<r;q++){var s=a.nodes[q],n=s.treedataindex;e.treedataindex==n&&(m=!0);if(-1==b.inArray(s,f)&&(s=m?!0:!1,-1==a.nodeDropIn||a.nodeDropIn==n)){var t=b("li[treedataindex\x3d"+n+"] div:first",a.tree),u=t.offset(),w=u.top,x=u.top+t.height(),v=a.tree.offset().left,y=a.tree.offset().left+a.tree.width();if(h>v&&h<y&&k>w&&k<x){e=u.top;s&&(e+=t.height());a.nodeDroptip.css({left:v,top:e,width:y-v}).show();a.nodeDropIn=n;a.nodeDropDir=s?"bottom":"top";k>w+7&&k<x-7?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),a.nodeDroptip.hide(),a.nodeDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),a.nodeDroptip.show(),a.nodeDropInParent=!1);break}else-1!=a.nodeDropIn&&(a.nodeDropIn=-1,a.nodeDropInParent=!1,a.nodeDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}}},onStopDrag:function(c,g){var e=this.draggingNodes;a.nodedragging=!1;if(-1!=a.nodeDropIn){for(var f=0;f<e.length;f++){var h=e[f].children;h&&(e=b.grep(e,function(a,c){return-1==b.inArray(a,h)}))}for(f in e){var k=e[f];a.nodeDropInParent?(a.remove(k),a.append(a.nodeDropIn,[k])):(a.remove(k),a.append(a.getParent(a.nodeDropIn),[k],a.nodeDropIn,"bottom"==a.nodeDropDir))}a.nodeDropIn=-1}a.nodeDroptip.hide();this.set("cursor","default")}}))},_setParentCheckboxStatus:function(a){var c=0==b(".l-checkbox-unchecked",a.parent()).length,d=0==b(".l-checkbox-checked",a.parent()).length;c?a.parent().prev().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked"):d?a.parent().prev().find("\x3e .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked"):a.parent().prev().find("\x3e .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete");0<a.parent().parent("li").length&&this._setParentCheckboxStatus(a.parent().parent("li"))}})})(jQuery);(function(b){var a=b.ligerui;a.windowCount=0;b.ligerWindow=function(b){return a.run.call(null,"ligerWindow",arguments,{isStatic:!0})};b.ligerWindow.show=function(a){return b.ligerWindow(a)};b.ligerDefaults.Window={showClose:!0,showMax:!0,showToggle:!0,showMin:!0,title:"window",load:!1,onLoaded:null,onClose:null,onRegain:null,onMax:null,modal:!1};b.ligerMethos.Window={};a.controls.Window=function(b){a.controls.Window.base.constructor.call(this,null,b)};a.controls.Window.ligerExtend(a.core.Win,{__getType:function(){return"Window"},__idPrev:function(){return"Window"},_extendMethods:function(){return b.ligerMethos.Window},_render:function(){var c=this,d=this.options;c.window=b('\x3cdiv class\x3d"l-window"\x3e\x3cdiv class\x3d"l-window-header"\x3e\x3cdiv class\x3d"l-window-header-buttons"\x3e\x3cdiv class\x3d"l-window-toggle"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-window-max"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-window-close"\x3e\x3c/div\x3e\x3cdiv class\x3d"l-clear"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"l-window-header-inner"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"l-window-content"\x3e\x3c/div\x3e\x3c/div\x3e');c.element=c.window[0];c.window.content=b(".l-window-content",c.window);c.window.header=b(".l-window-header",c.window);c.window.buttons=b(".l-window-header-buttons:first",c.window);if(d.url)if(d.load)c.window.content.load(d.url,function(){c.trigger("loaded")}),c.window.content.addClass("l-window-content-scroll");else{var g=b("\x3ciframe frameborder\x3d'0' src\x3d'"+d.url+"'\x3e\x3c/iframe\x3e"),e="ligeruiwindow"+a.windowCount++;d.name&&(e=d.name);g.attr("name",e).attr("id",e);d.framename=e;g.appendTo(c.window.content);c.iframe=g}else d.content?b("\x3cdiv\x3e"+d.content+"\x3c/div\x3e").appendTo(c.window.content):d.target&&(c.window.content.append(d.target),d.target.show());this.mask();c.active();b("body").append(c.window);c.set({width:d.width,height:d.height});e=g=0;null!=d.left?g=d.left:d.left=g=0.5*(b(window).width()-c.window.width());null!=d.top?e=d.top:d.top=e=0.5*(b(window).height()-c.window.height())+b(window).scrollTop()-10;0>g&&(d.left=g=0);0>e&&(d.top=e=0);c.set(d);d.framename&&b("\x3eiframe",c.window.content).attr("name",d.framename);d.showToggle||b(".l-window-toggle",c.window).remove();d.showMax||b(".l-window-max",c.window).remove();d.showClose||b(".l-window-close",c.window).remove();c._saveStatus();b.fn.ligerDrag&&(c.draggable=c.window.drag=c.window.ligerDrag({handler:".l-window-header-inner",onStartDrag:function(){c.active()},onStopDrag:function(){c._saveStatus()},animate:!1}));b.fn.ligerResizable&&(c.resizeable=c.window.resizable=c.window.ligerResizable({onStartResize:function(){c.active();b(".l-window-max",c.window).removeClass("l-window-regain")},onStopResize:function(a,b){var d=0,e=0;isNaN(parseInt(c.window.css("top")))||(d=parseInt(c.window.css("top")));isNaN(parseInt(c.window.css("left")))||(e=parseInt(c.window.css("left")));a.diffTop&&c.window.css({top:d+a.diffTop});a.diffLeft&&c.window.css({left:e+a.diffLeft});a.newWidth&&c.window.width(a.newWidth);a.newHeight&&c.window.content.height(a.newHeight-28);c._saveStatus();return!1}}),c.window.append("\x3cdiv class\x3d'l-btn-nw-drop'\x3e\x3c/div\x3e"));b(".l-window-toggle",c.window).click(function(){b(this).hasClass("l-window-toggle-close")?(c.collapsed=!1,b(this).removeClass("l-window-toggle-close")):(c.collapsed=!0,b(this).addClass("l-window-toggle-close"));c.window.content.slideToggle()}).hover(function(){c.window.drag&&c.window.drag.set("disabled",!0)},function(){c.window.drag&&c.window.drag.set("disabled",!1)});b(".l-window-close",c.window).click(function(){if(!1==c.trigger("close"))return!1;c.window.hide();a.win.removeTask(c)}).hover(function(){c.window.drag&&c.window.drag.set("disabled",!0)},function(){c.window.drag&&c.window.drag.set("disabled",!1)});b(".l-window-max",c.window).click(function(){if(b(this).hasClass("l-window-regain")){if(!1==c.trigger("regain"))return!1;c.window.width(c._width).css({left:c._left,top:c._top});c.window.content.height(c._height-28);b(this).removeClass("l-window-regain")}else{if(!1==c.trigger("max"))return!1;c.window.width(b(window).width()-2).css({left:0,top:0});c.window.content.height(b(window).height()-28).show();b(this).addClass("l-window-regain")}})},_saveStatus:function(){this._width=this.window.width();this._height=this.window.height();var a=0,b=0;isNaN(parseInt(this.window.css("top")))||(a=parseInt(this.window.css("top")));isNaN(parseInt(this.window.css("left")))||(b=parseInt(this.window.css("left")));this._top=a;this._left=b},min:function(){this.window.hide();this.minimize=!0;this.actived=!1},_setShowMin:function(c){var d=this;c?d.winmin||(d.winmin=b('\x3cdiv class\x3d"l-window-min"\x3e\x3c/div\x3e').prependTo(d.window.buttons).click(function(){d.min()}),a.win.addTask(d)):d.winmin&&(d.winmin.remove(),d.winmin=null)},_setLeft:function(a){null!=a&&this.window.css({left:a})},_setTop:function(a){null!=a&&this.window.css({top:a})},_setWidth:function(a){0<a&&this.window.width(a)},_setHeight:function(a){28<a&&this.window.content.height(a-28)},_setTitle:function(a){a&&b(".l-window-header-inner",this.window.header).html(a)},_setUrl:function(a){var b=this,g=this.options;g.url=a;g.load?b.window.content.html("").load(g.url,function(){if(!1==b.trigger("loaded"))return!1}):b.jiframe&&b.jiframe.attr("src",g.url)},hide:function(){this.unmask();this.window.hide()},show:function(){this.mask();this.window.show()},remove:function(){this.unmask();this.window.remove()},active:function(){if(this.minimize){var c=this._width,d=this._height,g=this._left,e=this._top;this.maximum&&(c=b(window).width(),d=b(window).height(),g=e=0,a.win.taskbar&&(d-=a.win.taskbar.outerHeight(),a.win.top&&(e+=a.win.taskbar.outerHeight())));this.set({width:c,height:d,left:g,top:e})}this.actived=!0;this.minimize=!1;a.win.setFront(this);this.show();a.win.setFront(this)},setUrl:function(a){return _setUrl(a)}})})(jQuery);